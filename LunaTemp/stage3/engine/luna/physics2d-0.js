var planck=function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=34)}([function(t,e,i){t.exports=o;i(2);const s=i(1);function o(t,e){if(!(this instanceof o))return new o(t,e);void 0===t?(this.x=0,this.y=0):"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}o.zero=function(){const t=Object.create(o.prototype);return t.x=0,t.y=0,t},o.ZERO=o.zero(),o.neo=function(t,e){return new o(t,e)},o.clone=function(t){return o.neo(t.x,t.y)},o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)},o.assert=function(t){},o.prototype.clone=function(){return o.clone(this)},o.prototype.setZero=function(){return this.x=0,this.y=0,this},o.prototype.set=function(t,e){return pc.markPhysics2dModuleAsUsed(),"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this},o.prototype.copy=function(t){return pc.markPhysics2dModuleAsUsed(),this.x=t.x,this.y=t.y,this},o.prototype.wSet=function(t,e,i,s){return void 0!==i||void 0!==s?this.setCombine(t,e,i,s):this.setMul(t,e)},o.prototype.setCombine=function(t,e,i,s){const o=t*e.x+i*s.x,n=t*e.y+i*s.y;return this.x=o,this.y=n,this},o.prototype.setMul=function(t,e){const i=t*e.x,s=t*e.y;return this.x=i,this.y=s,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.prototype.addCombine=function(t,e,i,s){const o=t*e.x+i*s.x,n=t*e.y+i*s.y;return this.x+=o,this.y+=n,this},o.prototype.addMul=function(t,e){const i=t*e.x,s=t*e.y;return this.x+=i,this.y+=s,this},o.prototype.wSub=function(t,e,i,s){return void 0!==i||void 0!==s?this.subCombine(t,e,i,s):this.subMul(t,e)},o.prototype.subCombine=function(t,e,i,s){const o=t*e.x+i*s.x,n=t*e.y+i*s.y;return this.x-=o,this.y-=n,this},o.prototype.subMul=function(t,e){const i=t*e.x,s=t*e.y;return this.x-=i,this.y-=s,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this},o.prototype.length=function(){return o.lengthOf(this)},o.prototype.lengthSquared=function(){return o.lengthSquared(this)},o.prototype.normalize=function(){const t=this.length();if(t<s.EPSILON)return 0;const e=1/t;return this.x*=e,this.y*=e,t},o.prototype.normal=function(){const t=this.length();if(t<s.EPSILON)return this;const e=1/t;return this.x*=e,this.y*=e,this},o.prototype.rot=function(t){const e=this.x,i=this.y;return this.x=t.c*e-t.s*i,this.y=t.s*e+t.c*i,this},o.prototype.rotate=function(t,e){const i=this.x,s=this.y;return this.x=t*i-e*s,this.y=e*i+t*s,this},o.prototype.rotT=function(t){const e=this.x,i=this.y;return this.x=t.c*e+t.s*i,this.y=-t.s*e+t.c*i,this},o.prototype.closeTo=function(t){const e=this.x-t.x;if(e>s.EPSILON||e<-s.EPSILON)return!1;const i=this.y-t.y;return-s.EPSILON<=i&&i<=s.EPSILON},o.prototype.closeToValues=function(t,e){const i=this.x-t;if(i>s.EPSILON||i<-s.EPSILON)return!1;const o=this.y-e;return-s.EPSILON<=o&&o<=s.EPSILON},o.lengthOf=function(t){return s.sqrt(t.x*t.x+t.y*t.y)},o.lengthSquared=function(t){return t.x*t.x+t.y*t.y},o.distance=function(t,e){const i=t.x-e.x,o=t.y-e.y;return s.sqrt(i*i+o*o)},o.distanceSquared=function(t,e){const i=t.x-e.x,s=t.y-e.y;return i*i+s*s},o.areEqual=function(t,e){return t==e||"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y},o.skew=function(t){return o.neo(-t.y,t.x)},o.dot=function(t,e){return t.x*e.x+t.y*e.y},o.cross=function(t,e){return"number"==typeof e?o.neo(e*t.y,-e*t.x):"number"==typeof t?o.neo(-t*e.y,t*e.x):t.x*e.y-t.y*e.x},o.crossSV=function(t,e,i){return i.set(-t*e.y,t*e.x),i},o.crossVS=function(t,e,i){return i.set(e*t.y,-e*t.x),i},o.crossVV=function(t,e){return t.x*e.y-t.y*e.x},o.addCross=function(t,e,i){return"number"==typeof i?o.neo(i*e.y+t.x,-i*e.x+t.y):"number"==typeof e?o.neo(-e*i.y+t.x,e*i.x+t.y):void 0},o.add=function(t,e){return o.neo(t.x+e.x,t.y+e.y)},o.combine=function(t,e,i,s){return o.zero().setCombine(t,e,i,s)},o.combineInto=function(t,e,i,s,o){return o.setCombine(t,e,i,s)},o.sub=function(t,e){return o.neo(t.x-e.x,t.y-e.y)},o.subInto=function(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i},o.mul=function(t,e,i){return"object"==typeof t?i?i.set(t.x*e,t.y*e):o.neo(t.x*e,t.y*e):"object"==typeof e?i?i.set(t*e.x,t*e.y):o.neo(t*e.x,t*e.y):void 0},o.mulSV=function(t,e,i){return i.set(t*e.x,t*e.y)},o.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},o.neg=function(t){return o.neo(-t.x,-t.y)},o.abs=function(t){return o.neo(s.abs(t.x),s.abs(t.y))},o.mid=function(t,e,i){const s=.5*(t.x+e.x),n=.5*(t.y+e.y);return i?i.set(s,n):o.neo(s,n)},o.upper=function(t,e){return o.neo(s.max(t.x,e.x),s.max(t.y,e.y))},o.lower=function(t,e){return o.neo(s.min(t.x,e.x),s.min(t.y,e.y))},o.prototype.clamp=function(t){const e=this.x*this.x+this.y*this.y;if(e>t*t){const i=s.invSqrt(e);this.x*=i*t,this.y*=i*t}return this},o.clamp=function(t,e){return(t=o.neo(t.x,t.y)).clamp(e),t},o.scaleFn=function(t,e){return function(i){return o.neo(i.x*t,i.y*e)}},o.translateFn=function(t,e){return function(i){return o.neo(i.x+t,i.y+e)}}},function(t,e,i){i(2);const s=i(5),o=Math,n=t.exports=s(o);n.EPSILON=1e-9,n.isFinite=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},n.assert=function(t){},n.invSqrt=function(t){return 1/o.sqrt(t)},n.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},n.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},n.mod=function(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)},n.clamp=function(t,e,i){return t<e?e:t>i?i:t},n.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:o.random()*(e-t)+t}},function(t,e,i){e.debug=function(...t){},e.assert=function(t,e,i){}},function(t,e,i){t.exports=n;i(2);const s=i(0),o=i(1);function n(t){if(!(this instanceof n))return new n(t);"number"==typeof t?this.setAngle(t):"object"==typeof t?this.set(t):this.setIdentity()}n.neo=function(t){const e=Object.create(n.prototype);return e.setAngle(t),e},n.clone=function(t){const e=Object.create(n.prototype);return e.s=t.s,e.c=t.c,e},n.identity=function(){const t=Object.create(n.prototype);return t.s=0,t.c=1,t},n.isValid=function(t){return t&&o.isFinite(t.s)&&o.isFinite(t.c)},n.assert=function(t){},n.prototype.setIdentity=function(){this.s=0,this.c=1},n.prototype.set=function(t){"object"==typeof t?(this.s=t.s,this.c=t.c):(this.s=o.sin(t),this.c=o.cos(t))},n.prototype.setCS=function(t,e){this.c=t,this.s=e},n.prototype.setAngle=function(t){this.s=o.sin(t),this.c=o.cos(t)},n.prototype.getAngle=function(){return o.atan2(this.s,this.c)},n.prototype.getXAxis=function(){return s.neo(this.c,this.s)},n.prototype.getYAxis=function(){return s.neo(-this.s,this.c)},n.mul=function(t,e){if("c"in e&&"s"in e){const i=n.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i}if("x"in e&&"y"in e)return s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},n.mulRot=function(t,e){const i=n.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i},n.mulVec2=function(t,e){return s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},n.mulVec2Into=function(t,e,i){return i.x=t.c*e.x-t.s*e.y,i.y=t.s*e.x+t.c*e.y,i},n.mulSub=function(t,e,i){const o=t.c*(e.x-i.x)-t.s*(e.y-i.y),n=t.s*(e.x-i.y)+t.c*(e.y-i.y);return s.neo(o,n)},n.mulT=function(t,e){if("c"in e&&"s"in e){const i=n.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i}if("x"in e&&"y"in e)return s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},n.mulTRot=function(t,e){const i=n.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i},n.mulTVec2=function(t,e){return s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},n.mulTVec2Into=function(t,e,i){return i.set(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}},function(t,e){const i=e;i.maxManifoldPoints=2,i.maxPolygonVertices=12,i.aabbExtension=.1,i.aabbMultiplier=2,i.linearSlop=.005,i.linearSlopSquared=i.linearSlop*i.linearSlop,i.angularSlop=2/180*Math.PI,i.polygonRadius=2*i.linearSlop,i.maxSubSteps=8,i.maxTOIContacts=32,i.maxTOIIterations=20,i.maxDistnceIterations=20,i.velocityThreshold=1,i.maxLinearCorrection=.2,i.maxAngularCorrection=8/180*Math.PI,i.maxTranslation=2,i.maxTranslationSquared=i.maxTranslation*i.maxTranslation,i.maxRotation=.5*Math.PI,i.maxRotationSquared=i.maxRotation*i.maxRotation,i.baumgarte=.2,i.toiBaugarte=.75,i.timeToSleep=.5,i.linearSleepTolerance=.01,i.linearSleepToleranceSqr=Math.pow(i.linearSleepTolerance,2),i.angularSleepTolerance=2/180*Math.PI,i.angularSleepToleranceSqr=Math.pow(i.angularSleepTolerance,2)},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){return Object.create.call(Object,t,e)}:t.exports=function(t,e){if(e)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");function i(){}return i.prototype=t,new i}},function(t,e,i){t.exports=n;i(2);const s=i(0),o=i(3);function n(t,e){if(!(this instanceof n))return new n(t,e);this.p=s.zero(),this.q=o.identity(),void 0!==t&&this.p.copy(t),void 0!==e&&this.q.set(e)}n.clone=function(t){const e=Object.create(n.prototype);return e.p=s.clone(t.p),e.q=o.clone(t.q),e},n.neo=function(t,e){const i=Object.create(n.prototype);return i.p=s.clone(t),i.q=o.clone(e),i},n.identity=function(){const t=Object.create(n.prototype);return t.p=s.zero(),t.q=o.identity(),t},n.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},n.prototype.set=function(t,e){void 0===e?(this.p.copy(t.p),this.q.set(t.q)):(this.p.copy(t),this.q.setAngle(e))},n.isValid=function(t){return t&&s.isValid(t.p)&&o.isValid(t.q)},n.assert=function(t){},n.mul=function(t,e){if(Array.isArray(e)){const i=[];for(let s=0;s<e.length;s++)i[s]=n.mul(t,e[s]);return i}if("x"in e&&"y"in e){const i=t.q.c*e.x-t.q.s*e.y+t.p.x,o=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(i,o)}if("p"in e&&"q"in e){const i=n.identity();return i.q=o.mulRot(t.q,e.q),i.p=s.add(o.mulVec2(t.q,e.p),t.p),i}},n.mulAll=function(t,e){const i=[];for(let s=0;s<e.length;s++)i[s]=n.mul(t,e[s]);return i},n.mulFn=function(t){return function(e){return n.mul(t,e)}},n.mulVec2=function(t,e,i){const o=t.q,n=t.p,r=o.c*e.x-o.s*e.y+n.x,m=o.s*e.x+o.c*e.y+n.y;return i?i.set(r,m):s.neo(r,m)},n.mulXf=function(t,e){const i=n.identity();return i.q=o.mulRot(t.q,e.q),i.p=s.add(o.mulVec2(t.q,e.p),t.p),i},n.mulT=function(t,e){if("x"in e&&"y"in e){const i=e.x-t.p.x,o=e.y-t.p.y,n=t.q.c*i+t.q.s*o,r=-t.q.s*i+t.q.c*o;return s.neo(n,r)}if("p"in e&&"q"in e){const i=n.identity();return i.q.set(o.mulTRot(t.q,e.q)),i.p.copy(o.mulTVec2(t.q,s.sub(e.p,t.p))),i}},n.mulTVec2=function(t,e,i){const o=e.x-t.p.x,n=e.y-t.p.y,r=t.q.c*o+t.q.s*n,m=-t.q.s*o+t.q.c*n;return i?i.set(r,m):s.neo(r,m)},n.mulTXf=function(t,e){const i=n.identity();return i.q.set(o.mulTRot(t.q,e.q)),i.p.copy(o.mulTVec2(t.q,s.sub(e.p,t.p))),i}},function(t,e){t.exports=function(t,e){null==t&&(t={});for(const i in e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i]);if("function"==typeof Object.getOwnPropertySymbols){const i=Object.getOwnPropertySymbols(e);for(let s=0;s<i.length;s++){const o=i[s];e.propertyIsEnumerable(o)&&void 0===t[o]&&(t[o]=e[o])}}return t}},function(t,e,i){t.exports=o;i(2);function s(){this.other=null,this.joint=null,this.prev=null,this.next=null}function o(t,e,i){e=t.bodyA||e,i=t.bodyB||i,this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=i,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new s,this.m_edgeB=new s,this.m_islandFlag=!1,this.m_activeFlag=t.active,this.m_userData=t.userData}o.prototype.isActive=function(){return this.m_activeFlag&&this.m_bodyA.isActive()&&this.m_bodyB.isActive()},o.prototype.setActive=function(t){this.m_activeFlag=t},o.prototype.getType=function(){return this.m_type},o.prototype.getBodyA=function(){return this.m_bodyA},o.prototype.setBodyA=function(t){this.disconnectBodyA(),this.disconnectBodyB(),this.refilter(),this.m_bodyA=t,this.connectBodyA(),this.connectBodyA(),this.refilter()},o.prototype.connectBodyA=function(){const t=this.m_edgeA;t.joint=this,t.other=this.m_bodyB,t.prev=null;const e=this.m_bodyA,i=e.m_jointList;t.next=i,i&&(i.prev=t),e.m_jointList=t,e.setAwake(!0)},o.prototype.disconnectBodyA=function(){const t=this.m_bodyA,e=this.m_edgeA;t.setAwake(!0),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==t.m_jointList&&(t.m_jointList=e.next),e.prev=null,e.next=null},o.prototype.getBodyB=function(){return this.m_bodyB},o.prototype.setBodyB=function(t){this.disconnectBodyA(),this.disconnectBodyB(),this.refilter(),this.m_bodyB=t,this.connectBodyA(),this.connectBodyB(),this.refilter()},o.prototype.connectBodyB=function(){const t=this.m_edgeB;t.joint=this,t.other=this.m_bodyA,t.prev=null;const e=this.m_bodyB,i=e.m_jointList;t.next=i,i&&(i.prev=t),e.m_jointList=t,e.setAwake(!0)},o.prototype.disconnectBodyB=function(){const t=this.m_bodyB,e=this.m_edgeB;t.setAwake(!0),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==t.m_jointList&&(t.m_jointList=e.next),e.prev=null,e.next=null},o.prototype.refilter=function(){if(!this.m_collideConnected)for(let t=this.m_bodyB.getContactList();t;t=t.next)this.m_bodyA.equals(t.other)&&t.contact.flagForFiltering()},o.prototype.getNext=function(){return this.m_next},o.prototype.getUserData=function(){return this.m_userData},o.prototype.setUserData=function(t){this.m_userData=t},o.prototype.getCollideConnected=function(){return this.m_collideConnected},o.prototype.setCollideConnected=function(t){this.m_collideConnected=t},o.prototype.getAnchorA=function(){},o.prototype.getAnchorB=function(){},o.prototype.getReactionForce=function(t,e){},o.prototype.getReactionTorque=function(t){},o.prototype.shiftOrigin=function(t){},o.prototype.initVelocityConstraints=function(t){},o.prototype.solveVelocityConstraints=function(t){},o.prototype.solvePositionConstraints=function(t){}},function(t,e,i){i(2);const s=i(1),o=i(0),n=i(6),r=i(10),m=i(3),c=i(4),h=i(11),l=i(14);function a(t){this.contact=t,this.prev,this.next,this.other}function _(t,e,i,s,n){pc.markPhysics2dModuleAsUsed(),this.m_nodeA=new a(this),this.m_nodeB=new a(this),this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=s,this.m_evaluateFcn=n,this.m_manifold=new h,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=mt(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=ct(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=o.zero(),this.v_normalMass=new r,this.v_K=new r,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=o.zero(),this.p_localPoint=o.zero(),this.p_localCenterA=o.zero(),this.p_localCenterB=o.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}t.exports=_,_.prototype.getContactPoint=function(t,e){const i=new UnityEngine.ContactPoint2D;i.collider=e.collider,i.otherCollider=e.otherCollider,i.rigidbody=e.rigidbody,i.otherRigidbody=e.otherRigidbody;const s=this.v_points[t];return i.point.set(s.worldPoint.x,s.worldPoint.y),i.normal.set(this.v_normal.x,this.v_normal.y),i.normalImpulse=s.normalImpulse,i.tangentImpulse=s.tangentImpulse,i.separation=s.separation,i},_.prototype.populateContactsArray=function(t,e){for(let i=0;i<this.v_pointCount&&!(i>=t.length);i++){const s=this.v_points[i],o=t[e++];this.populateContactPoint(s,o)}return e},_.prototype.populateContactPoint=function(t,e=null){e=e||new UnityEngine.ContactPoint2D;const i=this.getFixtureA(),s=this.getFixtureB(),o=i._component.code,n=s._component.code,r=i.getBody(),m=s.getBody();return e.collider=n,e.otherCollider=o,e.rigidbody=UnityEngine.Object.FromHandle(UnityEngine.Rigidbody2D,m._component),e.otherRigidbody=UnityEngine.Object.FromHandle(UnityEngine.Rigidbody2D,r._component),e.point.set(t.worldPoint.x,t.worldPoint.y),e.normal.set(this.v_normal.x,this.v_normal.y),e.normalImpulse=t.normalImpulse,e.tangentImpulse=t.tangentImpulse,e.separation=t.separation,e},_.prototype.initConstraint=function(t){const e=this.m_fixtureA,i=this.m_fixtureB,s=e.getShape(),n=i.getShape(),r=e.getBody(),m=i.getBody(),c=this.getManifold(),h=c.pointCount;this.v_invMassA=r.m_invMass,this.v_invMassB=m.m_invMass,this.v_invIA=r.m_invI,this.v_invIB=m.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=h,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=r.m_invMass,this.p_invMassB=m.m_invMass,this.p_invIA=r.m_invI,this.p_invIB=m.m_invI,this.p_localCenterA.copy(r.m_sweep.localCenter),this.p_localCenterB.copy(m.m_sweep.localCenter),this.p_radiusA=s.m_radius,this.p_radiusB=n.m_radius,this.p_type=c.type,this.p_localNormal.copy(c.localNormal),this.p_localPoint.copy(c.localPoint),this.p_pointCount=h;for(let e=0;e<h;++e){const i=c.points[e];this.v_points[e]=this.v_points[e]||new V;const s=this.v_points[e];t.warmStarting?(s.normalImpulse=t.dtRatio*i.normalImpulse,s.tangentImpulse=t.dtRatio*i.tangentImpulse):(s.normalImpulse=0,s.tangentImpulse=0),s.rA.setZero(),s.rB.setZero(),s.relativeVelocity.setZero(),s.normalMass=0,s.tangentMass=0,s.velocityBias=0,this.p_localPoints[e]=this.p_localPoints[e]||o.zero(),this.p_localPoints[e].copy(i.localPoint)}},_.prototype.getManifold=function(){return this.m_manifold},_.prototype.getWorldManifold=function(t){const e=this.m_fixtureA.getBody(),i=this.m_fixtureB.getBody(),s=this.m_fixtureA.getShape(),o=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),s.m_radius,i.getTransform(),o.m_radius)},_.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},_.prototype.isEnabled=function(){return this.m_enabledFlag},_.prototype.isTouching=function(){return this.m_touchingFlag},_.prototype.getNext=function(){return this.m_next},_.prototype.getFixtureA=function(){return this.m_fixtureA},_.prototype.getFixtureB=function(){return this.m_fixtureB},_.prototype.getChildIndexA=function(){return this.m_indexA},_.prototype.getChildIndexB=function(){return this.m_indexB},_.prototype.flagForFiltering=function(){this.m_filterFlag=!0},_.prototype.setFriction=function(t){this.m_friction=t},_.prototype.getFriction=function(){return this.m_friction},_.prototype.resetFriction=function(){this.m_friction=mt(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},_.prototype.setRestitution=function(t){this.m_restitution=t},_.prototype.getRestitution=function(){return this.m_restitution},_.prototype.resetRestitution=function(){this.m_restitution=ct(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},_.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},_.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},_.prototype.evaluate=function(t,e,i){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,i,this.m_fixtureB,this.m_indexB)},_.prototype.update=function(t){this.m_enabledFlag=!0;let e=!1;const i=this.m_touchingFlag,s=this.m_fixtureA.isSensor(),o=this.m_fixtureB.isSensor(),n=s||o,r=this.m_fixtureA.getBody(),m=this.m_fixtureB.getBody(),c=r.getTransform(),a=m.getTransform();let _=null;if(n){const t=this.m_fixtureA.getShape(),i=this.m_fixtureB.getShape();e=l.testOverlap(t,this.m_indexA,i,this.m_indexB,c,a),this.m_manifold.pointCount=0}else{_=this.m_manifold,this.m_manifold=new h,this.evaluate(this.m_manifold,c,a),e=this.m_manifold.pointCount>0;for(let t=0;t<this.m_manifold.pointCount;++t){const e=this.m_manifold.points[t];e.normalImpulse=0,e.tangentImpulse=0;for(let t=0;t<_.pointCount;++t){const i=_.points[t];if(i.id.key==e.id.key){e.normalImpulse=i.normalImpulse,e.tangentImpulse=i.tangentImpulse;break}}}e!=i&&(r.setAwake(!0),m.setAwake(!0))}this.m_touchingFlag=e,0==i&&1==e&&t&&t.beginContact(this),1==i&&0==e&&t&&t.endContact(this),0==n&&e&&t&&t.preSolve(this,_)},_.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)},_.prototype.solvePositionConstraintTOI=function(t,e,i){return this._solvePositionConstraint(t,!0,e,i)};const u=n.identity(),p=n.identity(),y=new o,d=new o,f=new o,x=new o,g=new o,v=new o,A=new o,b=new o,B=new o,w=new o,C=new o,I=new o,S=new o;function V(){this.rA=o.zero(),this.rB=o.zero(),this.relativeVelocity=o.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}_.prototype._solvePositionConstraint=function(t,e,i,r){const l=this.m_fixtureA,a=this.m_fixtureB,_=l.getBody(),V=a.getBody(),M=_.c_position,L=V.c_position,P=B,z=w;P.copy(this.p_localCenterA),z.copy(this.p_localCenterB);const k=b,T=C,O=I,q=A,E=v,F=x,R=g,D=d,N=f,U=y,j=S,Y=u,W=p;let J=0,H=0;e&&_!=i&&_!=r||(J=this.p_invMassA,H=this.p_invIA);let Z=0,G=0;e&&V!=i&&V!=r||(Z=this.p_invMassB,G=this.p_invIB),T.copy(M.c);let X=M.a;O.copy(L.c);let K=L.a,Q=0;for(let t=0;t<this.p_pointCount;++t){let i,r;switch(Y.q.setAngle(X),W.q.setAngle(K),o.subInto(T,m.mulVec2Into(Y.q,P,j),Y.p),o.subInto(O,m.mulVec2Into(W.q,z,j),W.p),this.p_type){case h.e_circles:n.mulVec2(Y,this.p_localPoint,F),n.mulVec2(W,this.p_localPoints[0],R),o.subInto(R,F,U),U.normalize(),i=o.combine(.5,F,.5,R),r=o.dot(o.subInto(R,F,j),U)-this.p_radiusA-this.p_radiusB;break;case h.e_faceA:m.mulVec2Into(Y.q,this.p_localNormal,U),n.mulVec2(Y,this.p_localPoint,E),n.mulVec2(W,this.p_localPoints[t],q),r=o.dot(o.subInto(q,E,j),U)-this.p_radiusA-this.p_radiusB,i=q;break;case h.e_faceB:m.mulVec2Into(W.q,this.p_localNormal,U),n.mulVec2(W,this.p_localPoint,E),n.mulVec2(Y,this.p_localPoints[t],q),r=o.dot(o.subInto(q,E,j),U)-this.p_radiusA-this.p_radiusB,i=q,U.mul(-1)}o.subInto(i,T,D),o.subInto(i,O,N),Q=s.min(Q,r);const l=e?c.toiBaugarte:c.baumgarte,a=c.linearSlop,_=c.maxLinearCorrection,u=s.clamp(l*(r+a),-_,0),p=o.crossVV(D,U),y=o.crossVV(N,U),d=J+Z+H*p*p+G*y*y,f=d>0?-u/d:0;o.mulSV(f,U,k),T.subMul(J,k),X-=H*o.crossVV(D,k),O.addMul(Z,k),K+=G*o.crossVV(N,k)}return M.c.copy(T),M.a=X,L.c.copy(O),L.a=K,Q};const M=o.zero(),L=o.zero(),P=o.zero(),z=o.zero(),k=o.zero(),T=o.zero(),O=o.zero(),q=o.zero(),E=o.zero(),F=o.zero(),R=n.identity(),D=n.identity(),N=new h.WorldManifold;_.prototype.initVelocityConstraint=function(t){const e=this.m_fixtureA,i=this.m_fixtureB,s=e.getBody(),n=i.getBody(),r=s.c_velocity,h=n.c_velocity,l=s.c_position,a=n.c_position,_=this.p_radiusA,u=this.p_radiusB,p=this.getManifold(),y=this.v_invMassA,d=this.v_invMassB,f=this.v_invIA,x=this.v_invIB,g=M,v=L,A=T,b=O;A.copy(this.p_localCenterA),b.copy(this.p_localCenterB);const B=R,w=D,C=P,I=z,S=k,V=q,U=E,j=F;g.copy(l.c);const Y=l.a;C.copy(r.v);const W=r.w;v.copy(a.c);const J=a.a;I.copy(h.v);const H=h.w;B.q.setAngle(Y),w.q.setAngle(J),B.p.setCombine(1,g,-1,m.mulVec2Into(B.q,A,j)),w.p.setCombine(1,v,-1,m.mulVec2Into(w.q,b,j)),N.normal.set(0,0);const Z=p.getWorldManifold(N,B,_,w,u);this.v_normal.copy(Z.normal);for(let t=0;t<this.v_pointCount;++t){const e=this.v_points[t],i=Z.points[t];e.worldPoint=i,e.separation=Z.separations[t],o.subInto(i,g,e.rA),o.subInto(i,v,e.rB);const s=o.crossVV(e.rA,this.v_normal),n=o.crossVV(e.rB,this.v_normal),r=y+d+f*s*s+x*n*n;e.normalMass=r>0?1/r:0,o.crossVS(this.v_normal,1,S);const m=o.crossVV(e.rA,S),h=o.crossVV(e.rB,S),l=y+d+f*m*m+x*h*h;e.tangentMass=l>0?1/l:0,e.velocityBias=0;const a=o.dot(this.v_normal,I)+o.dot(this.v_normal,o.crossSV(H,e.rB,V))-o.dot(this.v_normal,C)-o.dot(this.v_normal,o.crossSV(W,e.rA,U));a<-c.velocityThreshold&&(e.velocityBias=-this.v_restitution*a)}if(2==this.v_pointCount&&t.blockSolve){const t=this.v_points[0],e=this.v_points[1],i=o.crossVV(t.rA,this.v_normal),s=o.crossVV(t.rB,this.v_normal),n=o.crossVV(e.rA,this.v_normal),r=o.crossVV(e.rB,this.v_normal),m=y+d+f*i*i+x*s*s,c=y+d+f*n*n+x*r*r,h=y+d+f*i*n+x*s*r;m*m<1e3*(m*c-h*h)?(this.v_K.ex.set(m,h),this.v_K.ey.set(h,c),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}l.c.copy(g),l.a=Y,r.v.copy(C),r.w=W,a.c.copy(v),a.a=J,h.v.copy(I),h.w=H};const U=o.zero(),j=o.zero(),Y=o.zero(),W=o.zero();_.prototype.warmStartConstraint=function(t){const e=this.m_fixtureA,i=this.m_fixtureB,s=e.getBody(),n=i.getBody(),r=s.c_velocity,m=n.c_velocity,c=this.v_invMassA,h=this.v_invIA,l=this.v_invMassB,a=this.v_invIB,_=U,u=j,p=Y,y=W;_.copy(r.v);let d=r.w;u.copy(m.v);let f=m.w;const x=this.v_normal;o.crossVS(x,1,p);for(let t=0;t<this.v_pointCount;++t){const e=this.v_points[t];o.combineInto(e.normalImpulse,x,e.tangentImpulse,p,y),d-=h*o.crossVV(e.rA,y),_.subMul(c,y),f+=a*o.crossVV(e.rB,y),u.addMul(l,y)}r.v.copy(_),r.w=d,m.v.copy(u),m.w=f},_.prototype.storeConstraintImpulses=function(t){const e=this.m_manifold.points,i=this.v_points;for(let t=0;t<this.v_pointCount;++t)e[t].normalImpulse=i[t].normalImpulse,e[t].tangentImpulse=i[t].tangentImpulse};const J=o.zero(),H=o.zero(),Z=o.zero(),G=o.zero(),X=o.zero(),K=o.zero(),Q=o.zero(),$=o.zero(),tt=o.zero(),et=o.zero(),it=o.zero(),st=o.zero(),ot=o.zero(),nt=o.zero(),rt=o.zero();function mt(t,e){return s.sqrt(t*e)}function ct(t,e){return t>e?t:e}_.prototype.solveVelocityConstraint=function(t){const e=this.m_fixtureA.m_body,i=this.m_fixtureB.m_body,n=e.c_velocity,m=i.c_velocity,c=this.v_invMassA,h=this.v_invIA,l=this.v_invMassB,a=this.v_invIB,_=J,u=H,p=Z,y=G,d=X,f=K,x=Q,g=$,v=tt,A=et,b=it,B=st,w=ot,C=nt,I=rt;_.copy(n.v);let S=n.w;u.copy(m.v);let V=m.w;const M=this.v_normal;o.crossVS(M,1,p);const L=this.v_friction;for(let t=0;t<this.v_pointCount;++t){let e=this.v_points[t];f.set(0,0),o.crossSV(V,e.rB,y),f.addCombine(1,u,1,y),o.crossSV(S,e.rA,y),f.subCombine(1,_,1,y),e.relativeVelocity||e.relativeVelocity.copy(f);const i=o.dot(f,p)-this.v_tangentSpeed;let n=e.tangentMass*-i;const r=L*e.normalImpulse;let m=s.clamp(e.tangentImpulse+n,-r,r);n=m-e.tangentImpulse,e.tangentImpulse=m,o.mulSV(n,p,d),_.subMul(c,d),S-=h*o.crossVV(e.rA,d),u.addMul(l,d),V+=a*o.crossVV(e.rB,d)}if(1==this.v_pointCount||0==t.blockSolve)for(let t=0;t<this.v_pointCount;++t){let e=this.v_points[t];f.set(0,0),o.crossSV(V,e.rB,y),f.addCombine(1,u,1,y),o.crossSV(S,e.rA,y),f.subCombine(1,_,1,y);const i=o.dot(f,M);let n=-e.normalMass*(i-e.velocityBias),r=s.max(e.normalImpulse+n,0);n=r-e.normalImpulse,e.normalImpulse=r,o.mulSV(n,M,d),_.subMul(c,d),S-=h*o.crossVV(e.rA,d),u.addMul(l,d),V+=a*o.crossVV(e.rB,d)}else{const t=this.v_points[0],e=this.v_points[1];C.set(t.normalImpulse,e.normalImpulse),x.set(0,0).add(u),o.crossSV(V,t.rB,y),x.add(y).sub(_),o.crossSV(S,t.rA,y),x.sub(y),g.set(0,0).add(u),o.crossSV(V,e.rB,y),g.add(y).sub(_),o.crossSV(S,e.rA,y),g.sub(y);let i=o.dot(x,M),s=o.dot(g,M);v.set(i-t.velocityBias,s-e.velocityBias),r.mulVec2Intro(this.v_K,C,I),v.sub(I);for(;;){if(r.mulVec2Intro(this.v_normalMass,v,A).neg(),A.x>=0&&A.y>=0){o.subInto(A,C,w),b.copy(M).mul(w.x),B.copy(M).mul(w.y),_.subCombine(c,b,c,B),S-=h*(o.crossVV(t.rA,b)+o.crossVV(e.rA,B)),u.addCombine(l,b,l,B),V+=a*(o.crossVV(t.rB,b)+o.crossVV(e.rB,B)),t.normalImpulse=A.x,e.normalImpulse=A.y;break}if(A.x=-t.normalMass*v.x,A.y=0,i=0,s=this.v_K.ex.y*A.x+v.y,A.x>=0&&s>=0){w.copy(A).sub(C),b.copy(M).mul(w.x),B.copy(M).mul(w.y),_.subCombine(c,b,c,B),S-=h*(o.crossVV(t.rA,b)+o.crossVV(e.rA,B)),u.addCombine(l,b,l,B),V+=a*(o.crossVV(t.rB,b)+o.crossVV(e.rB,B)),t.normalImpulse=A.x,e.normalImpulse=A.y;break}if(A.x=0,A.y=-e.normalMass*v.y,i=this.v_K.ey.x*A.y+v.x,s=0,A.y>=0&&i>=0){w.copy(A).sub(C),o.mulSV(w.x,M,b),o.mulSV(w.y,M,B),_.subCombine(c,b,c,B),S-=h*(o.crossVV(t.rA,b)+o.crossVV(e.rA,B)),u.addCombine(l,b,l,B),V+=a*(o.crossVV(t.rB,b)+o.crossVV(e.rB,B)),t.normalImpulse=A.x,e.normalImpulse=A.y;break}if(A.x=0,A.y=0,i=v.x,s=v.y,i>=0&&s>=0){w.copy(A).sub(C),b.copy(M).mul(w.x),B.copy(M).mul(w.y),_.subCombine(c,b,c,B),S-=h*(o.crossVV(t.rA,b)+o.crossVV(e.rA,B)),u.addCombine(l,b,l,B),V+=a*(o.crossVV(t.rB,b)+o.crossVV(e.rB,B)),t.normalImpulse=A.x,e.normalImpulse=A.y;break}break}}n.v.copy(_),n.w=S,m.v.copy(u),m.w=V};const ht=[];_.addType=function(t,e,i){ht[t]=ht[t]||{},ht[t][e]=i},_.create=function(t,e,i,s){const n=t.getType(),r=i.getType();if("circle"===n&&"circle"===r&&o.distance(t.m_body.getPosition(),i.m_body.getPosition())>t.m_shape.m_radius+i.m_shape.m_radius)return null;let m,c;if(c=ht[n]&&ht[n][r])m=new _(t,e,i,s,c);else{if(!(c=ht[r]&&ht[r][n]))return null;m=new _(i,s,t,e,c)}t=m.getFixtureA(),i=m.getFixtureB(),e=m.getChildIndexA(),s=m.getChildIndexB();const h=t.getBody(),l=i.getBody();return m.m_nodeA.contact=m,m.m_nodeA.other=l,m.m_nodeA.prev=null,m.m_nodeA.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=m.m_nodeA),h.m_contactList=m.m_nodeA,m.m_nodeB.contact=m,m.m_nodeB.other=h,m.m_nodeB.prev=null,m.m_nodeB.next=l.m_contactList,null!=l.m_contactList&&(l.m_contactList.prev=m.m_nodeB),l.m_contactList=m.m_nodeB,0==t.isSensor()&&0==i.isSensor()&&(h.setAwake(!0),l.setAwake(!0)),m},_.destroy=function(t,e){const i=t.m_fixtureA,s=t.m_fixtureB,o=i.getBody(),n=s.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==n.m_contactList&&(n.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&0==i.isSensor()&&0==s.isSensor()&&(o.setAwake(!0),n.setAwake(!0));const r=i.getType(),m=s.getType(),c=ht[r][m].destroyFcn;"function"==typeof c&&c(t)}},function(t,e,i){t.exports=o;i(2);const s=i(0);function o(t,e,i,o){"object"==typeof t&&null!==t?(this.ex=s.clone(t),this.ey=s.clone(e)):"number"==typeof t?(this.ex=s.neo(t,i),this.ey=s.neo(e,o)):(this.ex=s.zero(),this.ey=s.zero())}o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&s.isValid(t.ex)&&s.isValid(t.ey)},o.assert=function(t){},o.prototype.set=function(t,e,i,s){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof s?(this.ex.set(t,i),this.ey.set(e,s)):"object"==typeof t&&"object"==typeof e?(this.ex.copy(t),this.ey.copy(e)):"object"==typeof t&&(this.ex.copy(t.ex),this.ey.copy(t.ey))},o.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},o.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},o.prototype.getInverse=function(){const t=this.ex.x,e=this.ey.x,i=this.ex.y,s=this.ey.y;let n=t*s-e*i;0!=n&&(n=1/n);const r=new o;return r.ex.x=n*s,r.ey.x=-n*e,r.ex.y=-n*i,r.ey.y=n*t,r},o.prototype.solve=function(t){const e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y;let r=e*n-i*o;0!=r&&(r=1/r);const m=s.zero();return m.x=r*(n*t.x-i*t.y),m.y=r*(e*t.y-o*t.x),m};const n=s.zero(),r=s.zero();o.mul=function(t,e){if(e&&"x"in e&&"y"in e){const i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}if(e&&"ex"in e&&"ey"in e)return new o(s.mulSV(t,e.ex,n),s.mulSV(t,e.ey,r))},o.mulVec2=function(t,e){const i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)},o.mulVec2Intro=function(t,e,i){const s=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return i.set(s,o)};const m=s.zero(),c=s.zero();o.mulMat22=function(t,e){return new o(s.mulSV(t,e.ex,m),s.mulSV(t,e.ey,c))},o.mulT=function(t,e){if(e&&"x"in e&&"y"in e)return s.neo(s.dot(e,t.ex),s.dot(e,t.ey));if(e&&"ex"in e&&"ey"in e){return new o(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))}},o.mulTVec2=function(t,e){return s.neo(s.dot(e,t.ex),s.dot(e,t.ey))},o.mulTMat22=function(t,e){return new o(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))},o.abs=function(t){return new o(s.abs(t.ex),s.abs(t.ey))},o.add=function(t,e){return new o(s.add(t.ex+e.ex),s.add(t.ey+e.ey))}},function(t,e,i){const s=i(0),o=i(6),n=i(1),r=i(3);function m(){this.type,this.localNormal=s.zero(),this.localPoint=s.zero(),this.points=[new c,new c],this.pointCount=0}function c(){this.localPoint=s.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new h}function h(){this.cf=new l}function l(){this.indexA,this.indexB,this.typeA,this.typeB}function a(){this.normal=s.zero(),this.points=[],this.separations=[]}m.e_circles=0,m.e_faceA=1,m.e_faceB=2,m.e_vertex=0,m.e_face=1,m.prototype.reset=function(){this.localNormal.set(0,0),this.localPoint.set(0,0),this.pointCount=0},Object.defineProperty(h.prototype,"key",{get:function(){return this.cf.indexA+4*this.cf.indexB+16*this.cf.typeA+64*this.cf.typeB},enumerable:!0,configurable:!0}),h.prototype.set=function(t){this.cf.set(t.cf)},l.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB};const _=new s,u=s.zero(),p=s.zero(),y=s.zero(),d=s.zero(),f=s.zero(),x=s.zero(),g=s.zero(),v=new s;m.prototype.getWorldManifold=function(t,e,i,c,h){if(0==this.pointCount)return;t=t||new a;const l=u,A=p,b=y,B=d,w=f,C=x,I=_;b.copy(t.normal);const S=t.points,V=t.separations;switch(this.type){case m.e_circles:S[0]||(S[0]=new s),b.set(1,0),o.mulVec2(e,this.localPoint,l),o.mulVec2(c,this.points[0].localPoint,A),s.subInto(A,l,I),s.lengthSquared(I)>n.EPSILON*n.EPSILON&&(b.copy(I),b.normalize()),s.mid(l,A,S[0]),V[0]=-h-i,S.length=1,V.length=1;break;case m.e_faceA:r.mulVec2Into(e.q,this.localNormal,b),o.mulVec2(e,this.localPoint,g);for(let t=0;t<this.pointCount;++t)S[t]||(S[t]=new s),o.mulVec2(c,this.points[t].localPoint,B),w.copy(B).addMul(i-s.dot(s.subInto(B,g,v),b),b),C.copy(B).subMul(h,b),s.mid(w,C,S[t]),V[t]=s.dot(s.subInto(C,w,v),b);S.length=this.pointCount,V.length=this.pointCount;break;case m.e_faceB:b.copy(r.mulVec2(c.q,this.localNormal)),o.mulVec2(c,this.localPoint,g);for(let t=0;t<this.pointCount;++t)S[t]||(S[t]=new s),o.mulVec2(e,this.points[t].localPoint,B),C.copy(s.combine(1,B,h-s.dot(s.sub(B,g),b),b)),w.copy(s.combine(1,B,-i,b)),s.mid(w,C,S[t]),V[t]=s.dot(s.sub(w,C),b);S.length=this.pointCount,V.length=this.pointCount,b.mul(-1)}return t.normal.copy(b),t.points=S,t.separations=V,t};let A={nullState:0,addState:1,persistState:2,removeState:3};function b(){this.v=s.zero(),this.id=new h}b.prototype.set=function(t){this.v.copy(t.v),this.id.set(t.id)},t.exports=m,t.exports.clipSegmentToLine=function(t,e,i,o,n){let r=0;const c=s.dot(i,e[0].v)-o,h=s.dot(i,e[1].v)-o;if(c<=0&&t[r++].set(e[0]),h<=0&&t[r++].set(e[1]),c*h<0){const i=c/(c-h);t[r].v.setCombine(1-i,e[0].v,i,e[1].v),t[r].id.cf.indexA=n,t[r].id.cf.indexB=e[0].id.cf.indexB,t[r].id.cf.typeA=m.e_vertex,t[r].id.cf.typeB=m.e_face,++r}return r},t.exports.clipVertex=b,t.exports.getPointStates=function(t,e,i,s){for(let e=0;e<i.pointCount;++e){let o=i.points[e].id;t[e]=A.removeState;for(let i=0;i<s.pointCount;++i)if(s.points[i].id.key==o.key){t[e]=A.persistState;break}}for(let t=0;t<s.pointCount;++t){let o=s.points[t].id;e[t]=A.addState;for(let s=0;s<i.pointCount;++s)if(i.points[s].id.key==o.key){e[t]=A.persistState;break}}},t.exports.PointState=A,t.exports.WorldManifold=a},function(t,e,i){const s=i(1),o=i(0);function n(t,e){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof n))return new n(t,e);this.lowerBound=o.zero(),this.upperBound=o.zero(),"object"==typeof t&&this.lowerBound.copy(t),"object"==typeof e&&this.upperBound.copy(e)}t.exports=n,n.prototype.isValid=function(){return n.isValid(this)},n.prototype.containsPoints=function(t,e,i){if(void 0===this.radius||void 0===this.vertex1||void 0===this.vertex2&&void 0!==i)return!1;const o=this.radius-t;return-s.EPSILON<=o&&o<=s.EPSILON&&this.vertex1.closeTo(e)&&(this.vertex2===i||this.vertex2.closeTo(i))},n.prototype.storePoints=function(t,e,i){void 0===this.vertex1?this.vertex1=o.clone(e):this.vertex1.copy(e),void 0===i?this.vertex2=i:void 0===this.vertex2?this.vertex2=o.clone(i):this.vertex2.copy(i),this.radius=t},n.isValid=function(t){const e=o.sub(t.upperBound,t.lowerBound);return e.x>=0&&e.y>=0&&o.isValid(t.lowerBound)&&o.isValid(t.upperBound)},n.assert=function(t){},n.prototype.getCenter=function(){return o.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},n.prototype.getExtents=function(){return o.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},n.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},n.prototype.combine=function(t,e){const i=t.lowerBound,o=t.upperBound,n=e.lowerBound,r=e.upperBound,m=s.min(i.x,n.x),c=s.min(i.y,n.y),h=s.max(r.x,o.x),l=s.max(r.y,o.y);this.lowerBound.set(m,c),this.upperBound.set(h,l)},n.prototype.combinePoints=function(t,e){this.lowerBound.set(s.min(t.x,e.x),s.min(t.y,e.y)),this.upperBound.set(s.max(t.x,e.x),s.max(t.y,e.y))},n.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)},n.prototype.contains=function(t){let e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y,e},n.prototype.extend=function(t){n.extend(this,t)},n.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e},n.testOverlap=function(t,e){return!(e.lowerBound.x>t.upperBound.x||e.lowerBound.y>t.upperBound.y||t.lowerBound.x>e.upperBound.x||t.lowerBound.y>e.upperBound.y)},n.areEqual=function(t,e){return o.areEqual(t.lowerBound,e.lowerBound)&&o.areEqual(t.upperBound,e.upperBound)},n.diff=function(t,e){const i=s.max(0,s.min(t.upperBound.x,e.upperBound.x)-s.max(e.lowerBound.x,t.lowerBound.x)),o=s.max(0,s.min(t.upperBound.y,e.upperBound.y)-s.max(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-i*o},n.prototype.rayCast=function(t,e){let i=-1/0,n=1/0;const r=e.p1,m=o.sub(e.p2,e.p1),c=o.abs(m),h=o.zero();for(let t="x";null!==t;t="x"===t?"y":null)if(c.x<s.EPSILON){if(r[t]<this.lowerBound[t]||this.upperBound[t]<r[t])return!1}else{const e=1/m[t];let o=(this.lowerBound[t]-r[t])*e,c=(this.upperBound[t]-r[t])*e,l=-1;if(o>c){const t=o;o=c,c=t,l=1}if(o>i&&(h.setZero(),h[t]=l,i=o),n=s.min(n,c),i>n)return!1}return!(i<0||e.maxFraction<i)&&(t.fraction=i,t.normal=h,!0)},n.prototype.toString=function(){return JSON.stringify(this)}},function(t,e){function i(){this.m_type,this.m_radius}t.exports=i,i.isValid=function(t){return!!t},i.prototype.getRadius=function(){return this.m_radius},i.prototype.getType=function(){return this.m_type},i.prototype._clone=function(){},i.prototype.getChildCount=function(){},i.prototype.testPoint=function(t,e){},i.prototype.rayCast=function(t,e,i,s){},i.prototype.computeAABB=function(t,e,i){},i.prototype.setAABB=function(t,e,i){},i.prototype.resetAABB=function(t,e,i){return null},i.prototype.computeMass=function(t,e){},i.prototype.computeDistanceProxy=function(t){}},function(t,e,i){t.exports=d,t.exports.Input=l,t.exports.Output=a,t.exports.Proxy=f,t.exports.Cache=_;const s=i(4),o=(i(2),i(23)),n=i(1),r=i(0),m=i(3),c=i(6),h=r.zero();function l(){this.proxyA=new f,this.proxyB=new f,this.transformA=null,this.transformB=null,this.useRadii=!1,this.overlap=!1}function a(){this.pointA=r.zero(),this.pointB=r.zero(),this.distance,this.iterations}function _(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}o.gjkCalls=0,o.gjkIters=0,o.gjkMaxIters=0,l.prototype.clear=function(){this.proxyA.clear(),this.proxyB.clear(),this.transformA=null,this.transformB=null,this.useRadii=!1,this.overlap=!1},a.prototype.clear=function(){this.pointA.setZero(),this.pointB.setZero(),this.distance=0,this.iterations=0},_.prototype.clear=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0};const u=new r,p=new r,y=new r;function d(t,e,i){++o.gjkCalls;const l=i.proxyA,a=i.proxyB,_=i.transformA,d=i.transformB,f=u,x=p,v=y,A=new g;A.readCache(e,l,_,a,d);const b=A.m_v,B=s.maxDistnceIterations,w=[],C=[];let I=0,S=1/0,V=1/0,M=0;for(;M<B;){I=A.m_count;for(let t=0;t<I;++t)w[t]=b[t].indexA,C[t]=b[t].indexB;if(A.solve(),3==A.m_count)break;if(A.setToClosestPoint(f),V=f.lengthSquared(),S=V,A.setToSearchDirection(h),h.lengthSquared()<n.EPSILON*n.EPSILON)break;const t=b[A.m_count];x.copy(h).neg(),m.mulTVec2Into(_.q,x,v),t.indexA=l.getSupport(v),c.mulVec2(_,l.getVertex(t.indexA),t.wA),m.mulTVec2Into(d.q,h,v),t.indexB=a.getSupport(v),c.mulVec2(d,a.getVertex(t.indexB),t.wB),r.subInto(t.wB,t.wA,t.w),++M,++o.gjkIters;let e=!1;for(let i=0;i<I;++i)if(t.indexA==w[i]&&t.indexB==C[i]){e=!0;break}if(e)break;++A.m_count}if(o.gjkMaxIters=n.max(o.gjkMaxIters,M),A.getWitnessPoints(t.pointA,t.pointB),t.distance=r.distance(t.pointA,t.pointB),t.iterations=M,A.writeCache(e),i.useRadii){const e=l.m_radius,s=a.m_radius;if(i.overlap||t.distance>e+s&&t.distance>n.EPSILON){t.distance-=e+s;const i=r.sub(t.pointB,t.pointA);i.normalize(),t.pointA.addMul(e,i),t.pointB.subMul(s,i)}else r.mid(t.pointA,t.pointB,f),t.pointA.copy(f),t.pointB.copy(f),t.distance=0}}function f(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}function x(){this.indexA,this.indexB,this.wA=r.zero(),this.wB=r.zero(),this.w=r.zero(),this.a}function g(){this.m_v1=new x,this.m_v2=new x,this.m_v3=new x,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}f.prototype.clear=function(){this.m_buffer.length=0,this.m_vertices=[],this.m_count=0,this.m_radius=0},f.prototype.getVertexCount=function(){return this.m_count},f.prototype.getVertex=function(t){return this.m_vertices[t]},f.prototype.getSupport=function(t){let e=0,i=r.dot(this.m_vertices[0],t);for(let s=0;s<this.m_count;++s){const o=r.dot(this.m_vertices[s],t);o>i&&(e=s,i=o)}return e},f.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},f.prototype.set=function(t,e){t.computeDistanceProxy(this,e)},x.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA.copy(t.wA),this.wB.copy(t.wB),this.w.copy(t.w),this.a=t.a},g.prototype.print=function(){return 3==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},g.prototype.readCache=function(t,e,i,s,o){this.m_count=t.count;for(let n=0;n<this.m_count;++n){let m=this.m_v[n];m.indexA=t.indexA[n],m.indexB=t.indexB[n];let h=e.getVertex(m.indexA),l=s.getVertex(m.indexB);c.mulVec2(i,h,m.wA),c.mulVec2(o,l,m.wB),r.subInto(m.wB,m.wA,m.w),m.a=0}if(this.m_count>1){const e=t.metric,i=this.getMetric();(i<.5*e||2*e<i||i<n.EPSILON)&&(this.m_count=0)}if(0==this.m_count){let t=this.m_v[0];t.indexA=0,t.indexB=0;let n=e.getVertex(0),m=s.getVertex(0);c.mulVec2(i,n,t.wA),c.mulVec2(o,m,t.wB),r.subInto(t.wB,t.wA,t.w),t.a=1,this.m_count=1}},g.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(let e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB};const v=r.zero(),A=r.zero();g.prototype.setToSearchDirection=function(t){switch(this.m_count){case 1:return t.copy(this.m_v1.w).neg();case 2:{const e=v;r.subInto(this.m_v2.w,this.m_v1.w,e);const i=A;i.copy(this.m_v1.w),i.neg();return r.crossVV(e,i)>0?r.crossSV(1,e,t):r.crossVS(e,1,t)}default:return t.setZero()}},g.prototype.setToClosestPoint=function(t){switch(this.m_count){case 0:case 3:default:return t.setZero();case 1:return t.copy(this.m_v1.w);case 2:return r.combineInto(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w,t)}},g.prototype.getWitnessPoints=function(t,e){switch(this.m_count){case 0:default:break;case 1:t.copy(this.m_v1.wA),e.copy(this.m_v1.wB);break;case 2:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.setCombine(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.addMul(this.m_v3.a,this.m_v3.wA),e.copy(t)}};const b=new r,B=new r;g.prototype.getMetric=function(){switch(this.m_count){case 0:case 1:default:return 0;case 2:return r.distance(this.m_v1.w,this.m_v2.w);case 3:return r.subInto(this.m_v2.w,this.m_v1.w,b),r.sub(this.m_v3.w,this.m_v1.w,B),r.crossVV(b,B)}},g.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3()}};const w=r.zero();g.prototype.solve2=function(){const t=this.m_v1.w,e=this.m_v2.w,i=w;r.subInto(e,t,i);const s=-r.dot(t,i);if(s<=0)return this.m_v1.a=1,void(this.m_count=1);const o=r.dot(e,i);if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);const n=1/(o+s);this.m_v1.a=o*n,this.m_v2.a=s*n,this.m_count=2};const C=r.zero(),I=r.zero(),S=r.zero();g.prototype.solve3=function(){const t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,s=C,o=I,n=S;r.subInto(e,t,s);const m=r.dot(t,s),c=r.dot(e,s),h=-m;r.subInto(i,t,o);const l=r.dot(t,o),a=r.dot(i,o),_=-l;r.subInto(i,e,n);const u=r.dot(e,n),p=r.dot(i,n),y=-u,d=r.crossVV(s,o),f=d*r.crossVV(e,i),x=d*r.crossVV(i,t),g=d*r.crossVV(t,e);if(h<=0&&_<=0)return this.m_v1.a=1,void(this.m_count=1);if(c>0&&h>0&&g<=0){const t=1/(c+h);return this.m_v1.a=c*t,this.m_v2.a=h*t,void(this.m_count=2)}if(a>0&&_>0&&x<=0){const t=1/(a+_);return this.m_v1.a=a*t,this.m_v3.a=_*t,this.m_count=2,void this.m_v2.set(this.m_v3)}if(c<=0&&y<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(a<=0&&p<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(p>0&&y>0&&f<=0){const t=1/(p+y);return this.m_v2.a=p*t,this.m_v3.a=y*t,this.m_count=2,void this.m_v1.set(this.m_v3)}const v=1/(f+x+g);this.m_v1.a=f*v,this.m_v2.a=x*v,this.m_v3.a=g*v,this.m_count=3},d.testOverlap=function(t,e,i,s,o,r){const m=d.getInput();m.clear(),m.proxyA.set(t,e),m.proxyB.set(i,s),m.transformA=o,m.transformB=r,m.useRadii=!0;const c=d.getCache();c.clear();const h=d.getOutput();return h.clear(),d(h,c,m),h.distance<10*n.EPSILON},d.getInput=function(){return d._input=d._input||new l},d.getCache=function(){return d._cache=d._cache||new _},d.getOutput=function(){return d._output=d._output||new a}},function(t,e,i){t.exports=c;i(2);const s=i(5),o=i(1),n=i(3),r=i(0),m=i(13);function c(t,e){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof c))return new c(t,e);c._super.call(this),this.m_type=c.TYPE,this.m_p=r.zero(),this.m_radius=1,"object"==typeof t&&r.isValid(t)?(this.m_p.copy(t),"number"==typeof e&&(this.m_radius=e)):"number"==typeof t&&(this.m_radius=t)}c._super=m,c.prototype=s(c._super.prototype),c.TYPE="circle",c.prototype.getRadius=function(){return this.m_radius},c.prototype.setRadius=function(t){this.m_radius=t},c.prototype.getCenter=function(){return this.m_p},c.prototype.getVertex=function(t){return this.m_p},c.prototype.getVertexCount=function(t){return 1},c.prototype._clone=function(){const t=new c;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},c.prototype.getChildCount=function(){return 1},c.prototype.testPoint=function(t,e){const i=r.add(t.p,n.mulVec2(t.q,this.m_p)),s=r.sub(e,i);return r.dot(s,s)<=this.m_radius*this.m_radius},c.prototype.rayCast=function(t,e,i,s){const m=r.add(i.p,n.mulVec2(i.q,this.m_p)),c=r.sub(e.p1,m),h=r.dot(c,c)-this.m_radius*this.m_radius,l=r.sub(e.p2,e.p1);if(h<0)return t.fraction=0,t.normal=l.neg().normal(),!0;const a=r.dot(c,l),_=r.dot(l,l),u=a*a-_*h;if(u<0||_<o.EPSILON)return!1;let p=-(a+o.sqrt(u));return p>=0&&p<=e.maxFraction*_&&(p/=_,t.fraction=p,t.normal=r.zero(),r.mulSV(p,l,t.normal),t.normal=r.add(c,t.normal).normal(),!0)},c.prototype.computeAABB=function(t,e,i){const s=r.add(e.p,n.mulVec2(e.q,this.m_p));t.lowerBound.set(s.x-this.m_radius,s.y-this.m_radius),t.upperBound.set(s.x+this.m_radius,s.y+this.m_radius)},c.prototype.setAABB=function(t,e,i){this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_p)},c.prototype.resetAABB=function(t,e,i){return t.containsPoints(this.m_radius,this.m_p)?null:(this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_p),t)},c.prototype.computeMass=function(t,e){t.mass=e*o.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+r.dot(this.m_p,this.m_p))},c.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius}},function(t,e,i){t.exports=f;i(2);const s=i(5),o=i(1),n=i(6),r=i(3),m=i(0),c=i(4),h=i(13),l=new m;let a=new m,_=new m;const u=new m,p=new m;let y=new m;const d=new r;function f(t){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof f))return new f(t);f._super.call(this),this.m_type=f.TYPE,this.m_radius=c.polygonRadius,this.m_edgeRadius=0,this.m_centroid=m.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,this.m_outsidePoint=new m(1,1),t&&t.length&&this._set(t)}f._super=h,f.prototype=s(f._super.prototype),f.TYPE="polygon",f.prototype.setRadius=function(t){this.m_radius=c.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},f.prototype.getRadius=function(){return this.m_edgeRadius},f.prototype.getVertex=function(t){return this.m_vertices[t]},f.prototype._clone=function(){const t=new f;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.copy(this.m_centroid),t.m_outsidePoint.copy(this.m_outsidePoint);for(let e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(let e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t},f.prototype.getChildCount=function(){return 1},f.prototype._set=function(t){if(t.length<3)return void this._setAsBox(1,1);let e=o.min(t.length,c.maxPolygonVertices);const i=[];let s=0;for(let o=0;o<e;++o){const e=t[o];let n=!0;for(let t=0;t<s;++t)if(e.x===i[t].x&&e.y===i[t].y){n=!1;break}n&&(i[s++]=e)}if(e=s,e<3)return void this._setAsBox(1,1);let n=0,r=i[0].x;for(let t=1;t<e;++t){const e=i[t].x;(e>r||e===r&&i[t].y<i[n].y)&&(n=t,r=e)}const h=[];let l=0,a=n;for(;;){h[l]=a;let t=0;for(let s=1;s<e;++s){if(t===a){t=s;continue}const e=m.sub(i[t],i[h[l]]),o=m.sub(i[s],i[h[l]]),n=m.crossVV(e,o);n<0&&(t=s),0===n&&o.lengthSquared()>e.lengthSquared()&&(t=s)}if(++l,a=t,t===n)break}if(l<3)this._setAsBox(1,1);else{if(this.m_count=l,l>0){let t=-1/0,e=t;for(let s,o=0;o<l;++o)s=this.m_vertices[o]=i[h[o]],s.x>t&&(t=s.x),s.y>e&&(e=s.y);this.m_outsidePoint.x=t+1,this.m_outsidePoint.y=e+1}for(let t=0;t<l;++t){const e=t,i=t+1<l?t+1:0,s=m.sub(this.m_vertices[i],this.m_vertices[e]);this.m_normals[t]=m.crossVS(s,1,new m),this.m_normals[t].normalize()}this.m_centroid=function(t,e){const i=m.zero();let s=0;const o=m.zero(),n=1/3;for(let r=0;r<e;++r){const c=o,h=t[r],l=r+1<e?t[r+1]:t[0],a=m.sub(h,c),_=m.sub(l,c),u=.5*m.crossVV(a,_);s+=u,i.addMul(u*n,c),i.addMul(u*n,h),i.addMul(u*n,l)}return i.mul(1/s),i}(this.m_vertices,l)}},f.prototype._setAsBox=function(t,e,i,s){if(this.m_vertices[3]?(this.m_vertices[0].set(-t,-e),this.m_vertices[1].set(t,-e),this.m_vertices[2].set(t,e),this.m_vertices[3].set(-t,e)):(this.m_vertices[0]=m.neo(-t,-e),this.m_vertices[1]=m.neo(t,-e),this.m_vertices[2]=m.neo(t,e),this.m_vertices[3]=m.neo(-t,e)),this.m_normals[3]?(this.m_normals[0].set(0,-1),this.m_normals[1].set(1,0),this.m_normals[2].set(0,1),this.m_normals[3].set(-1,0)):(this.m_normals[0]=m.neo(0,-1),this.m_normals[1]=m.neo(1,0),this.m_normals[2]=m.neo(0,1),this.m_normals[3]=m.neo(-1,0)),this.m_count=4,m.isValid(i)&&(i.x<-o.EPSILON||o.EPSILON<i.x||i.y<-o.EPSILON||o.EPSILON<i.y)){s=s||0,this.m_centroid.copy(i),d.set(s);let t=-1/0,e=t;for(let s,o=0;o<this.m_count;++o)s=this.m_vertices[o]=this.m_vertices[o].rot(d).add(i),this.m_normals[o]=this.m_normals[o].rot(d),s.x>t&&(t=s.x),s.y>e&&(e=s.y);this.m_outsidePoint.x=t+1,this.m_outsidePoint.y=e+1}else this.m_outsidePoint.x=this.m_outsidePoint.y=(t>e?t:e)+1},f.prototype.testPoint=function(t,e){const i=l.copy(e).sub(t.p).rotT(t.q);for(let t=0;t<this.m_count;++t){if(m.dot(this.m_normals[t],a.copy(i).sub(this.m_vertices[t]))>0)return!1}return!0},f.prototype.rayCast=function(t,e,i,s){a.copy(e.p1),_.copy(e.p2),a=a.sub(i.p).rotT(i.q),_=_.sub(i.p).rotT(i.q),y=y.copy(_).sub(a);const n=m.dot(y,y)<=o.EPSILON;n&&(y=y.copy(this.m_outsidePoint).sub(a));const r=e.maxFraction;let c,h,d=r,f=-1,x=0;for(let e=this.m_count,s=0;s<e;++s){u.copy(this.m_vertices[s]);const e=this.m_normals[s],_=m.dot(e,l.copy(u).sub(a)),g=m.dot(e,y);if(-o.EPSILON<=g&&g<=o.EPSILON)continue;const v=_/g;l.copy(y).mul(v).add(a),p.copy(this.m_vertices[s+1<this.m_count?s+1:0]);const A=m.dot(u.sub(l),p.sub(l));let b=A<o.EPSILON;if(b){if(c=0,h=r,b=v>=0,b&&(A>-o.EPSILON?g<0?x-=.5:x+=.5:x+=1),g<0&&b){if(c<=h)return!n&&(t.fraction=v,t.normal=y.copy(this.m_normals[s]).rot(i.q),!0);c=v}else{if(!(g>0&&v<h))continue;h=v}c<=h&&v<=d&&(f=s,d=v)}}return x<0&&(x=-x),o.abs(x%2-1)<o.EPSILON?(t.fraction=0,t.normal=n?m.ZERO:y.neg().normal().rot(i.q),!0):f>=0&&!n&&(t.fraction=d,t.normal=y.copy(this.m_normals[f]).rot(i.q),!0)},f.prototype.computeAABB=function(t,e,i){let s=1/0,r=1/0,m=-1/0,c=-1/0;for(let t=0;t<this.m_count;++t){const i=n.mulVec2(e,this.m_vertices[t],u);s=o.min(s,i.x),m=o.max(m,i.x),r=o.min(r,i.y),c=o.max(c,i.y)}t.lowerBound.set(s,r),t.upperBound.set(m,c),t.extend(this.m_radius)},f.prototype.setAABB=f.prototype.computeAABB,f.prototype.resetAABB=function(t,e,i){return this.computeAABB(t,e,i),t},f.prototype.computeMass=function(t,e){const i=m.zero();let s=0,o=0;const n=m.zero();for(let t=0;t<this.m_count;++t)n.add(this.m_vertices[t]);n.mul(1/this.m_count);const r=1/3;for(let t=0;t<this.m_count;++t){const e=m.sub(this.m_vertices[t],n),c=t+1<this.m_count?m.sub(this.m_vertices[t+1],n):m.sub(this.m_vertices[0],n),h=m.cross(e,c),l=.5*h;s+=l,i.addCombine(l*r,e,l*r,c);const a=e.x,_=e.y,u=c.x,p=c.y;o+=.25*r*h*(a*a+u*a+u*u+(_*_+p*_+p*p))}t.mass=e*s,i.mul(1/s),t.center.setCombine(1,i,1,n),t.I=e*o,t.I+=t.mass*(m.dot(t.center,t.center)-m.dot(i,i))},f.prototype.validate=function(){for(let t=0;t<this.m_count;++t){const e=t,i=t<this.m_count-1?e+1:0,s=this.m_vertices[e],o=m.sub(this.m_vertices[i],s);for(let t=0;t<this.m_count;++t){if(t===e||t===i)continue;const n=m.sub(this.m_vertices[t],s);if(m.cross(o,n)<0)return!1}}return!0},f.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}},function(t,e,i){t.exports=o;i(2);const s=i(1);function o(t,e,i){if(!(this instanceof o))return new o(t,e,i);void 0===t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i)}o.neo=function(t,e,i){const s=Object.create(o.prototype);return s.x=t,s.y=e,s.z=i,s},o.clone=function(t){return o.neo(t.x,t.y,t.z)},o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)&&s.isFinite(t.z)},o.assert=function(t){},o.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},o.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},o.areEqual=function(t,e){return t==e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y&&t.z===e.z},o.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},o.cross=function(t,e){return new o(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},o.add=function(t,e){return new o(t.x+e.x,t.y+e.y,t.z+e.z)},o.sub=function(t,e){return new o(t.x-e.x,t.y-e.y,t.z-e.z)},o.mul=function(t,e){return new o(e*t.x,e*t.y,e*t.z)},o.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},o.neg=function(t){return new o(-t.x,-t.y,-t.z)}},function(t,e,i){t.exports=d;const s=i(5),o=i(4),n=i(13),r=i(1),m=i(6),c=i(3),h=i(0);let l=new h,a=new h,_=new h,u=new h,p=new h,y=new h;function d(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof d))return new d(t,e,i);d._super.call(this),this.m_type=d.TYPE,this.m_vertex1=t?h.clone(t):h.zero(),this.m_vertex2=e?h.clone(e):h.zero(),this.setRadius(i),this.m_vertex0=h.zero(),this.m_vertex3=h.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this.m_noAlignRot=!0}d._super=n,d.prototype=s(d._super.prototype),d.TYPE="edge",d.prototype.setRadius=function(t){this.m_radius=o.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},d.prototype.getRadius=function(){return this.m_edgeRadius},d.prototype.setVertex1=function(t,e){this.m_vertex1.set(t,e),this.m_noAlignRot=!0},d.prototype.setVertex2=function(t,e){this.m_vertex2.set(t,e),this.m_noAlignRot=!0},d.prototype.setNext=function(t){return t?(this.m_vertex3.copy(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},d.prototype.setPrev=function(t){return t?(this.m_vertex0.copy(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},d.prototype._set=function(t,e){return this.m_vertex1.copy(t),this.m_vertex2.copy(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this.m_noAlignRot=!0,this},d.prototype._clone=function(){const t=new d;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.copy(this.m_vertex1),t.m_vertex2.copy(this.m_vertex2),t.m_vertex0.copy(this.m_vertex0),t.m_vertex3.copy(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t.m_edgeRadius=this.m_edgeRadius,t},d.prototype.getChildCount=function(){return 1},d.prototype.testPoint=function(t,e){if(this.m_edgeRadius<=0)return!1;e=a.copy(e).sub(t.p).rotT(t.q),this.m_noAlignRot&&(this.m_alignRot=this._getAlignRot(),this.m_alignedV2=this._alignPoint((this.m_alignedV2||new h).copy(this.m_vertex2))),e=this._alignPoint(e);const i=this.m_alignedV2,s=this.m_edgeRadius;if(e.y>i.y){const t=e.x-i.x,o=e.y-i.y;return t*t+o*o<=s*s}return e.y<0?e.x*e.x+e.y*e.y<=s*s:-s<=e.x&&e.x<=s},d.prototype._getAlignRot=function(){const t=this.m_alignRot=this.m_alignRot||new c;this.m_noAlignRot=!1;const e=this.m_vertex1,i=this.m_vertex2,s=y.copy(i).sub(e).length();return s<=r.EPSILON||(t.c=y.y/s,t.s=y.x/s),t},d.prototype._alignPoint=function(t){return t.sub(this.m_vertex1).rot(this.m_alignRot)},d.prototype.rayCast=function(t,e,i,s){if(this.m_edgeRadius>0)return this.rayCastWithRadius(t,e,i);u=u.copy(this.m_vertex1),p=p.copy(this.m_vertex2),p=p.sub(u);const o=p;l=l.set(o.y,-o.x);const n=l,m=n.normalize();if(m<=r.EPSILON)return!1;a=a.copy(e.p1).sub(i.p).rotT(i.q),_=_.copy(e.p2).sub(i.p).rotT(i.q),y=y.copy(_).sub(a);const c=h.dot(n,y);if(c<=r.EPSILON)return!1;_=_.copy(u).sub(a);const d=h.dot(n,_),f=d/c;if(f<0||e.maxFraction<f)return!1;const x=m*m;y=y.mul(f),a=a.add(y);let g=a;g=g.sub(u);const v=h.dot(g,o)/x;return!(v<0||v>1)&&(t.fraction=f,t.normal=d>0?n.rot(i.q).neg():n.rot(i.q),!0)},d.prototype.rayCastWithRadius=function(t,e,i){l=l.copy(e.p2).sub(e.p1);const s=l.normalize();if(r.EPSILON>=s&&s>=-r.EPSILON)return!!this.testPoint(i,e.p1)&&(t.fraction=0,t.normal=l.neg(),!0);const o=this.m_edgeRadius,n=function(t,e,i,s,o){const n=u,m=p,c=y;n.copy(s).sub(i),m.copy(t).sub(i);const l=h.dot(n,n),a=h.dot(n,e),_=h.dot(n,m),d=h.dot(e,m),f=h.dot(m,m),x=l-a*a;let g=l*d-_*a,v=l*f-_*_-o*o*l,A=g*g-x*v;if(A>=0){const i=(-g-r.sqrt(A))/x,n=_+i*a;if(n>0&&n<l)return i;if(n<=0?c.copy(m):c.copy(t).sub(s),g=h.dot(e,c),v=h.dot(c,c)-o*o,A=g*g-v,A>0)return-g-r.sqrt(A)}return 1/0}(e.p1,l,this.m_vertex1,this.m_vertex2,o);if(n>s)return!1;if(n<=0)return!!this.testPoint(i,e.p1)&&(t.fraction=0,t.normal=l.neg(),!0);this.m_noAlignRot&&(this.m_alignRot=this._getAlignRot(),this.m_alignedV2=this._alignPoint((this.m_alignedV2||new h).copy(this.m_vertex2)));const m=this.m_alignedV2.y;return l=this._alignPoint(l.mul(n).add(e.p1)),l.y>m?l.y-=m:l.y>0&&(l.y=0),t.normal=l.mul(1/o).rotT(this.m_alignRot).rot(i.q),t.fraction=n/s,!0},d.prototype.computeAABB=function(t,e,i){const s=m.mulVec2(e,this.m_vertex1),o=m.mulVec2(e,this.m_vertex2);t.combinePoints(s,o),t.extend(this.m_radius)},d.prototype.setAABB=function(t,e,i){this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_vertex1,this.m_vertex2)},d.prototype.resetAABB=function(t,e,i){return t.containsPoints(this.m_radius,this.m_vertex1,this.m_vertex2)?null:(this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_vertex1,this.m_vertex2),t)},d.prototype.computeMass=function(t,e){t.mass=0,t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},d.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}},function(t,e,i){t.exports=n;i(2);const s=i(0),o=i(17);function n(t,e,i){"object"==typeof t&&null!==t?(this.ex=o.clone(t),this.ey=o.clone(e),this.ez=o.clone(i)):(this.ex=o(),this.ey=o(),this.ez=o())}n.prototype.toString=function(){return JSON.stringify(this)},n.isValid=function(t){return t&&o.isValid(t.ex)&&o.isValid(t.ey)&&o.isValid(t.ez)},n.assert=function(t){},n.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},n.prototype.solve33=function(t){let e=o.dot(this.ex,o.cross(this.ey,this.ez));0!=e&&(e=1/e);const i=new o;return i.x=e*o.dot(t,o.cross(this.ey,this.ez)),i.y=e*o.dot(this.ex,o.cross(t,this.ez)),i.z=e*o.dot(this.ex,o.cross(this.ey,t)),i},n.prototype.solve22=function(t){const e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y;let r=e*n-i*o;0!=r&&(r=1/r);const m=s.zero();return m.x=r*(n*t.x-i*t.y),m.y=r*(e*t.y-o*t.x),m},n.prototype.getInverse22=function(t){const e=this.ex.x,i=this.ey.x,s=this.ex.y,o=this.ey.y;let n=e*o-i*s;0!=n&&(n=1/n),t.ex.x=n*o,t.ey.x=-n*i,t.ex.z=0,t.ex.y=-n*s,t.ey.y=n*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},n.prototype.getSymInverse33=function(t){let e=o.dot(this.ex,o.cross(this.ey,this.ez));0!=e&&(e=1/e);const i=this.ex.x,s=this.ey.x,n=this.ez.x,r=this.ey.y,m=this.ez.y,c=this.ez.z;t.ex.x=e*(r*c-m*m),t.ex.y=e*(n*m-s*c),t.ex.z=e*(s*m-n*r),t.ey.x=t.ex.y,t.ey.y=e*(i*c-n*n),t.ey.z=e*(n*s-i*m),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*r-s*s)},n.mul=function(t,e){if(e&&"z"in e&&"y"in e&&"x"in e){let i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,s=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z;const n=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new o(i,s,n)}if(e&&"y"in e&&"x"in e){let i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}},n.mulVec3=function(t,e){const i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,s=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,n=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new o(i,s,n)},n.mulVec2=function(t,e){const i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)},n.add=function(t,e){return new n(o.add(t.ex+e.ex),o.add(t.ey+e.ey),o.add(t.ez+e.ez))}},function(t,e,i){t.exports=m;i(2);const s=i(1),o=i(0),n=i(3),r=i(6);function m(t,e){this.localCenter=o.zero(),this.c=o.zero(),this.a=0,this.alpha0=0,this.c0=o.zero(),this.c1=o.zero(),this.a0=0}m.prototype.setTransform=function(t){const e=r.mulVec2(t,this.localCenter);this.c.copy(e),this.c0.copy(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()},m.prototype.setLocalCenter=function(t,e){this.localCenter.copy(t);const i=r.mulVec2(e,this.localCenter);this.c.copy(i),this.c0.copy(i)},m.prototype.getTransform=function(t,e){e=void 0===e?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.setCombine(1-e,this.c0,e,this.c),t.p.sub(n.mulVec2(t.q,this.localCenter))},m.prototype.advance=function(t){const e=(t-this.alpha0)/(1-this.alpha0);this.c0.setCombine(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},m.prototype.forward=function(){this.a0=this.a,this.c0.copy(this.c)},m.prototype.normalize=function(){const t=s.mod(this.a0,-s.PI,+s.PI);this.a-=this.a0-t,this.a0=t},m.prototype.clone=function(){const t=new m;return t.localCenter.copy(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.copy(this.c0),t.c.copy(this.c),t},m.prototype.set=function(t){this.localCenter.copy(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.copy(t.c0),this.c.copy(t.c)}},function(t,e,i){t.exports=c;const s=i(5),o=i(4),n=i(0),r=i(18),m=i(1);function c(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof c))return new c(t,e,i);c._super.call(this,t,e,i),this.m_type=c.TYPE}c._super=r,c.prototype=s(c._super.prototype),c.TYPE="capsule",c.prototype.computeMass=function(t,e){const i=t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),s=this.m_vertex1.x-i.x,o=this.m_vertex1.y-i.y,n=m.sqrt(s*s+o*o),r=this.m_radius,c=r*r,h=e*(m.PI*c),l=.5*h,a=3/8*r,_=a+n,u=.5*(.5*h*c)-l*a*a+l*_*_,p=2*e*n,y=p*(c+n*n)/3;t.mass=h+p,t.I=y+2*u},c.prototype.initCollisionData=function(){this.m_vertices||(this.m_vertices=[new n,new n,new n,new n],this.m_normals=[new n,new n,new n,new n],this.m_centroid=new n,this.m_count=4);const t=this.m_vertices,e=this.m_normals,i=.01*o.polygonRadius,s=e[1].copy(this.m_vertex2).sub(this.m_vertex1).normal(),r=e[0].set(s.y,-s.x);t[0].copy(this.m_vertex1).addMul(-i,s).addMul(i,r),t[1].copy(this.m_vertex2).addMul(i,s).addMul(i,r),t[2].copy(this.m_vertex2).addMul(i,s).addMul(-i,r),t[3].copy(this.m_vertex1).addMul(-i,s).addMul(-i,r),e[2].copy(r).mul(-1),e[3].copy(s).mul(-1),this.m_centroid.copy(this.m_vertex1).add(this.m_vertex2).mul(.5)}},function(t,e,i){t.exports=l;const s=i(5),o=i(0),n=i(4),r=i(13),m=i(16),c=i(31);let h;function l(t){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof l))return new l(t);l._super.call(this),this.m_type=l.TYPE,this.m_radius=n.polygonRadius,this.m_polygons=[],this.m_count=0,t&&t.length&&this._set(t)}l._super=r,l.prototype=s(l._super.prototype),l.TYPE="composite_polygon",l.prototype._clone=function(){const t=new l;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count;for(let e=0;e<this.m_count;e++)t.m_polygons.push(this.m_polygons[e].clone());return t},l.prototype.getChildCount=function(){return this.m_count},l.prototype.getChildPolygon=function(t){return this.m_polygons[t]},l.prototype._set=function(t){const e=c.tesselate({contours:t,windingRule:c.WINDING_ODD,elementType:c.POLYGONS,polySize:8,vertexSize:2}),i=e.vertices,s=e.elements,n=s.length;this.m_polygons=new Array(e.elementCount);for(let t=0,e=0;t<n;t+=8){const n=[];for(let e=0;e<8;++e){const r=s[t+e];r<0||n.push(new o(i[2*r],i[2*r+1]))}this.m_polygons[e++]=new m(n)}this.m_count=this.m_polygons.length},l.prototype.testPoint=function(t,e){for(let i=0;i<this.m_count;++i)if(this.m_polygons[i].testPoint(t,e))return!0;return!1},l.prototype.rayCast=function(t,e,i,s){return this.m_polygons[s].rayCast(t,e,i,0)},l.prototype.computeAABB=function(t,e,i){this.m_polygons[i].computeAABB(t,e,0)},l.prototype.setAABB=l.prototype.computeAABB,l.prototype.resetAABB=function(t,e,i){return this.computeAABB(t,e,i),t},l.prototype.computeMass=function(t,e){const i=this.m_count;if(1===i)return void this.m_polygons[0].computeMass(t,e);const s=t.center.setZero();let n=t.mass=0,r=t.I=0;if(!(i<1)){h=h||{center:new o,mass:0,I:0};for(let t=0;t<i;++t){this.m_polygons[t].computeMass(h,e);const i=h.mass,m=h.center;s.addMul(i,m),n+=i,r+=h.I+i*o.dot(m,m)}n>0?s.mul(1/n):(s.setZero(),n=0),r>0&&(r-=n*o.dot(s,s)),r<0&&(r=0),t.mass=n,t.I=r}},l.prototype.computeDistanceProxy=function(t,e){this.m_polygons[e].computeDistanceProxy(t)}},function(t,e){e.toString=function(t){t="string"==typeof t?t:"\n";let e="";for(const i in this)"function"!=typeof this[i]&&"object"!=typeof this[i]&&(e+=i+": "+this[i]+t);return e}},function(t,e,i){const s=1e-4;t.exports=f;i(2);const o=i(7),n=i(0),r=i(3),m=(i(1),i(20)),c=i(6),h=i(35),l=i(36),a=i(28),_=f.STATIC="static",u=f.KINEMATIC="kinematic",p=f.DYNAMIC="dynamic",y=n.zero(),d={type:_,position:n.zero(),angle:0,linearVelocity:n.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,fixedX:!1,fixedY:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null,defaultMass:1};function f(t,e){e=o(e,d),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_fixedXFlag=e.fixedX,this.m_fixedYFlag=e.fixedY,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_dirtyTransformFlag=!0,this.m_userData=e.userData,this.m_type=e.type,this.m_defaultMass=e.defaultMass>s?e.defaultMass:s,this.m_mass=this.m_defaultMass,this.m_invMass=this.m_type==p?1/this.m_mass:0,this.m_blankFixturesFlag=!0,this.m_I=0,this.m_invI=0,this.m_xf=c.identity(),this.m_xf.p.copy(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new m,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new h,this.c_position=new l,this.m_force=n.zero(),this.m_torque=0,this.m_linearVelocity=n.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1,this.m_layer=0,this.m_layerMask=0}function x(){this.mass=0,this.center=n.zero(),this.I=0}f.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},f.prototype.getWorld=function(){return this.m_world},f.prototype.getNext=function(){return this.m_next},f.prototype.setUserData=function(t){this.m_userData=t},f.prototype.getUserData=function(){return this.m_userData},f.prototype.getFixtureList=function(){return this.m_fixtureList},f.prototype.getJointList=function(){return this.m_jointList},f.prototype.getContactList=function(){return this.m_contactList},f.prototype.isStatic=function(){return this.m_type==_},f.prototype.isDynamic=function(){return this.m_type==p},f.prototype.isKinematic=function(){return this.m_type==u},f.prototype.setStatic=function(){return this.setType(_),this},f.prototype.setDynamic=function(){return this.setType(p),this},f.prototype.setKinematic=function(){return this.setType(u),this},f.prototype.getType=function(){return this.m_type},f.prototype.setType=function(t){if(1==this.isWorldLocked())return;if(this.m_type==t)return;this.m_type=t,this.resetMassData(),this.m_type==_&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;let e=this.m_contactList;for(;e;){const t=e;e=e.next,this.m_world.destroyContact(t.contact)}this.m_contactList=null;const i=this.m_world.m_broadPhase;for(let t=this.m_fixtureList;t;t=t.m_next){const e=t.m_proxyCount;for(let s=0;s<e;++s)i.touchProxy(t.m_proxies[s].proxyId)}},f.prototype.isBullet=function(){return this.m_bulletFlag},f.prototype.setBullet=function(t){this.m_bulletFlag=!!t},f.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},f.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},f.prototype.isAwake=function(){return this.m_awakeFlag},f.prototype.setAwake=function(t){t?0==this.m_awakeFlag&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},f.prototype.isActive=function(){return this.m_activeFlag},f.prototype.setActive=function(t){if(t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag){let t=this.m_world.m_broadPhase;for(let e=this.m_fixtureList;e;e=e.m_next)e.createProxies(t,this.m_xf)}else{let t=this.m_world.m_broadPhase;for(let e=this.m_fixtureList;e;e=e.m_next)e.destroyProxies(t);let e=this.m_contactList;for(;e;){const t=e;e=e.next,this.m_world.destroyContact(t.contact)}this.m_contactList=null}},f.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},f.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},f.prototype.isFixedX=function(){return this.m_fixedXFlag},f.prototype.setFixedX=function(t){this.m_fixedXFlag!=t&&(this.m_fixedXFlag=!!t,this.m_linearVelocity.x=0)},f.prototype.isFixedY=function(){return this.m_fixedYFlag},f.prototype.setFixedY=function(t){this.m_fixedYFlag!=t&&(this.m_fixedYFlag=!!t,this.m_linearVelocity.y=0)},f.prototype.getTransform=function(){return this.m_xf},f.prototype.setTransform=function(t,e){if(1==this.isWorldLocked())return;this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);const i=this.m_world.m_broadPhase;for(let t=this.m_fixtureList;t;t=t.m_next)t.synchronize(i,this.m_xf,this.m_xf);this.setAwake(!0),this.m_dirtyTransformFlag=!0},f.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1),this.m_dirtyTransformFlag=!0},f.prototype.dirtifyTransform=function(t){this.m_dirtyTransformFlag=t},f.prototype.isDirtyTransform=function(){return this.m_dirtyTransformFlag},f.prototype.synchronizeFixtures=function(){const t=c.identity();this.m_sweep.getTransform(t,0);const e=this.m_world.m_broadPhase;for(let i=this.m_fixtureList;i;i=i.m_next)i.synchronize(e,t,this.m_xf)},f.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},f.prototype.getPosition=function(){return this.m_xf.p},f.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},f.prototype.getAngle=function(){return this.m_sweep.a},f.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},f.prototype.getWorldCenter=function(){return this.m_sweep.c},f.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},f.prototype.setLocalCenter=function(t){if(this.m_localCenter){if(!t)return this.m_localCenter=t,void this.resetMassData();if(this.m_localCenter.closeTo(t))return}if(!t)return void(this.m_localCenter=t);if(this.m_localCenter=t=n.clone(t),this.isStatic()||this.isKinematic())return this.m_sweep.setLocalCenter(t,this.m_xf),void(this.m_sweep.a0=this.m_sweep.a);const e=n.clone(this.m_sweep.c),i=n.clone(this.m_sweep.localCenter);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_Inertia>0?this.setInertia(this.m_Inertia):this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I+=this.m_mass*(n.dot(i,i)-n.dot(t,t)),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),this.m_linearVelocity.add(n.cross(this.m_angularVelocity,n.sub(this.m_sweep.c,e)))},f.prototype.getLinearVelocity=function(){return this.m_linearVelocity},f.prototype.getLinearVelocityFromWorldPoint=function(t){const e=n.sub(t,this.m_sweep.c);return n.add(this.m_linearVelocity,n.cross(this.m_angularVelocity,e))},f.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},f.prototype.setLinearVelocity=function(t){this.m_type!=_&&(n.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.copy(t))},f.prototype.getAngularVelocity=function(){return this.m_angularVelocity},f.prototype.setAngularVelocity=function(t){this.m_type!=_&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},f.prototype.getLinearDamping=function(){return this.m_linearDamping},f.prototype.setLinearDamping=function(t){this.m_linearDamping=t},f.prototype.getAngularDamping=function(){return this.m_angularDamping},f.prototype.setAngularDamping=function(t){this.m_angularDamping=t},f.prototype.getGravityScale=function(){return this.m_gravityScale},f.prototype.setGravityScale=function(t){this.m_gravityScale=t},f.prototype.getMass=function(){return this.m_mass},f.prototype.fixturesAreBlank=function(){return this.m_blankFixturesFlag},f.prototype.getInertia=function(){return this.m_I+this.m_mass*n.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},f.prototype.setInertia=function(t){this.m_Inertia=t;const e=this.m_mass*n.dot(this.m_sweep.localCenter,this.m_sweep.localCenter);this.m_I=t-=e,t>0&&0==this.m_fixedRotationFlag?this.m_invI=1/t:(this.m_I=0,this.m_invI=0,this.m_Inertia=e)},f.prototype.getDefaultMass=function(){return this.m_defaultMass},f.prototype.setDefaultMass=function(t){this.m_defaultMass=t>s?t:s},f.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.copy(this.m_sweep.localCenter)},f.prototype.resetMassData=function(){if(this.m_I=0,this.m_invI=0,this.m_invMass=0,this.m_localCenter||this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic())return this.m_localCenter||(this.m_sweep.c0.copy(this.m_xf.p),this.m_sweep.c.copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a),void(this.m_mass=this.m_defaultMass);this.m_mass=0;const t=this.m_localCenter||n.zero();for(let e=this.m_fixtureList;e;e=e.m_next){if(0==e.m_density)continue;const i=new x;e.getMassData(i);const s=i.mass,o=i.center;this.m_mass+=s,this.m_localCenter||t.addMul(s,o),this.m_I+=i.I+s*n.dot(o,o)}this.m_mass>s?(this.m_invMass=1/this.m_mass,this.m_localCenter||t.mul(this.m_invMass),this.m_blankFixturesFlag=!1):(this.m_mass=1,this.m_invMass=1,this.m_blankFixturesFlag=!0);let e=null;this.m_localCenter||(e=n.clone(this.m_sweep.c),this.m_sweep.setLocalCenter(t,this.m_xf)),this.m_Inertia>0?this.setInertia(this.m_Inertia):this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*n.dot(t,t),this.m_I<=0&&(this.m_I=1),this.m_invI=1/this.m_I):0==this.m_fixedRotationFlag?(this.m_I=1,this.m_invI=1):(this.m_I=0,this.m_invI=0),this.m_localCenter||(n.crossSV(this.m_angularVelocity,n.sub(this.m_sweep.c,e),y),this.m_linearVelocity.add(y))},f.prototype.setMassData=function(t){if(1==this.isWorldLocked())return;if(this.m_type!=p)return;if(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=this.m_defaultMass),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*n.dot(t.center,t.center),this.m_I<=0&&(this.m_I=1),this.m_invI=1/this.m_I),this.m_localCenter)return;const e=n.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(n.cross(this.m_angularVelocity,n.sub(this.m_sweep.c,e)))};const g=n.zero();f.prototype.applyForce=function(t,e,i){this.m_type==p&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=n.crossVV(n.subInto(e,this.m_sweep.c,g),t)))},f.prototype.applyForceToCenter=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},f.prototype.applyTorque=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},f.prototype.applyLinearImpulse=function(t,e,i){this.m_type==p&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*n.cross(n.sub(e,this.m_sweep.c),t)))},f.prototype.applyLinearImpulseToCenter=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_linearVelocity.addMul(this.m_invMass,t))},f.prototype.applyAngularImpulse=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},f.prototype.setLayer=function(t){this.m_layer=t;for(let t=this.getFixtureList();t;t=t.getNext())t.refilter()},f.prototype.setLayerMask=function(t){this.m_layerMask=t},f.prototype.shouldCollide=function(t){if(this.m_world.collision_matrix[this.m_layer]&t.m_layerMask)return!1;for(let e=this.m_jointList;e;e=e.next)if(e.other.equals(t)&&0==e.joint.m_collideConnected)return!1;return!0},f.prototype.createFixture=function(t,e){if(1==this.isWorldLocked())return null;const i=new a(this,t,e);if(this.m_activeFlag&&i.isActive()){const t=this.m_world.m_broadPhase;i.createProxies(t,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,i.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=i.isActive(),i},f.prototype.destroyFixture=function(t){if(1==this.isWorldLocked())return;let e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else{let i=this.m_fixtureList;for(;null!=i;){if(i.m_next===t){i.m_next=t.m_next,e=!0;break}i=i.m_next}}let i=this.m_contactList;for(;i;){const e=i.contact;i=i.next;const s=e.getFixtureA(),o=e.getFixtureB();t!=s&&t!=o||this.m_world.destroyContact(e)}if(this.m_activeFlag){const e=this.m_world.m_broadPhase;t.destroyProxies(e)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()},f.prototype.getWorldPoint=function(t,e){return c.mulVec2(this.m_xf,t,e)},f.prototype.getWorldVector=function(t){return r.mulVec2(this.m_xf.q,t)},f.prototype.getLocalPoint=function(t,e){return c.mulTVec2(this.m_xf,t,e)},f.prototype.getLocalVector=function(t){return r.mulTVec2(this.m_xf.q,t)},f.prototype.equals=function(t){return this===t}},function(t,e,i){t.exports=function(t,e){const i=o.now();++n.toiCalls,t.state=d.e_unknown,t.t=e.tMax;const m=e.proxyA,c=e.proxyB,h=e.sweepA,p=e.sweepB;h.normalize(),p.normalize();const x=e.tMax,g=m.m_radius+c.m_radius,v=r.max(s.linearSlop,g-3*s.linearSlop),A=.25*s.linearSlop;let b=0;const B=s.maxTOIIterations;let w=0;const C=new y;t.cache=C;const I=new _;for(I.proxyA=e.proxyA,I.proxyB=e.proxyB,I.useRadii=!1;;){const e=l.identity(),i=l.identity();h.getTransform(e,b),p.getTransform(i,b),I.transformA=e,I.transformB=i;const o=new u;if(a(o,C,I),o.distance<=0){t.state=d.e_overlapped,t.t=0;break}if(o.distance<v+A){t.state=d.e_touching,t.t=b;break}const _=new f;_.initialize(C,m,h,c,p,b);let y=!1,g=x,S=0;for(;;){let e=_.findMinSeparation(g);if(e>v+A){t.state=d.e_separated,t.t=x,y=!0;break}if(e>v-A){b=g;break}let i=_.evaluate(b);if(i<v-A){t.state=d.e_failed,t.t=b,y=!0;break}if(i<=v+A){t.state=d.e_touching,t.t=b,y=!0;break}let o=0,m=b,c=g;for(;;){let t;t=1&o?m+(v-i)*(c-m)/(e-i):.5*(m+c),++o,++n.toiRootIters;const s=_.evaluate(t);if(r.abs(s-v)<A){g=t;break}if(s>v?(m=t,i=s):(c=t,e=s),50==o)break}if(n.toiMaxRootIters=r.max(n.toiMaxRootIters,o),++S,S==s.maxPolygonVertices)break}if(++w,++n.toiIters,y)break;if(w==B){t.state=d.e_failed,t.t=b;break}}n.toiMaxIters=r.max(n.toiMaxIters,w);const S=o.diff(i);n.toiMaxTime=r.max(n.toiMaxTime,S),n.toiTime+=S},t.exports.Input=function(){this.proxyA=new p,this.proxyB=new p,this.sweepA=new h,this.sweepB=new h,this.tMax},t.exports.Output=d;const s=i(4),o=(i(2),i(40)),n=i(23),r=i(1),m=i(0),c=i(3),h=i(20),l=i(6),a=i(14),_=a.Input,u=a.Output,p=a.Proxy,y=a.Cache;function d(){this.state,this.t,this.cache}d.e_unknown=0,d.e_failed=1,d.e_overlapped=2,d.e_touching=3,d.e_separated=4,n.toiTime=0,n.toiMaxTime=0,n.toiCalls=0,n.toiIters=0,n.toiMaxIters=0,n.toiRootIters=0,n.toiMaxRootIters=0;function f(){this.m_proxyA=new p,this.m_proxyB=new p,this.m_sweepA,this.m_sweepB,this.m_type,this.m_localPoint=m.zero(),this.m_axis=m.zero()}f.prototype.initialize=function(t,e,i,s,o,n){this.m_proxyA=e,this.m_proxyB=s;const r=t.count;this.m_sweepA=i,this.m_sweepB=o;const h=l.identity(),a=l.identity();if(this.m_sweepA.getTransform(h,n),this.m_sweepB.getTransform(a,n),1==r){this.m_type=1;let e=this.m_proxyA.getVertex(t.indexA[0]),i=this.m_proxyB.getVertex(t.indexB[0]),s=l.mulVec2(h,e),o=l.mulVec2(a,i);return this.m_axis.setCombine(1,o,-1,s),this.m_axis.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=3;const i=s.getVertex(t.indexB[0]),o=s.getVertex(t.indexB[1]);this.m_axis=m.cross(m.sub(o,i),1),this.m_axis.normalize();let n=c.mulVec2(a.q,this.m_axis);this.m_localPoint=m.mid(i,o);let r=l.mulVec2(a,this.m_localPoint),_=e.getVertex(t.indexA[0]),u=l.mulVec2(h,_),p=m.dot(u,n)-m.dot(r,n);return p<0&&(this.m_axis=m.neg(this.m_axis),p=-p),p}{this.m_type=2;const e=this.m_proxyA.getVertex(t.indexA[0]),i=this.m_proxyA.getVertex(t.indexA[1]);this.m_axis=m.cross(m.sub(i,e),1),this.m_axis.normalize();let s=c.mulVec2(h.q,this.m_axis);this.m_localPoint=m.mid(e,i);let o=l.mulVec2(h,this.m_localPoint),n=this.m_proxyB.getVertex(t.indexB[0]),r=l.mulVec2(a,n),_=m.dot(r,s)-m.dot(o,s);return _<0&&(this.m_axis=m.neg(this.m_axis),_=-_),_}},f.prototype.compute=function(t,e){const i=l.identity(),s=l.identity();switch(this.m_sweepA.getTransform(i,e),this.m_sweepB.getTransform(s,e),this.m_type){case 1:{if(t){let t=c.mulTVec2(i.q,this.m_axis),e=c.mulTVec2(s.q,m.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(t),this.indexB=this.m_proxyB.getSupport(e)}let e=this.m_proxyA.getVertex(this.indexA),o=this.m_proxyB.getVertex(this.indexB),n=l.mulVec2(i,e),r=l.mulVec2(s,o);return m.dot(r,this.m_axis)-m.dot(n,this.m_axis)}case 2:{let e=c.mulVec2(i.q,this.m_axis),o=l.mulVec2(i,this.m_localPoint);if(t){let t=c.mulTVec2(s.q,m.neg(e));this.indexA=-1,this.indexB=this.m_proxyB.getSupport(t)}let n=this.m_proxyB.getVertex(this.indexB),r=l.mulVec2(s,n);return m.dot(r,e)-m.dot(o,e)}case 3:{let e=c.mulVec2(s.q,this.m_axis),o=l.mulVec2(s,this.m_localPoint);if(t){let t=c.mulTVec2(i.q,m.neg(e));this.indexB=-1,this.indexA=this.m_proxyA.getSupport(t)}let n=this.m_proxyA.getVertex(this.indexA),r=l.mulVec2(i,n);return m.dot(r,e)-m.dot(o,e)}default:return t&&(this.indexA=-1,this.indexB=-1),0}},f.prototype.findMinSeparation=function(t){return this.compute(!0,t)},f.prototype.evaluate=function(t){return this.compute(!1,t)}},function(t,e,i){t.exports=m;const s=i(5),o=i(16),n=i(0),r=new(i(3));function m(t,e,i,s){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof m))return new m(t,e,i,s);m._super.call(this),this.hx=1,this.hy=1,this.center=n.zero(),this.angle=0,"number"==typeof t&&(this.hx=t),"number"==typeof e&&(this.hy=e),"object"==typeof i&&n.isValid(i)&&(this.center=i),"number"==typeof s&&(this.angle=s),this._setAsBox(this.hx,this.hy,this.center,this.angle)}m._super=o,m.prototype=s(m._super.prototype),m.TYPE="polygon",m.prototype.setSize=function(t,e){this.hx=t,this.hy=e,this._setAsBox(this.hx,this.hy,this.center,this.angle)},m.prototype.setAngle=function(t){this.angle=t,this._setAsBox(this.hx,this.hy,this.center,this.angle)},m.prototype.setCenter=function(t){this.center=t,this._setAsBox(this.hx,this.hy,this.center,this.angle)},m.prototype._setAsBox=function(t,e,i,s){if(this.m_vertices[3]?(this.m_vertices[0].set(-t,-e),this.m_vertices[1].set(t,-e),this.m_vertices[2].set(t,e),this.m_vertices[3].set(-t,e)):(this.m_vertices[0]=n.neo(-t,-e),this.m_vertices[1]=n.neo(t,-e),this.m_vertices[2]=n.neo(t,e),this.m_vertices[3]=n.neo(-t,e)),this.m_normals[3]?(this.m_normals[0].set(0,-1),this.m_normals[1].set(1,0),this.m_normals[2].set(0,1),this.m_normals[3].set(-1,0)):(this.m_normals[0]=n.neo(0,-1),this.m_normals[1]=n.neo(1,0),this.m_normals[2]=n.neo(0,1),this.m_normals[3]=n.neo(-1,0)),this.m_count=4,n.isValid(i)){s=s||0,this.m_centroid.copy(i),r.setAngle(s);let t=-1/0,e=t;for(let s,o=0;o<this.m_count;++o)s=this.m_vertices[o]=this.m_vertices[o].rot(r).add(i),this.m_normals[o]=this.m_normals[o].rot(r),s.x>t&&(t=s.x),s.y>e&&(e=s.y);this.m_outsidePoint.x=t+1,this.m_outsidePoint.y=e+1}else this.m_outsidePoint.x=this.m_outsidePoint.y=(t>e?t:e)+1}},function(t,e,i){t.exports=l;i(2);const s=i(5),o=i(6),n=i(0),r=i(4),m=i(13),c=i(18);let h;function l(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof l))return new l(t,e,i);l._super.call(this),this.m_type=l.TYPE,this.m_radius=r.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,i>0?(this.m_edgeRadius=i,this.m_radius+=i):this.m_edgeRadius=0,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}l._super=m,l.prototype=s(l._super.prototype),l.TYPE="chain",l.prototype._createLoop=function(t){this.m_vertices.length=0,this.m_count=t.length+1;for(let e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_vertices[t.length]=t[0].clone(),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},l.prototype._createChain=function(t){this.m_count=this.m_vertices.length=t.length;for(let e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},l.prototype._setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},l.prototype._setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},l.prototype.setRadius=function(t){this.m_radius=r.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},l.prototype.getRadius=function(){return this.m_edgeRadius},l.prototype._clone=function(){const t=new l;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},l.prototype.getChildCount=function(){return this.m_count>0?this.m_count-1:0},l.prototype.getChildEdge=function(t,e){t.m_type=c.TYPE,t.m_radius=this.m_radius,t.m_edgeRadius=this.m_edgeRadius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},l.prototype.getVertex=function(t){return t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},l.prototype.testPoint=function(t,e){if(this.m_edgeRadius<=0||this.m_count<2)return!1;const i=this.m_vertices;if(h?(h._set(i[0],i[1]),h.setRadius(this.m_edgeRadius)):h=new c(i[0],i[1],this.m_edgeRadius),h.testPoint(t,e))return!0;for(let s=this.m_count,o=2;o<s;++o)if(h._set(i[o-1],i[o]),h.testPoint(t,e))return!0;return!1},l.prototype.rayCast=function(t,e,i,s){return h?(h._set(this.getVertex(s),this.getVertex(s+1)),h.setRadius(this.m_edgeRadius)):h=new c(this.getVertex(s),this.getVertex(s+1),this.m_edgeRadius),h.rayCast(t,e,i,0)},l.prototype.computeAABB=function(t,e,i){const s=o.mulVec2(e,this.getVertex(i)),n=o.mulVec2(e,this.getVertex(i+1));t.combinePoints(s,n),t.extend(this.m_radius)},l.prototype.setAABB=function(t,e,i){let s=this.getVertex(i),n=this.getVertex(i+1);const r=this.m_radius;t.storePoints(r,s,n),s=o.mulVec2(e,s),n=o.mulVec2(e,n),t.combinePoints(s,n),t.extend(r)},l.prototype.resetAABB=function(t,e,i){let s=this.getVertex(i),n=this.getVertex(i+1);const r=this.m_radius;return t.containsPoints(r,s,n)?null:(t.storePoints(r,s,n),s=o.mulVec2(e,s),n=o.mulVec2(e,n),t.combinePoints(s,n),t.extend(r),t)},l.prototype.computeMass=function(t,e){t.mass=0,t.center=n.zero(),t.I=0},l.prototype.computeDistanceProxy=function(t,e){t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius}},function(t,e,i){t.exports=l;i(2);const s=i(7),o=i(1),n=i(0),r=i(12),m=i(14),c={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,active:!0,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function h(t,e){this.aabb=new r,this.fixture=t,this.childIndex=e,this.proxyId=null}function l(t,e,i){if(e.shape?(i=e,e=e.shape):"number"==typeof i&&(i={density:i}),i=s(i,c),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_activeFlag=i.active,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0,this.m_activeFlag){const t=this.m_proxyCount=this.m_shape.getChildCount();for(let e=0;e<t;++e)this.m_proxies[e]=new h(this,e)}this.m_userData=i.userData}l.prototype.getType=function(){return this.m_shape.getType()},l.prototype.getShape=function(){return this.m_shape},l.prototype.isSensor=function(){return this.m_isSensor},l.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},l.prototype.getUserData=function(){return this.m_userData},l.prototype.setUserData=function(t){this.m_userData=t},l.prototype.getBody=function(){return this.m_body},l.prototype.getNext=function(){return this.m_next},l.prototype.getDensity=function(){return this.m_density},l.prototype.setDensity=function(t){this.m_density=t},l.prototype.getFriction=function(){return this.m_friction},l.prototype.setFriction=function(t){this.m_friction=t},l.prototype.getRestitution=function(){return this.m_restitution},l.prototype.setRestitution=function(t){this.m_restitution=t},l.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},l.prototype.rayCast=function(t,e,i){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),i)},l.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},l.prototype.getAABB=function(t){return this.m_proxies[t].aabb},l.prototype.getProxyId=function(t){return this.m_proxies[t].proxyId},l.prototype.getProxyCount=function(){return this.m_proxyCount},l.prototype.createProxies=function(t,e){if(!this.m_activeFlag)return;let i;t=t||this.m_body.getWorld().m_broadPhase,e=e||this.m_body.getTransform(),this.m_proxyCount=this.m_shape.getChildCount();let s=this.m_proxies.length,n=0;for(let r=o.min(this.m_proxyCount,s);n<r;++n)i=this.m_proxies[n],null===i.proxyId?(this.m_shape.setAABB(i.aabb,e,n),i.proxyId=t.createProxy(i.aabb,i)):this.m_shape.resetAABB(i.aabb,e,n)&&(t.destroyProxy(i.proxyId),i.proxyId=t.createProxy(i.aabb,i));if(s>this.m_proxyCount){for(;n<s;++n)this.m_proxies[n].proxyId&&t.destroyProxy(this.m_proxies[n].proxyId);this.m_proxies.length=this.m_proxyCount}else if(s<this.m_proxyCount)for(s=this.m_proxies.length=this.m_proxyCount;n<s;++n)i=this.m_proxies[n]=new h(this,n),this.m_shape.setAABB(i.aabb,e,n),i.proxyId=t.createProxy(i.aabb,i);this.refilter()},l.prototype.destroyProxies=function(t){for(let e=0;e<this.m_proxyCount;++e){const i=this.m_proxies[e];i.proxyId&&(t.destroyProxy(i.proxyId),i.proxyId=null)}this.m_proxyCount=0},l.prototype.synchronize=function(t,e,i){if(this.m_activeFlag)for(let s=0;s<this.m_proxyCount;++s){const o=this.m_proxies[s];if(o.fixture._isFaux)continue;const m=new r,c=new r;this.m_shape.computeAABB(m,e,o.childIndex),this.m_shape.computeAABB(c,i,o.childIndex),o.aabb.combine(m,c);const h=n.sub(i.p,e.p);t.moveProxy(o.proxyId,o.aabb,h)}},l.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},l.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},l.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},l.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},l.prototype.refilter=function(){if(null==this.m_body||!this.m_activeFlag)return;let t=this.m_body.getContactList();for(;t;){const e=t.contact,i=e.getFixtureA(),s=e.getFixtureB();i!=this&&s!=this||e.flagForFiltering(),t=t.next}const e=this.m_body.getWorld();if(null==e)return;const i=e.m_broadPhase;for(let t=0;t<this.m_proxyCount;++t)i.touchProxy(this.m_proxies[t].proxyId)},l.prototype.shouldCollide=function(t){if(t.m_filterGroupIndex==this.m_filterGroupIndex&&0!=t.m_filterGroupIndex)return t.m_filterGroupIndex>0;return 0!=(t.m_filterMaskBits&this.m_filterCategoryBits)&&0!=(t.m_filterCategoryBits&this.m_filterMaskBits)},l.prototype.isActive=function(){return this.m_activeFlag},l.prototype.setActive=function(t){if(t==this.m_activeFlag)return;this.m_activeFlag=!!t;const e=this.m_body;this.m_activeFlag?this.createProxies(e.getWorld().m_broadPhase,e.getTransform()):this.destroyProxies(e.getWorld().m_broadPhase)},l.prototype.queryOverlaps=function(t){if(!this.m_activeFlag||0==this.m_proxyCount)return;const e=this.m_body.getWorld();if(null!=e){this._reportOverlap==l.prototype._reportOverlap&&(this._reportOverlap=this._reportOverlap.bind(this)),this._overlaps={},this._overlapCallback=t,this._transform=this.m_body.getTransform();for(let t=0;t<this.m_proxyCount;++t)this._childIndex=t,e.queryAABB(this.m_proxies[t].aabb,this._reportOverlap);this._transform=this._childIndex=this._overlaps=this._overlapCallback=t=null}},l.prototype._reportOverlap=function(t,e){if(t==this)return!0;const i=t.m_proxies[0].proxyId;return!(!this._overlaps[i]&&m.testOverlap(this.m_shape,this._childIndex,t.m_shape,e.childIndex,this._transform,t.m_body.getTransform()))||(this._overlaps[i]=!0,this._overlapCallback(t))}},function(t,e,i){const s=i(4),o=(i(2),i(39)),n=i(0),r=i(1),m=i(12);function c(t){this.id=t,this.aabb=new m,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}function h(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new o({create:function(){return new c}})}t.exports=h,c.prototype.isLeaf=function(){return null==this.child1},h.prototype.getUserData=function(t){const e=this.m_nodes[t];return e.userData},h.prototype.getFatAABB=function(t){const e=this.m_nodes[t];return e.aabb},h.prototype.allocateNode=function(){const t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t},h.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]},h.prototype.createProxy=function(t,e){const i=this.allocateNode();return i.aabb.set(t),m.extend(i.aabb,s.aabbExtension),i.userData=e,i.height=0,this.insertLeaf(i),i.id},h.prototype.destroyProxy=function(t){const e=this.m_nodes[t];this.removeLeaf(e),this.freeNode(e)},h.prototype.moveProxy=function(t,e,i){const o=this.m_nodes[t];return!o.aabb.contains(e)&&(this.removeLeaf(o),o.aabb.set(e),e=o.aabb,m.extend(e,s.aabbExtension),i.x<0?e.lowerBound.x+=i.x*s.aabbMultiplier:e.upperBound.x+=i.x*s.aabbMultiplier,i.y<0?e.lowerBound.y+=i.y*s.aabbMultiplier:e.upperBound.y+=i.y*s.aabbMultiplier,this.insertLeaf(o),!0)},h.prototype.insertLeaf=function(t){if(null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);const e=t.aabb;let i=this.m_root;for(;0==i.isLeaf();){let t=i.child1,s=i.child2;const o=i.aabb.getPerimeter(),n=new m;n.combine(i.aabb,e);const r=n.getPerimeter(),c=2*r,h=2*(r-o);let l,a;if(t.isLeaf()){let i=new m;i.combine(e,t.aabb),l=i.getPerimeter()+h}else{let i=new m;i.combine(e,t.aabb);let s=t.aabb.getPerimeter();l=i.getPerimeter()-s+h}if(s.isLeaf()){let t=new m;t.combine(e,s.aabb),a=t.getPerimeter()+h}else{let t=new m;t.combine(e,s.aabb);let i=s.aabb.getPerimeter();a=t.getPerimeter()-i+h}if(c<l&&c<a)break;i=l<a?t:s}const s=i,o=s.parent,n=this.allocateNode();for(n.parent=o,n.userData=null,n.aabb.combine(e,s.aabb),n.height=s.height+1,null!=o?(o.child1==s?o.child1=n:o.child2=n,n.child1=s,n.child2=t,s.parent=n,t.parent=n):(n.child1=s,n.child2=t,s.parent=n,t.parent=n,this.m_root=n),i=t.parent;null!=i;){i=this.balance(i);let t=i.child1,e=i.child2;i.height=1+r.max(t.height,e.height),i.aabb.combine(t.aabb,e.aabb),i=i.parent}},h.prototype.removeLeaf=function(t){if(t==this.m_root)return void(this.m_root=null);const e=t.parent,i=e.parent;let s;if(s=e.child1==t?e.child2:e.child1,null!=i){i.child1==e?i.child1=s:i.child2=s,s.parent=i,this.freeNode(e);let t=i;for(;null!=t;){t=this.balance(t);const e=t.child1,i=t.child2;t.aabb.combine(e.aabb,i.aabb),t.height=1+r.max(e.height,i.height),t=t.parent}}else this.m_root=s,s.parent=null,this.freeNode(e)},h.prototype.balance=function(t){const e=t;if(e.isLeaf()||e.height<2)return t;const i=e.child1,s=e.child2,o=s.height-i.height;if(o>1){const o=s.child1,n=s.child2;return s.child1=e,s.parent=e.parent,e.parent=s,null!=s.parent?s.parent.child1==t?s.parent.child1=s:s.parent.child2=s:this.m_root=s,o.height>n.height?(s.child2=o,e.child2=n,n.parent=e,e.aabb.combine(i.aabb,n.aabb),s.aabb.combine(e.aabb,o.aabb),e.height=1+r.max(i.height,n.height),s.height=1+r.max(e.height,o.height)):(s.child2=n,e.child2=o,o.parent=e,e.aabb.combine(i.aabb,o.aabb),s.aabb.combine(e.aabb,n.aabb),e.height=1+r.max(i.height,o.height),s.height=1+r.max(e.height,n.height)),s}if(o<-1){const t=i.child1,o=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1==e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,t.height>o.height?(i.child2=t,e.child1=o,o.parent=e,e.aabb.combine(s.aabb,o.aabb),i.aabb.combine(e.aabb,t.aabb),e.height=1+r.max(s.height,o.height),i.height=1+r.max(e.height,t.height)):(i.child2=o,e.child1=t,t.parent=e,e.aabb.combine(s.aabb,t.aabb),i.aabb.combine(e.aabb,o.aabb),e.height=1+r.max(s.height,t.height),i.height=1+r.max(e.height,o.height)),i}return e},h.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},h.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;const t=this.m_root.aabb.getPerimeter();let e,i=0;const s=p.allocate().preorder();for(;e=s.next();)e.height<0||(i+=e.aabb.getPerimeter());return p.release(s),i/t},h.prototype.validateStructure=function(t){if(null==t)return;this.m_root;const e=t.child1,i=t.child2;t.isLeaf()||(this.validateStructure(e),this.validateStructure(i))},h.prototype.validateMetrics=function(t){if(null==t)return;const e=t.child1,i=t.child2;if(t.isLeaf())return;const s=this.m_nodes[e].height,o=this.m_nodes[i].height,n=(r.max(s,o),new m);n.combine(e.aabb,i.aabb),this.validateMetrics(e),this.validateMetrics(i)},h.prototype.getMaxBalance=function(){let t,e=0;const i=p.allocate().preorder();for(;t=i.next();){if(t.height<=1)continue;const i=r.abs(t.child2.height-t.child1.height);e=r.max(e,i)}return p.release(i),e},h.prototype.rebuildBottomUp=function(){const t=[];let e,i=0;const s=p.allocate().preorder();for(;e=s.next();)e.height<0||(e.isLeaf()?(e.parent=null,t[i]=e,++i):this.freeNode(e));for(p.release(s);i>1;){let e=1/0,s=-1,o=-1;for(let n=0;n<i;++n){const r=t[n].aabb;for(let c=n+1;c<i;++c){const i=t[c].aabb,h=new m;h.combine(r,i);const l=h.getPerimeter();l<e&&(s=n,o=c,e=l)}}const n=t[s],c=t[o],h=this.allocateNode();h.child1=n,h.child2=c,h.height=1+r.max(n.height,c.height),h.aabb.combine(n.aabb,c.aabb),h.parent=null,n.parent=h,c.parent=h,t[o]=t[i-1],t[s]=h,--i}this.m_root=t[0]},h.prototype.shiftOrigin=function(t){let e;const i=p.allocate().preorder();for(;e=i.next();){const i=e.aabb;i.lowerBound.x-=t.x,i.lowerBound.y-=t.y,i.upperBound.x-=t.x,i.upperBound.y-=t.y}p.release(i)};const l=[];let a=0;h.prototype.query=function(t,e){a=-1,l[++a]=this.m_root;const i=t.lowerBound,s=t.upperBound;for(;a>=0;){const t=l[a--],o=t.aabb.lowerBound,n=t.aabb.upperBound;if(!(o.x>s.x||i.x>n.x||o.y>s.y||i.y>n.y))if(t.isLeaf()){if(!1===e(t.id,t.userData))break}else l[++a]=t.child1,l[++a]=t.child2}},h.prototype.rayCast=function(t,e,i,s,o){i=i||t.p1,s=s||t.p2;const c=n.sub(s,i);c.normalize();const h=n.cross(1,c),l=n.abs(h);o=o>=0?o:t.maxFraction;const a=new m;let p=n.combine(1-o,i,o,s);a.combinePoints(i,p);const y=u.allocate(),d=_.allocate();for(y.push(this.m_root);y.length>0;){const t=y.pop();if(null==t)continue;if(0==m.testOverlap(t.aabb,a))continue;const c=t.aabb.getCenter(),_=t.aabb.getExtents();if(!(r.abs(n.dot(h,n.sub(i,c)))-n.dot(l,_)>0))if(t.isLeaf()){d.p1=n.clone(i),d.p2=n.clone(s),d.maxFraction=o;const r=e(d,t.id,t.userData);if(0==r)break;r>0&&(o=r,p=n.combine(1-o,i,o,s),a.combinePoints(i,p))}else y.push(t.child1),y.push(t.child2)}u.release(y),_.release(d)};let _=new o({create:function(){return{}},release:function(t){}}),u=new o({create:function(){return[]},release:function(t){t.length=0}}),p=new o({create:function(){return new y},release:function(t){t.close()}});function y(){const t=[],e=[];return{preorder:function(i){return t.length=0,t.push(i),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){const i=t.length-1,s=t[i];if(0===e[i])return e[i]=1,s;if(1===e[i]&&(e[i]=2,s.child1))return t.push(s.child1),e.push(1),s.child1;if(2===e[i]&&(e[i]=3,s.child2))return t.push(s.child2),e.push(1),s.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}},function(t,e,i){const s=i(25),o=s.Input,n=s.Output,r=i(6),m=i(0),c=i(12),h=i(1),l=i(15),a=i(26),_=i(21);function u(t){this.world=t,this.shape,this.distance,this.currentDistance,this.callback,this.proxies,this.xfA=new r,this.cA=new m,this.fraction=1,this.scale=1,this.canReduceAaab=!0,this.aabbStart=new c,this.aabbEnd=new c,this.aabb=new c,this.handleFixture=this.handleFixture.bind(this),this.circle,this.box,this.capsule}function p(t,e,i,o,r){const m=new n;if(s(m,t),m.state!==n.e_touching&&m.state!==n.e_overlapped)return;const c=new d,h=c.evaluate(m.cache,t.proxyA,t.sweepA,t.proxyB,t.sweepB,m.t);this.normal=m.state===n.e_touching?c.m_normalB:c.m_normalB.neg(),this.centroid=c.m_centroid,i*=m.t,this.distance=i,this.fraction=i/o,this.point=c.m_type===y?c.m_pointA.addMul(-.5*(h+r),this.normal):c.m_pointB.addMul(.5*(h-r),this.normal),this.fixture=e}t.exports=u,u.prototype.castCircle=function(t,e,i,s,o){this.circle?this.circle.setRadius(e):this.circle=new l(e),this.execute(this.circle,t,0,i,s,o)},u.prototype.castBox=function(t,e,i,s,o,n,r){this.box?this.box._setAsBox(e,i):this.box=new a(e,i),this.execute(this.box,t,s,o,n,r)},u.prototype.castCapsule=function(t,e,i,s,o,n,r,m){this.capsule?(this.capsule.setVertex1(e),this.capsule.setVertex2(i),this.capsule.setRadius(s)):this.capsule=new _(e,i,s),this.execute(this.capsule,t,o,n,r,m)},u.prototype.execute=function(t,e,i,s,o,n){this.shape=t,this.callback=n;const r=this.xfA;r.p.copy(e),r.q.setAngle(i);const m=s.normalize();this.scale=m>0?m:1,this.distance=o,this.fraction=1,this.canReduceAaab=!0,this.proxies={};const c=this.aabbStart,h=this.aabbEnd,l=this.aabb;for(t.computeAABB(c,r,0);this.canReduceAaab;)this.canReduceAaab=!1,this.currentDistance=this.fraction*o,this.cA.copy(e).addMul(this.currentDistance,s),r.p.copy(this.cA),t.computeAABB(h,r,0),l.combine(c,h),r.p.copy(e),this.world.queryAABB(l,this.handleFixture);this.callback=this.proxies=null},u.prototype.handleFixture=function(t,e){const i=e.proxyId;if(this.proxies[i])return!0;this.proxies[i]=!0;const s=this.getIntersection(t,e.childIndex);if(!s.fixture)return!0;const o=this.callback(s,s.distance/this.distance);return!(o<this.fraction)||(this.fraction=o,this.canReduceAaab=!0,!1)},u.prototype.getIntersection=function(t,e){const i=new o;i.sweepA.setTransform(this.xfA),i.sweepA.c.copy(this.cA),i.proxyA.set(this.shape,0),i.sweepB.setTransform(t.m_body.getTransform());const s=t.getShape();return i.proxyB.set(s,e),i.tMax=1,new p(i,t,this.currentDistance,this.scale,this.shape.m_radius-s.m_radius)};let y=3;function d(){this.m_type,this.m_normalB,this.m_pointA,this.m_pointB,this.m_centroid}d.prototype.evaluate=function(t,e,i,s,o,n){const c=r.identity(),l=r.identity();if(i.getTransform(c,n),o.getTransform(l,n),this.m_centroid=c.p,1===t.count){this.m_type=1;let i=e.getVertex(t.indexA[0]),o=s.getVertex(t.indexB[0]),n=r.mulVec2(c,i),h=r.mulVec2(l,o);return this.m_normalB=m.combine(1,n,-1,h),this.m_pointA=n,this.m_pointB=h,this.m_normalB.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=y;const i=s.getVertex(t.indexB[0]),o=s.getVertex(t.indexB[1]);let n=m.sub(o,i);n.set(n.y,-n.x).normalize();let h=n.rot(l.q),a=m.mid(i,o),_=r.mulVec2(l,a,a),u=e.getVertex(t.indexA[0]),p=r.mulVec2(c,u),d=m.dot(p,h)-m.dot(_,h);return this.m_pointA=p,this.m_pointB=_,d<0?(this.m_normalB=h.neg(),d=-d):this.m_normalB=h,d}if(t.indexB[0]==t.indexB[1]){this.m_type=2;const i=e.getVertex(t.indexA[0]),o=e.getVertex(t.indexA[1]);let n=m.sub(o,i);n.set(n.y,-n.x).normalize();let h=n.rot(c.q),a=m.mid(i,o),_=r.mulVec2(c,a,a),u=s.getVertex(t.indexB[0]),p=r.mulVec2(l,u),y=m.dot(p,h)-m.dot(_,h);return this.m_pointA=_,this.m_pointB=p,y<0?(this.m_normalB=h,y=-y):this.m_normalB=h.neg(),y}{this.m_type=y;const i=r.mulVec2(c,e.getVertex(t.indexA[0])),o=r.mulVec2(c,e.getVertex(t.indexA[1])),n=r.mulVec2(l,s.getVertex(t.indexB[0])),a=r.mulVec2(l,s.getVertex(t.indexB[1]));let _=m.mid(i,o),u=m.mid(n,a);const p=m.mid(_,u),d=o.sub(i),f=p.clone().sub(i),x=m.dot(d,d);this.m_pointA=x<h.EPSILON?i:d.mul(m.dot(f,d)/x).add(i);const g=a.sub(n),v=p.clone().sub(n),A=m.dot(g,g);this.m_pointB=A<h.EPSILON?n:g.mul(m.dot(v,g)/A).add(n),this.m_normalB=p.copy(this.m_pointA).sub(this.m_pointB);let b=this.m_normalB.normalize();return b<=h.EPSILON&&this.m_normalB.set(0,1),b}}},function(t,e){const i={},s={};t.exports=i,i.WINDING_ODD=0,i.WINDING_NONZERO=1,i.WINDING_POSITIVE=2,i.WINDING_NEGATIVE=3,i.WINDING_ABS_GEQ_TWO=4,i.POLYGONS=0,i.CONNECTED_POLYGONS=1,i.BOUNDARY_CONTOURS=2,i.tesselate=function(t){const e=t.debug||!1,s=new d;for(let e=0;e<t.contours.length;e++)s.addContour(t.vertexSize||2,t.contours[e]);return s.tesselate(t.windingRule||i.WINDING_ODD,t.elementType||i.POLYGONS,t.polySize||3,t.vertexSize||2,t.normal||[0,0,1]),{vertices:s.vertices,vertexIndices:s.vertexIndices,vertexCount:s.vertexCount,elements:s.elements,elementCount:s.elementCount,mesh:e?s.mesh:void 0}};const o=function(t){if(!t)throw new Error("Assertion Failed!")};function n(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}function r(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}function m(t){this.next=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Org=null,this.Lface=null,this.activeRegion=null,this.winding=0,this.side=t}function c(){const t=new n,e=new r,i=new m(0),s=new m(1);t.next=t.prev=t,t.anEdge=null,e.next=e.prev=e,e.anEdge=null,e.trail=null,e.marked=!1,e.inside=!1,i.next=i,i.Sym=s,i.Onext=null,i.Lnext=null,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,s.next=s,s.Sym=i,s.Onext=null,s.Lnext=null,s.Org=null,s.Lface=null,s.winding=0,s.activeRegion=null,this.vHead=t,this.fHead=e,this.eHead=i,this.eHeadSym=s}function h(){this.key=null,this.next=null,this.prev=null}function l(t,e){this.head=new h,this.head.next=this.head,this.head.prev=this.head,this.frame=t,this.leq=e}function a(){this.handle=null}function _(){this.key=null,this.node=null}function u(t,e){let i;for(this.size=0,this.max=t,this.nodes=[],this.nodes.length=t+1,i=0;i<this.nodes.length;i++)this.nodes[i]=new a;for(this.handles=[],this.handles.length=t+1,i=0;i<this.handles.length;i++)this.handles[i]=new _;this.initialized=!1,this.freeList=0,this.leq=e,this.nodes[1].handle=1,this.handles[1].key=null}function p(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}m.prototype={get Rface(){return this.Sym.Lface},set Rface(t){this.Sym.Lface=t},get Dst(){return this.Sym.Org},set Dst(t){this.Sym.Org=t},get Oprev(){return this.Sym.Lnext},set Oprev(t){this.Sym.Lnext=t},get Lprev(){return this.Onext.Sym},set Lprev(t){this.Onext.Sym=t},get Dprev(){return this.Lnext.Sym},set Dprev(t){this.Lnext.Sym=t},get Rprev(){return this.Sym.Onext},set Rprev(t){this.Sym.Onext=t},get Dnext(){return this.Sym.Onext.Sym},set Dnext(t){this.Sym.Onext.Sym=t},get Rnext(){return this.Sym.Lnext.Sym},set Rnext(t){this.Sym.Lnext.Sym=t}},c.prototype={makeEdge_:function(t){const e=new m(0),i=new m(1);t.Sym.side<t.side&&(t=t.Sym);const s=t.Sym.next;return i.next=s,s.Sym.next=e,e.next=t,t.Sym.next=i,e.Sym=i,e.Onext=e,e.Lnext=i,e.Org=null,e.Lface=null,e.winding=0,e.activeRegion=null,i.Sym=e,i.Onext=i,i.Lnext=e,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,e},splice_:function(t,e){const i=t.Onext,s=e.Onext;i.Sym.Lnext=e,s.Sym.Lnext=t,t.Onext=s,e.Onext=i},makeVertex_:function(t,e,i){const s=t;o(null!==s);const n=i.prev;s.prev=n,n.next=s,s.next=i,i.prev=s,s.anEdge=e;let r=e;do{r.Org=s,r=r.Onext}while(r!==e)},makeFace_:function(t,e,i){const s=t;o(null!==s);const n=i.prev;s.prev=n,n.next=s,s.next=i,i.prev=s,s.anEdge=e,s.trail=null,s.marked=!1,s.inside=i.inside;let r=e;do{r.Lface=s,r=r.Lnext}while(r!==e)},killEdge_:function(t){t.Sym.side<t.side&&(t=t.Sym);const e=t.next,i=t.Sym.next;e.Sym.next=i,i.Sym.next=e},killVertex_:function(t,e){const i=t.anEdge;let s=i;do{s.Org=e,s=s.Onext}while(s!==i);const o=t.prev,n=t.next;n.prev=o,o.next=n},killFace_:function(t,e){const i=t.anEdge;let s=i;do{s.Lface=e,s=s.Lnext}while(s!==i);const o=t.prev,n=t.next;n.prev=o,o.next=n},makeEdge:function(){const t=new n,e=new n,i=new r,s=this.makeEdge_(this.eHead);return this.makeVertex_(t,s,this.vHead),this.makeVertex_(e,s.Sym,this.vHead),this.makeFace_(i,s,this.fHead),s},splice:function(t,e){let i=!1,s=!1;if(t!==e){if(e.Org!==t.Org&&(s=!0,this.killVertex_(e.Org,t.Org)),e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(e,t),!s){const i=new n;this.makeVertex_(i,e,t.Org),t.Org.anEdge=t}if(!i){const i=new r;this.makeFace_(i,e,t.Lface),t.Lface.anEdge=t}}},delete:function(t){const e=t.Sym;let i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){const e=new r;this.makeFace_(e,t,t.Lface)}e.Onext===e?(this.killVertex_(e.Org,null),this.killFace_(e.Lface,null)):(t.Lface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),this.killEdge_(t)},addEdgeVertex:function(t){const e=this.makeEdge_(t),i=e.Sym;this.splice_(e,t.Lnext),e.Org=t.Dst;const s=new n;return this.makeVertex_(s,i,e.Org),e.Lface=i.Lface=t.Lface,e},splitEdge:function(t,e){const i=this.addEdgeVertex(t).Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i},connect:function(t,e){let i=!1;const s=this.makeEdge_(t),o=s.Sym;if(e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(s,t.Lnext),this.splice_(o,e),s.Org=t.Dst,o.Org=e.Org,s.Lface=o.Lface=t.Lface,t.Lface.anEdge=o,!i){const e=new r;this.makeFace_(e,s,t.Lface)}return s},zapFace:function(t){const e=t.anEdge;let i,s,o;s=e.Lnext;do{i=s,s=i.Lnext,i.Lface=null,null===i.Rface&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),o=i.Sym,o.Onext===o?this.killVertex_(o.Org,null):(o.Org.anEdge=o.Onext,this.splice_(o,o.Oprev)),this.killEdge_(i))}while(i!==e);const n=t.prev,r=t.next;r.prev=n,n.next=r},countFaceVerts_:function(t){let e=t.anEdge,i=0;do{i++,e=e.Lnext}while(e!==t.anEdge);return i},mergeConvexFaces:function(t){let e,i,o,n,r,m,c;for(e=this.fHead.next;e!==this.fHead;e=e.next)if(e.inside)for(i=e.anEdge,r=i.Org;o=i.Lnext,n=i.Sym,n&&n.Lface&&n.Lface.inside&&(m=this.countFaceVerts_(e),c=this.countFaceVerts_(n.Lface),m+c-2<=t&&s.vertCCW(i.Lprev.Org,i.Org,n.Lnext.Lnext.Org)&&s.vertCCW(n.Lprev.Org,n.Org,i.Lnext.Lnext.Org)&&(o=n.Lnext,this.delete(n),i=null,n=null)),!i||i.Lnext.Org!==r;)i=o;return!0},check:function(){const t=this.fHead,e=this.vHead,i=this.eHead;let s,n,r,m,c,h;for(n=t,n=t;(s=n.next)!==t;n=s){o(s.prev===n),c=s.anEdge;do{o(c.Sym!==c),o(c.Sym.Sym===c),o(c.Lnext.Onext.Sym===c),o(c.Onext.Sym.Lnext===c),o(c.Lface===s),c=c.Lnext}while(c!==s.anEdge)}for(o(s.prev===n&&null===s.anEdge),m=e,m=e;(r=m.next)!==e;m=r){o(r.prev===m),c=r.anEdge;do{o(c.Sym!==c),o(c.Sym.Sym===c),o(c.Lnext.Onext.Sym===c),o(c.Onext.Sym.Lnext===c),o(c.Org===r),c=c.Onext}while(c!==r.anEdge)}for(o(r.prev===m&&null===r.anEdge),h=i,h=i;(c=h.next)!==i;h=c)o(c.Sym.next===h.Sym),o(c.Sym!==c),o(c.Sym.Sym===c),o(null!==c.Org),o(null!==c.Dst),o(c.Lnext.Onext.Sym===c),o(c.Onext.Sym.Lnext===c);o(c.Sym.next===h.Sym&&c.Sym===this.eHeadSym&&c.Sym.Sym===c&&null===c.Org&&null===c.Dst&&null===c.Lface&&null===c.Rface)}},s.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},s.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},s.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},s.edgeGoesLeft=function(t){return s.vertLeq(t.Dst,t.Org)},s.edgeGoesRight=function(t){return s.vertLeq(t.Org,t.Dst)},s.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},s.edgeEval=function(t,e,i){o(s.vertLeq(t,e)&&s.vertLeq(e,i));const n=e.s-t.s,r=i.s-e.s;return n+r>0?n<r?e.t-t.t+(t.t-i.t)*(n/(n+r)):e.t-i.t+(i.t-t.t)*(r/(n+r)):0},s.edgeSign=function(t,e,i){o(s.vertLeq(t,e)&&s.vertLeq(e,i));const n=e.s-t.s,r=i.s-e.s;return n+r>0?(e.t-i.t)*n+(e.t-t.t)*r:0},s.transEval=function(t,e,i){o(s.transLeq(t,e)&&s.transLeq(e,i));const n=e.t-t.t,r=i.t-e.t;return n+r>0?n<r?e.s-t.s+(t.s-i.s)*(n/(n+r)):e.s-i.s+(i.s-t.s)*(r/(n+r)):0},s.transSign=function(t,e,i){o(s.transLeq(t,e)&&s.transLeq(e,i));const n=e.t-t.t,r=i.t-e.t;return n+r>0?(e.s-i.s)*n+(e.s-t.s)*r:0},s.vertCCW=function(t,e,i){return t.s*(e.t-i.t)+e.s*(i.t-t.t)+i.s*(t.t-e.t)>=0},s.interpolate=function(t,e,i,s){return(t=t<0?0:t)<=(i=i<0?0:i)?0===i?(e+s)/2:e+t/(t+i)*(s-e):s+i/(t+i)*(e-s)},s.intersect=function(t,e,i,o,n){let r,m,c;s.vertLeq(t,e)||(c=t,t=e,e=c),s.vertLeq(i,o)||(c=i,i=o,o=c),s.vertLeq(t,i)||(c=t,t=i,i=c,c=e,e=o,o=c),s.vertLeq(i,e)?s.vertLeq(e,o)?(r=s.edgeEval(t,i,e),m=s.edgeEval(i,e,o),r+m<0&&(r=-r,m=-m),n.s=s.interpolate(r,i.s,m,e.s)):(r=s.edgeSign(t,i,e),m=-s.edgeSign(t,o,e),r+m<0&&(r=-r,m=-m),n.s=s.interpolate(r,i.s,m,o.s)):n.s=(i.s+e.s)/2,s.transLeq(t,e)||(c=t,t=e,e=c),s.transLeq(i,o)||(c=i,i=o,o=c),s.transLeq(t,i)||(c=t,t=i,i=c,c=e,e=o,o=c),s.transLeq(i,e)?s.transLeq(e,o)?(r=s.transEval(t,i,e),m=s.transEval(i,e,o),r+m<0&&(r=-r,m=-m),n.t=s.interpolate(r,i.t,m,e.t)):(r=s.transSign(t,i,e),m=-s.transSign(t,o,e),r+m<0&&(r=-r,m=-m),n.t=s.interpolate(r,i.t,m,o.t)):n.t=(i.t+e.t)/2},l.prototype={min:function(){return this.head.next},max:function(){return this.head.prev},insert:function(t){return this.insertBefore(this.head,t)},search:function(t){let e=this.head;do{e=e.next}while(null!==e.key&&!this.leq(this.frame,t,e.key));return e},insertBefore:function(t,e){do{t=t.prev}while(null!==t.key&&!this.leq(this.frame,t.key,e));const i=new h;return i.key=e,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},delete:function(t){t.next.prev=t.prev,t.prev.next=t.next}},u.prototype={floatDown_:function(t){const e=this.nodes,i=this.handles;let s,n;const r=e[t].handle;for(;;){if(n=t<<1,n<this.size&&this.leq(i[e[n+1].handle].key,i[e[n].handle].key)&&++n,o(n<=this.max),s=e[n].handle,n>this.size||this.leq(i[r].key,i[s].key)){e[t].handle=r,i[r].node=t;break}e[t].handle=s,i[s].node=t,t=n}},floatUp_:function(t){const e=this.nodes,i=this.handles;let s,o;const n=e[t].handle;for(;;){if(o=t>>1,s=e[o].handle,0===o||this.leq(i[s].key,i[n].key)){e[t].handle=n,i[n].node=t;break}e[t].handle=s,i[s].node=t,t=o}},init:function(){for(let t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},min:function(){return this.handles[this.nodes[1].handle].key},insert:function(t){let e;const i=++this.size;if(2*i>this.max){let t,e;for(this.max*=2,e=this.nodes.length,this.nodes.length=this.max+1,t=e;t<this.nodes.length;t++)this.nodes[t]=new a;for(e=this.handles.length,this.handles.length=this.max+1,t=e;t<this.handles.length;t++)this.handles[t]=new _}return 0===this.freeList?e=i:(e=this.freeList,this.freeList=this.handles[e].node),this.nodes[i].handle=e,this.handles[e].node=i,this.handles[e].key=t,this.initialized&&this.floatUp_(i),e},extractMin:function(){const t=this.nodes,e=this.handles,i=t[1].handle,s=e[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,e[t[1].handle].node=1,e[i].key=null,e[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),s},delete:function(t){const e=this.nodes,i=this.handles;o(t>=1&&t<=this.max&&null!==i[t].key);const s=i[t].node;e[s].handle=e[this.size].handle,i[e[s].handle].node=s,--this.size,s<=this.size&&(s<=1||this.leq(i[e[s>>1].handle].key,i[e[s].handle].key)?this.floatDown_(s):this.floatUp_(s)),i[t].key=null,i[t].node=this.freeList,this.freeList=t}};const y={};function d(){this.mesh=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=i.WINDING_ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}y.regionBelow=function(t){return t.nodeUp.prev.key},y.regionAbove=function(t){return t.nodeUp.next.key},y.debugEvent=function(t){},y.addWinding=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},y.edgeLeq=function(t,e,i){const o=t.event,n=e.eUp,r=i.eUp;if(n.Dst===o)return r.Dst===o?s.vertLeq(n.Org,r.Org)?s.edgeSign(r.Dst,n.Org,r.Org)<=0:s.edgeSign(n.Dst,r.Org,n.Org)>=0:s.edgeSign(r.Dst,o,r.Org)<=0;if(r.Dst===o)return s.edgeSign(n.Dst,o,n.Org)>=0;return s.edgeEval(n.Dst,o,n.Org)>=s.edgeEval(r.Dst,o,r.Org)},y.deleteRegion=function(t,e){e.fixUpperEdge&&o(0===e.eUp.winding),e.eUp.activeRegion=null,t.dict.delete(e.nodeUp)},y.fixUpperEdge=function(t,e,i){o(e.fixUpperEdge),t.mesh.delete(e.eUp),e.fixUpperEdge=!1,e.eUp=i,i.activeRegion=e},y.topLeftRegion=function(t,e){const i=e.eUp.Org;let s;do{e=y.regionAbove(e)}while(e.eUp.Org===i);if(e.fixUpperEdge){if(s=t.mesh.connect(y.regionBelow(e).eUp.Sym,e.eUp.Lnext),null===s)return null;y.fixUpperEdge(t,e,s),e=y.regionAbove(e)}return e},y.topRightRegion=function(t){const e=t.eUp.Dst;do{t=y.regionAbove(t)}while(t.eUp.Dst===e);return t},y.addRegionBelow=function(t,e,i){const s=new p;return s.eUp=i,s.nodeUp=t.dict.insertBefore(e.nodeUp,s),s.fixUpperEdge=!1,s.sentinel=!1,s.dirty=!1,i.activeRegion=s,s},y.isWindingInside=function(t,e){switch(t.windingRule){case i.WINDING_ODD:return 0!=(1&e);case i.WINDING_NONZERO:return 0!==e;case i.WINDING_POSITIVE:return e>0;case i.WINDING_NEGATIVE:return e<0;case i.WINDING_ABS_GEQ_TWO:return e>=2||e<=-2}return o(!1),!1},y.computeWinding=function(t,e){e.windingNumber=y.regionAbove(e).windingNumber+e.eUp.winding,e.inside=y.isWindingInside(t,e.windingNumber)},y.finishRegion=function(t,e){const i=e.eUp,s=i.Lface;s.inside=e.inside,s.anEdge=i,y.deleteRegion(t,e)},y.finishLeftRegions=function(t,e,i){let s,o=null,n=e,r=e.eUp;for(;n!==i;){if(n.fixUpperEdge=!1,o=y.regionBelow(n),s=o.eUp,s.Org!==r.Org){if(!o.fixUpperEdge){y.finishRegion(t,n);break}s=t.mesh.connect(r.Lprev,s.Sym),y.fixUpperEdge(t,o,s)}r.Onext!==s&&(t.mesh.splice(s.Oprev,s),t.mesh.splice(r,s)),y.finishRegion(t,n),r=o.eUp,n=o}return r},y.addRightEdges=function(t,e,i,n,r,m){let c,h,l,a,_=!0;l=i;do{o(s.vertLeq(l.Org,l.Dst)),y.addRegionBelow(t,e,l.Sym),l=l.Onext}while(l!==n);for(null===r&&(r=y.regionBelow(e).eUp.Rprev),h=e,a=r;c=y.regionBelow(h),l=c.eUp.Sym,l.Org===a.Org;)l.Onext!==a&&(t.mesh.splice(l.Oprev,l),t.mesh.splice(a.Oprev,l)),c.windingNumber=h.windingNumber-l.winding,c.inside=y.isWindingInside(t,c.windingNumber),h.dirty=!0,!_&&y.checkForRightSplice(t,h)&&(y.addWinding(l,a),y.deleteRegion(t,h),t.mesh.delete(a)),_=!1,h=c,a=l;h.dirty=!0,o(h.windingNumber-l.winding===c.windingNumber),m&&y.walkDirtyRegions(t,h)},y.spliceMergeVertices=function(t,e,i){t.mesh.splice(e,i)},y.vertexWeights=function(t,e,i){const o=s.vertL1dist(e,t),n=s.vertL1dist(i,t),r=.5*n/(o+n),m=.5*o/(o+n);t.coords[0]+=r*e.coords[0]+m*i.coords[0],t.coords[1]+=r*e.coords[1]+m*i.coords[1],t.coords[2]+=r*e.coords[2]+m*i.coords[2]},y.getIntersectData=function(t,e,i,s,o,n){e.coords[0]=e.coords[1]=e.coords[2]=0,e.idx=-1,y.vertexWeights(e,i,s),y.vertexWeights(e,o,n)},y.checkForRightSplice=function(t,e){const i=y.regionBelow(e),o=e.eUp,n=i.eUp;if(s.vertLeq(o.Org,n.Org)){if(s.edgeSign(n.Dst,o.Org,n.Org)>0)return!1;s.vertEq(o.Org,n.Org)?o.Org!==n.Org&&(t.pq.delete(o.Org.pqHandle),y.spliceMergeVertices(t,n.Oprev,o)):(t.mesh.splitEdge(n.Sym),t.mesh.splice(o,n.Oprev),e.dirty=i.dirty=!0)}else{if(s.edgeSign(o.Dst,n.Org,o.Org)<0)return!1;y.regionAbove(e).dirty=e.dirty=!0,t.mesh.splitEdge(o.Sym),t.mesh.splice(n.Oprev,o)}return!0},y.checkForLeftSplice=function(t,e){const i=y.regionBelow(e),n=e.eUp,r=i.eUp;let m;if(o(!s.vertEq(n.Dst,r.Dst)),s.vertLeq(n.Dst,r.Dst)){if(s.edgeSign(n.Dst,r.Dst,n.Org)<0)return!1;y.regionAbove(e).dirty=e.dirty=!0,m=t.mesh.splitEdge(n),t.mesh.splice(r.Sym,m),m.Lface.inside=e.inside}else{if(s.edgeSign(r.Dst,n.Dst,r.Org)>0)return!1;e.dirty=i.dirty=!0,m=t.mesh.splitEdge(r),t.mesh.splice(n.Lnext,r.Sym),m.Rface.inside=e.inside}return!0},y.checkForIntersect=function(t,e){let i=y.regionBelow(e),r=e.eUp,m=i.eUp;const c=r.Org,h=m.Org,l=r.Dst,a=m.Dst,_=new n;let u,p;if(o(!s.vertEq(a,l)),o(s.edgeSign(l,t.event,c)<=0),o(s.edgeSign(a,t.event,h)>=0),o(c!==t.event&&h!==t.event),o(!e.fixUpperEdge&&!i.fixUpperEdge),c===h)return!1;if(Math.min(c.t,l.t)>Math.max(h.t,a.t))return!1;if(s.vertLeq(c,h)){if(s.edgeSign(a,c,h)>0)return!1}else if(s.edgeSign(l,h,c)<0)return!1;return y.debugEvent(t),s.intersect(l,c,a,h,_),o(Math.min(c.t,l.t)<=_.t),o(_.t<=Math.max(h.t,a.t)),o(Math.min(a.s,l.s)<=_.s),o(_.s<=Math.max(h.s,c.s)),s.vertLeq(_,t.event)&&(_.s=t.event.s,_.t=t.event.t),u=s.vertLeq(c,h)?c:h,s.vertLeq(u,_)&&(_.s=u.s,_.t=u.t),s.vertEq(_,c)||s.vertEq(_,h)?(y.checkForRightSplice(t,e),!1):!s.vertEq(l,t.event)&&s.edgeSign(l,t.event,_)>=0||!s.vertEq(a,t.event)&&s.edgeSign(a,t.event,_)<=0?a===t.event?(t.mesh.splitEdge(r.Sym),t.mesh.splice(m.Sym,r),e=y.topLeftRegion(t,e),r=y.regionBelow(e).eUp,y.finishLeftRegions(t,y.regionBelow(e),i),y.addRightEdges(t,e,r.Oprev,r,r,!0),!0):l===t.event?(t.mesh.splitEdge(m.Sym),t.mesh.splice(r.Lnext,m.Oprev),i=e,e=y.topRightRegion(e),p=y.regionBelow(e).eUp.Rprev,i.eUp=m.Oprev,m=y.finishLeftRegions(t,i,null),y.addRightEdges(t,e,m.Onext,r.Rprev,p,!0),!0):(s.edgeSign(l,t.event,_)>=0&&(y.regionAbove(e).dirty=e.dirty=!0,t.mesh.splitEdge(r.Sym),r.Org.s=t.event.s,r.Org.t=t.event.t),s.edgeSign(a,t.event,_)<=0&&(e.dirty=i.dirty=!0,t.mesh.splitEdge(m.Sym),m.Org.s=t.event.s,m.Org.t=t.event.t),!1):(t.mesh.splitEdge(r.Sym),t.mesh.splitEdge(m.Sym),t.mesh.splice(m.Oprev,r),r.Org.s=_.s,r.Org.t=_.t,r.Org.pqHandle=t.pq.insert(r.Org),y.getIntersectData(t,r.Org,c,l,h,a),y.regionAbove(e).dirty=e.dirty=i.dirty=!0,!1)},y.walkDirtyRegions=function(t,e){let i,s,o=y.regionBelow(e);for(;;){for(;o.dirty;)e=o,o=y.regionBelow(o);if(!e.dirty&&(o=e,null===(e=y.regionAbove(e))||!e.dirty))return;if(e.dirty=!1,i=e.eUp,s=o.eUp,i.Dst!==s.Dst&&y.checkForLeftSplice(t,e)&&(o.fixUpperEdge?(y.deleteRegion(t,o),t.mesh.delete(s),o=y.regionBelow(e),s=o.eUp):e.fixUpperEdge&&(y.deleteRegion(t,e),t.mesh.delete(i),i=(e=y.regionAbove(o)).eUp)),i.Org!==s.Org)if(i.Dst===s.Dst||e.fixUpperEdge||o.fixUpperEdge||i.Dst!==t.event&&s.Dst!==t.event)y.checkForRightSplice(t,e);else if(y.checkForIntersect(t,e))return;i.Org===s.Org&&i.Dst===s.Dst&&(y.addWinding(s,i),y.deleteRegion(t,e),t.mesh.delete(i),e=y.regionAbove(o))}},y.connectRightVertex=function(t,e,i){let o,n=i.Onext;const r=y.regionBelow(e),m=e.eUp,c=r.eUp;let h=!1;m.Dst!==c.Dst&&y.checkForIntersect(t,e),s.vertEq(m.Org,t.event)&&(t.mesh.splice(n.Oprev,m),e=y.topLeftRegion(t,e),n=y.regionBelow(e).eUp,y.finishLeftRegions(t,y.regionBelow(e),r),h=!0),s.vertEq(c.Org,t.event)&&(t.mesh.splice(i,c.Oprev),i=y.finishLeftRegions(t,r,null),h=!0),h?y.addRightEdges(t,e,i.Onext,n,n,!0):(o=s.vertLeq(c.Org,m.Org)?c.Oprev:m,o=t.mesh.connect(i.Lprev,o),y.addRightEdges(t,e,o,o.Onext,o.Onext,!1),o.Sym.activeRegion.fixUpperEdge=!0,y.walkDirtyRegions(t,e))},y.connectLeftDegenerate=function(t,e,i){let n,r,m,c,h;return n=e.eUp,s.vertEq(n.Org,i)?(o(!1),void y.spliceMergeVertices(t,n,i.anEdge)):s.vertEq(n.Dst,i)?(o(!1),e=y.topRightRegion(e),h=y.regionBelow(e),m=h.eUp.Sym,r=c=m.Onext,h.fixUpperEdge&&(o(r!==m),y.deleteRegion(t,h),t.mesh.delete(m),m=r.Oprev),t.mesh.splice(i.anEdge,m),s.edgeGoesLeft(r)||(r=null),void y.addRightEdges(t,e,m.Onext,c,r,!0)):(t.mesh.splitEdge(n.Sym),e.fixUpperEdge&&(t.mesh.delete(n.Onext),e.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),void y.sweepEvent(t,i))},y.connectLeftVertex=function(t,e){let i,o,n,r,m,c;const h=new p;if(h.eUp=e.anEdge.Sym,i=t.dict.search(h).key,o=y.regionBelow(i),o)if(r=i.eUp,m=o.eUp,0!==s.edgeSign(r.Dst,e,r.Org))if(n=s.vertLeq(m.Dst,r.Dst)?i:o,i.inside||n.fixUpperEdge){if(n===i)c=t.mesh.connect(e.anEdge.Sym,r.Lnext);else{c=t.mesh.connect(m.Dnext,e.anEdge).Sym}n.fixUpperEdge?y.fixUpperEdge(t,n,c):y.computeWinding(t,y.addRegionBelow(t,i,c)),y.sweepEvent(t,e)}else y.addRightEdges(t,i,e.anEdge,e.anEdge,null,!0);else y.connectLeftDegenerate(t,i,e)},y.sweepEvent=function(t,e){t.event=e,y.debugEvent(t);let i=e.anEdge;for(;null===i.activeRegion;)if(i=i.Onext,i===e.anEdge)return void y.connectLeftVertex(t,e);const s=y.topLeftRegion(t,i.activeRegion);o(null!==s);const n=y.regionBelow(s),r=n.eUp,m=y.finishLeftRegions(t,n,null);m.Onext===r?y.connectRightVertex(t,s,m):y.addRightEdges(t,s,m.Onext,r,r,!0)},y.addSentinel=function(t,e,i,s){const o=new p,n=t.mesh.makeEdge();n.Org.s=i,n.Org.t=s,n.Dst.s=e,n.Dst.t=s,t.event=n.Dst,o.eUp=n,o.windingNumber=0,o.inside=!1,o.fixUpperEdge=!1,o.sentinel=!0,o.dirty=!1,o.nodeUp=t.dict.insert(o)},y.initEdgeDict=function(t){t.dict=new l(t,y.edgeLeq);const e=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],s=t.bmin[0]-e,o=t.bmax[0]+e,n=t.bmin[1]-i,r=t.bmax[1]+i;y.addSentinel(t,s,o,n),y.addSentinel(t,s,o,r)},y.doneEdgeDict=function(t){let e,i=0;for(;null!==(e=t.dict.min().key);)e.sentinel||(o(e.fixUpperEdge),o(1==++i)),o(0===e.windingNumber),y.deleteRegion(t,e)},y.removeDegenerateEdges=function(t){let e,i,o;const n=t.mesh.eHead;for(e=n.next;e!==n;e=i)i=e.next,o=e.Lnext,s.vertEq(e.Org,e.Dst)&&e.Lnext.Lnext!==e&&(y.spliceMergeVertices(t,o,e),t.mesh.delete(e),e=o,o=e.Lnext),o.Lnext===e&&(o!==e&&(o!==i&&o!==i.Sym||(i=i.next),t.mesh.delete(o)),e!==i&&e!==i.Sym||(i=i.next),t.mesh.delete(e))},y.initPriorityQ=function(t){let e,i,o,n=0;for(o=t.mesh.vHead,i=o.next;i!==o;i=i.next)n++;for(n+=8,e=t.pq=new u(n,s.vertLeq),o=t.mesh.vHead,i=o.next;i!==o;i=i.next)i.pqHandle=e.insert(i);return i===o&&(e.init(),!0)},y.donePriorityQ=function(t){t.pq=null},y.removeDegenerateFaces=function(t,e){let i,s,n;for(i=e.fHead.next;i!==e.fHead;i=s)s=i.next,n=i.anEdge,o(n.Lnext!==n),n.Lnext.Lnext===n&&(y.addWinding(n.Onext,n),t.mesh.delete(n));return!0},y.computeInterior=function(t){let e,i;if(y.removeDegenerateEdges(t),!y.initPriorityQ(t))return!1;for(y.initEdgeDict(t);null!==(e=t.pq.extractMin());){for(;i=t.pq.min(),null!==i&&s.vertEq(i,e);)i=t.pq.extractMin(),y.spliceMergeVertices(t,e.anEdge,i.anEdge);y.sweepEvent(t,e)}return t.event=t.dict.min().key.eUp.Org,y.debugEvent(t),y.doneEdgeDict(t),y.donePriorityQ(t),!!y.removeDegenerateFaces(t,t.mesh)&&(t.mesh.check(),!0)},d.prototype={dot_:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},normalize_:function(t){let e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];o(e>0),e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},longAxis_:function(t){let e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},computeNormal_:function(t){let e,i,s,o,n,r;const m=[0,0,0],c=[0,0,0],h=[0,0,0],l=[0,0,0],a=[0,0,0],_=[null,null,null],u=[null,null,null],p=this.mesh.vHead;let y;for(e=p.next,y=0;y<3;++y)o=e.coords[y],c[y]=o,u[y]=e,m[y]=o,_[y]=e;for(e=p.next;e!==p;e=e.next)for(y=0;y<3;++y)o=e.coords[y],o<c[y]&&(c[y]=o,u[y]=e),o>m[y]&&(m[y]=o,_[y]=e);if(y=0,m[1]-c[1]>m[0]-c[0]&&(y=1),m[2]-c[2]>m[y]-c[y]&&(y=2),c[y]>=m[y])return t[0]=0,t[1]=0,void(t[2]=1);for(r=0,i=u[y],s=_[y],h[0]=i.coords[0]-s.coords[0],h[1]=i.coords[1]-s.coords[1],h[2]=i.coords[2]-s.coords[2],e=p.next;e!==p;e=e.next)l[0]=e.coords[0]-s.coords[0],l[1]=e.coords[1]-s.coords[1],l[2]=e.coords[2]-s.coords[2],a[0]=h[1]*l[2]-h[2]*l[1],a[1]=h[2]*l[0]-h[0]*l[2],a[2]=h[0]*l[1]-h[1]*l[0],n=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],n>r&&(r=n,t[0]=a[0],t[1]=a[1],t[2]=a[2]);r<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(h)]=1)},checkOrientation_:function(){let t,e;const i=this.mesh.fHead;let s;const o=this.mesh.vHead;let n;for(t=0,e=i.next;e!==i;e=e.next)if(n=e.anEdge,!(n.winding<=0))do{t+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext}while(n!==e.anEdge);if(t<0){for(s=o.next;s!==o;s=s.next)s.t=-s.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},projectPolygon_:function(){let t;const e=this.mesh.vHead,i=[0,0,0];let s,o,n,r,m=!1;for(i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],0===i[0]&&0===i[1]&&0===i[2]&&(this.computeNormal_(i),m=!0),s=this.sUnit,o=this.tUnit,n=this.longAxis_(i),s[n]=0,s[(n+1)%3]=1,s[(n+2)%3]=0,o[n]=0,o[(n+1)%3]=0,o[(n+2)%3]=i[n]>0?1:-1,t=e.next;t!==e;t=t.next)t.s=this.dot_(t.coords,s),t.t=this.dot_(t.coords,o);for(m&&this.checkOrientation_(),r=!0,t=e.next;t!==e;t=t.next)r?(this.bmin[0]=this.bmax[0]=t.s,this.bmin[1]=this.bmax[1]=t.t,r=!1):(t.s<this.bmin[0]&&(this.bmin[0]=t.s),t.s>this.bmax[0]&&(this.bmax[0]=t.s),t.t<this.bmin[1]&&(this.bmin[1]=t.t),t.t>this.bmax[1]&&(this.bmax[1]=t.t))},addWinding_:function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},tessellateMonoRegion_:function(t,e){let i,n;for(i=e.anEdge,o(i.Lnext!==i&&i.Lnext.Lnext!==i);s.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;s.vertLeq(i.Org,i.Dst);i=i.Lnext);for(n=i.Lprev;i.Lnext!==n;)if(s.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(s.edgeGoesLeft(n.Lnext)||s.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);){n=t.connect(n.Lnext,n).Sym}n=n.Lprev}else{for(;n.Lnext!==i&&(s.edgeGoesRight(i.Lprev)||s.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);){i=t.connect(i,i.Lprev).Sym}i=i.Lnext}for(o(n.Lnext!==i);n.Lnext.Lnext!==i;){n=t.connect(n.Lnext,n).Sym}return!0},tessellateInterior_:function(t){let e,i;for(e=t.fHead.next;e!==t.fHead;e=i)if(i=e.next,e.inside&&!this.tessellateMonoRegion_(t,e))return!1;return!0},discardExterior_:function(t){let e,i;for(e=t.fHead.next;e!==t.fHead;e=i)i=e.next,e.inside||t.zapFace(e)},setWindingNumber_:function(t,e,i){let s,o;for(s=t.eHead.next;s!==t.eHead;s=o)o=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?e:-e:i?t.delete(s):s.winding=0},getNeighbourFace_:function(t){return t.Rface&&t.Rface.inside?t.Rface.n:-1},outputPolymesh_:function(t,e,s,n){let r,m,c,h,l,a=0,_=0;for(s>3&&t.mergeConvexFaces(s),r=t.vHead.next;r!==t.vHead;r=r.next)r.n=-1;for(m=t.fHead.next;m!==t.fHead;m=m.next)if(m.n=-1,m.inside){c=m.anEdge,h=0;do{r=c.Org,-1===r.n&&(r.n=_,_++),h++,c=c.Lnext}while(c!==m.anEdge);o(h<=s),m.n=a,++a}for(this.elementCount=a,e===i.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*s,this.vertexCount=_,this.vertices=[],this.vertices.length=_*n,this.vertexIndices=[],this.vertexIndices.length=_,r=t.vHead.next;r!==t.vHead;r=r.next)if(-1!==r.n){const t=r.n*n;this.vertices[t+0]=r.coords[0],this.vertices[t+1]=r.coords[1],n>2&&(this.vertices[t+2]=r.coords[2]),this.vertexIndices[r.n]=r.idx}let u=0;for(m=t.fHead.next;m!==t.fHead;m=m.next)if(m.inside){c=m.anEdge,h=0;do{r=c.Org,this.elements[u++]=r.n,h++,c=c.Lnext}while(c!==m.anEdge);for(l=h;l<s;++l)this.elements[u++]=-1;if(e===i.CONNECTED_POLYGONS){c=m.anEdge;do{this.elements[u++]=this.getNeighbourFace_(c),c=c.Lnext}while(c!==m.anEdge);for(l=h;l<s;++l)this.elements[u++]=-1}}},outputContours_:function(t,e){let i,s,o,n=0,r=0;for(this.vertexCount=0,this.elementCount=0,i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){o=s=i.anEdge;do{this.vertexCount++,s=s.Lnext}while(s!==o);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*e,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;let m=0,c=0,h=0;for(n=0,i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){r=0,o=s=i.anEdge;do{this.vertices[m++]=s.Org.coords[0],this.vertices[m++]=s.Org.coords[1],e>2&&(this.vertices[m++]=s.Org.coords[2]),this.vertexIndices[c++]=s.Org.idx,r++,s=s.Lnext}while(s!==o);this.elements[h++]=n,this.elements[h++]=r,n+=r}},addContour:function(t,e){let i,s;for(null===this.mesh&&(this.mesh=new c),t<2&&(t=2),t>3&&(t=3),i=null,s=0;s<e.length;s+=t)null===i?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=e[s+0],i.Org.coords[1]=e[s+1],i.Org.coords[2]=t>2?e[s+2]:0,i.Org.idx=this.vertexIndexCounter++,i.winding=1,i.Sym.winding=-1},tesselate:function(t,e,s,o,n){if(this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,n&&(this.normal[0]=n[0],this.normal[1]=n[1],this.normal[2]=n[2]),this.windingRule=t,o<2&&(o=2),o>3&&(o=3),!this.mesh)return!1;this.projectPolygon_(),y.computeInterior(this);const r=this.mesh;return e===i.BOUNDARY_CONTOURS?this.setWindingNumber_(r,1,!0):this.tessellateInterior_(r),r.check(),e===i.BOUNDARY_CONTOURS?this.outputContours_(r,o):this.outputPolymesh_(r,e,s,o),!0}}},function(t,e,i){t.exports=p;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(17),h=i(10),l=i(19),a=i(3),_=i(8);p.TYPE="revolute-joint",p._super=_,p.prototype=o(p._super.prototype);const u={lowerAngle:0,upperAngle:359*r.PI/180,maxMotorTorque:1e4,motorSpeed:0,enableLimit:!1,enableMotor:!1,active:!0};function p(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof p))return new p(t,e,i,o);t=s(t,u),_.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=p.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),r.isFinite(t.referenceAngle)?(this.m_referenceAngle=t.referenceAngle,this.m_autoReferenceAngle=!1):(this.m_referenceAngle=i.getAngle()-e.getAngle(),this.m_autoReferenceAngle=!0),this.m_impulse=c(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA=null,this.m_rB=null,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new l,this.m_motorMass=0,this.m_limitState=0}p.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},p.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},p.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},p.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},p.prototype.getReferenceAngle=function(){return this.m_referenceAngle},p.prototype.getJointAngle=function(){const t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},p.prototype.getJointSpeed=function(){const t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},p.prototype.isMotorEnabled=function(){return this.m_enableMotor},p.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},p.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},p.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},p.prototype.getMotorSpeed=function(){return this.m_motorSpeed},p.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},p.prototype.isLimitEnabled=function(){return this.m_enableLimit},p.prototype.enableLimit=function(t){t!==this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},p.prototype.getLowerLimit=function(){return this.m_lowerAngle},p.prototype.getUpperLimit=function(){return this.m_upperAngle},p.prototype.setLimits=function(t,e){t===this.m_lowerAngle&&e===this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},p.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},p.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},p.prototype.getReactionForce=function(t,e){return e?e.set(this.m_impulse.x,this.m_impulse.y).mul(t):m.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},p.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},p.prototype.setBodyA=function(t){p._super.prototype.setBodyA.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},p.prototype.setBodyB=function(t){p._super.prototype.setBodyB.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},p.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v;let h=this.m_bodyB.c_velocity.w;const l=a.neo(e),_=a.neo(o);this.m_rA=a.mulVec2(l,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=a.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB));const u=this.m_invMassA,p=this.m_invMassB,y=this.m_invIA,d=this.m_invIB,f=y+d===0;if(this.m_mass.ex.x=u+p+this.m_rA.y*this.m_rA.y*y+this.m_rB.y*this.m_rB.y*d,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*y-this.m_rB.y*this.m_rB.x*d,this.m_mass.ez.x=-this.m_rA.y*y-this.m_rB.y*d,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=u+p+this.m_rA.x*this.m_rA.x*y+this.m_rB.x*this.m_rB.x*d,this.m_mass.ez.y=this.m_rA.x*y+this.m_rB.x*d,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=y+d,this.m_motorMass=y+d,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(!1===this.m_enableMotor||f)&&(this.m_motorImpulse=0),this.m_enableLimit&&!1===f){const t=o-e-this.m_referenceAngle;r.abs(this.m_upperAngle-this.m_lowerAngle)<2*n.angularSlop?this.m_limitState=3:t<=this.m_lowerAngle?(1!==this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=1):t>=this.m_upperAngle?(2!==this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=2):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;const e=m.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(u,e),s-=y*(m.cross(this.m_rA,e)+this.m_motorImpulse+this.m_impulse.z),c.addMul(p,e),h+=d*(m.cross(this.m_rB,e)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=c,this.m_bodyB.c_velocity.w=h},p.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_invMassA,h=this.m_invMassB,l=this.m_invIA,a=this.m_invIB,_=l+a===0;if(this.m_enableMotor&&3!==this.m_limitState&&!1===_){let e=o-i-this.m_motorSpeed,s=-this.m_motorMass*e;const n=this.m_motorImpulse,m=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.clamp(this.m_motorImpulse+s,-m,m),s=this.m_motorImpulse-n,i-=l*s,o+=a*s}if(this.m_enableLimit&&0!=this.m_limitState&&0==_){const t=m.zero();t.addCombine(1,s,1,m.cross(o,this.m_rB)),t.subCombine(1,e,1,m.cross(i,this.m_rA));const r=o-i;let _=c(t.x,t.y,r),u=c.neg(this.m_mass.solve33(_));if(3==this.m_limitState)this.m_impulse.add(u);else if(1==this.m_limitState){if(this.m_impulse.z+u.z<0){let e=m.combine(-1,t,this.m_impulse.z,m.neo(this.m_mass.ez.x,this.m_mass.ez.y)),i=this.m_mass.solve22(e);u.x=i.x,u.y=i.y,u.z=-this.m_impulse.z,this.m_impulse.x+=i.x,this.m_impulse.y+=i.y,this.m_impulse.z=0}else this.m_impulse.add(u)}else if(2==this.m_limitState){if(this.m_impulse.z+u.z>0){let e=m.combine(-1,t,this.m_impulse.z,m.neo(this.m_mass.ez.x,this.m_mass.ez.y)),i=this.m_mass.solve22(e);u.x=i.x,u.y=i.y,u.z=-this.m_impulse.z,this.m_impulse.x+=i.x,this.m_impulse.y+=i.y,this.m_impulse.z=0}else this.m_impulse.add(u)}const p=m.neo(u.x,u.y);e.subMul(n,p),i-=l*(m.cross(this.m_rA,p)+u.z),s.addMul(h,p),o+=a*(m.cross(this.m_rB,p)+u.z)}else{let t=m.zero();t.addCombine(1,s,1,m.cross(o,this.m_rB)),t.subCombine(1,e,1,m.cross(i,this.m_rA));let r=this.m_mass.solve22(m.neg(t));this.m_impulse.x+=r.x,this.m_impulse.y+=r.y,e.subMul(n,r),i-=l*m.cross(this.m_rA,r),s.addMul(h,r),o+=a*m.cross(this.m_rB,r)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},p.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const c=a.neo(i),l=a.neo(o);let _=0,u=0;const p=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&0!=this.m_limitState&&0==p){const t=o-i-this.m_referenceAngle;let e=0;if(3==this.m_limitState){let i=r.clamp(t-this.m_lowerAngle,-n.maxAngularCorrection,n.maxAngularCorrection);e=-this.m_motorMass*i,_=r.abs(i)}else if(1==this.m_limitState){let i=t-this.m_lowerAngle;_=-i,i=r.clamp(i+n.angularSlop,-n.maxAngularCorrection,0),e=-this.m_motorMass*i}else if(2==this.m_limitState){let i=t-this.m_upperAngle;_=i,i=r.clamp(i-n.angularSlop,0,n.maxAngularCorrection),e=-this.m_motorMass*i}i-=this.m_invIA*e,o+=this.m_invIB*e}{c.set(i),l.set(o);const t=a.mulVec2(c,m.sub(this.m_localAnchorA,this.m_localCenterA)),n=a.mulVec2(l,m.sub(this.m_localAnchorB,this.m_localCenterB));let r=m.zero();r.addCombine(1,s,1,n),r.subCombine(1,e,1,t),u=r.length();const _=this.m_invMassA,p=this.m_invMassB,y=this.m_invIA,d=this.m_invIB,f=new h;f.ex.x=_+p+y*t.y*t.y+d*n.y*n.y,f.ex.y=-y*t.x*t.y-d*n.x*n.y,f.ey.x=f.ex.y,f.ey.y=_+p+y*t.x*t.x+d*n.x*n.x;const x=m.neg(f.solve(r));e.subMul(_,x),i-=y*m.cross(t,x),s.addMul(p,x),o+=d*m.cross(n,x)}return this.m_bodyA.c_position.c.copy(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.copy(s),this.m_bodyB.c_position.a=o,u<=n.linearSlop&&_<=n.angularSlop}},function(t,e,i){t.exports=p;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(17),h=i(10),l=i(19),a=i(3),_=i(8);p.TYPE="prismatic-joint",p._super=_,p.prototype=o(p._super.prototype);const u={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:1e4,motorSpeed:0,active:!0};function p(t,e,i,o,n){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof p))return new p(t,e,i,o,n);t=s(t,u),_.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=p.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),this.m_localXAxisA=n?e.getLocalVector(n):t.localAxisA||m.neo(1,0),this.m_localXAxisA.normalize(),this.m_localYAxisA=m.cross(1,this.m_localXAxisA),this.m_referenceAngle=r.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=c(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=0,this.m_axis=m.zero(),this.m_perp=m.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new l,this.m_motorMass}p.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},p.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},p.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},p.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},p.prototype.getLocalAxisA=function(){return this.m_localXAxisA},p.prototype.setLocalAxisA=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localXAxisA.copy(t),this.m_localYAxisA.set(-t.y,t.x)},p.prototype.getReferenceAngle=function(){return this.m_referenceAngle},p.prototype.setReferenceAngle=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_referenceAngle=t},p.prototype.getJointTranslation=function(){const t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=m.sub(e,t),s=this.m_bodyA.getWorldVector(this.m_localXAxisA);return m.dot(i,s)},p.prototype.getJointSpeed=function(){const t=this.m_bodyA,e=this.m_bodyB,i=a.mulVec2(t.m_xf.q,m.sub(this.m_localAnchorA,t.m_sweep.localCenter)),s=a.mulVec2(e.m_xf.q,m.sub(this.m_localAnchorB,e.m_sweep.localCenter)),o=m.add(t.m_sweep.c,i),n=m.add(e.m_sweep.c,s),r=m.sub(n,o),c=a.mulVec2(t.m_xf.q,this.m_localXAxisA),h=t.m_linearVelocity,l=e.m_linearVelocity,_=t.m_angularVelocity,u=e.m_angularVelocity;return m.dot(r,m.cross(_,c))+m.dot(c,m.sub(m.addCross(l,u,s),m.addCross(h,_,i)))},p.prototype.isLimitEnabled=function(){return this.m_enableLimit},p.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},p.prototype.getLowerLimit=function(){return this.m_lowerTranslation},p.prototype.getUpperLimit=function(){return this.m_upperTranslation},p.prototype.setLimits=function(t,e){t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},p.prototype.isMotorEnabled=function(){return this.m_enableMotor},p.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},p.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},p.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t},p.prototype.getMotorSpeed=function(){return this.m_motorSpeed},p.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},p.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},p.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},p.prototype.getReactionForce=function(t,e){return(e=e||m.zero()).setCombine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)},p.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},p.prototype.getLimitState=function(){return this.m_limitState},p.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const c=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let _=this.m_bodyB.c_velocity.w;const u=a.neo(i),p=a.neo(h),y=a.mulVec2(u,m.sub(this.m_localAnchorA,this.m_localCenterA)),d=a.mulVec2(p,m.sub(this.m_localAnchorB,this.m_localCenterB)),f=m.zero();f.addCombine(1,c,1,d),f.subCombine(1,e,1,y);const x=this.m_invMassA,g=this.m_invMassB,v=this.m_invIA,A=this.m_invIB;this.m_axis=a.mulVec2(u,this.m_localXAxisA),this.m_a1=m.cross(m.add(f,y),this.m_axis),this.m_a2=m.cross(d,this.m_axis),this.m_motorMass=x+g+v*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp=a.mulVec2(u,this.m_localYAxisA),this.m_s1=m.cross(m.add(f,y),this.m_perp),this.m_s2=m.cross(d,this.m_perp);const t=x+g+v*this.m_s1*this.m_s1+A*this.m_s2*this.m_s2,e=v*this.m_s1+A*this.m_s2,i=v*this.m_s1*this.m_a1+A*this.m_s2*this.m_a2;let s=v+A;0==s&&(s=1);const o=v*this.m_a1+A*this.m_a2,n=x+g+v*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2;this.m_K.ex.set(t,e,i),this.m_K.ey.set(e,s,o),this.m_K.ez.set(i,o,n)}if(this.m_enableLimit){const t=m.dot(this.m_axis,f);r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*n.linearSlop?this.m_limitState=3:t<=this.m_lowerTranslation?1!=this.m_limitState&&(this.m_limitState=1,this.m_impulse.z=0):t>=this.m_upperTranslation?2!=this.m_limitState&&(this.m_limitState=2,this.m_impulse.z=0):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;const e=m.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),i=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,n=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;s.subMul(x,e),o-=v*i,l.addMul(g,e),_+=A*n}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.copy(s),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.copy(l),this.m_bodyB.c_velocity.w=_};const y=m.zero();p.prototype.solveVelocityConstraints=function(t){const e=y,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_velocity.v;let n=this.m_bodyB.c_velocity.w;const h=this.m_invMassA,l=this.m_invMassB,a=this.m_invIA,_=this.m_invIB;if(this.m_enableMotor&&3!=this.m_limitState){let c=m.dot(this.m_axis,m.sub(o,i))+this.m_a2*n-this.m_a1*s,u=this.m_motorMass*(this.m_motorSpeed-c);const p=this.m_motorImpulse,y=t.dt*this.m_maxMotorForce;this.m_motorImpulse=r.clamp(this.m_motorImpulse+u,-y,y),u=this.m_motorImpulse-p,m.mulSV(u,this.m_axis,e);let d=u*this.m_a1,f=u*this.m_a2;i.subMul(h,e),s-=a*d,o.addMul(l,e),n+=_*f}const u=m.zero();if(u.x+=m.dot(this.m_perp,o)+this.m_s2*n,u.x-=m.dot(this.m_perp,i)+this.m_s1*s,u.y=n-s,this.m_enableLimit&&0!=this.m_limitState){let t=0;t+=m.dot(this.m_axis,o)+this.m_a2*n,t-=m.dot(this.m_axis,i)+this.m_a1*s;let p=c(u.x,u.y,t);const y=c(this.m_impulse);let d=this.m_K.solve33(c.neg(p));this.m_impulse.add(d),1==this.m_limitState?this.m_impulse.z=r.max(this.m_impulse.z,0):2==this.m_limitState&&(this.m_impulse.z=r.min(this.m_impulse.z,0));const f=m.combine(-1,u,-(this.m_impulse.z-y.z),m.neo(this.m_K.ez.x,this.m_K.ez.y)),x=m.add(this.m_K.solve22(f),m.neo(y.x,y.y));this.m_impulse.x=x.x,this.m_impulse.y=x.y,d=c.sub(this.m_impulse,y),m.combineInto(d.x,this.m_perp,d.z,this.m_axis,e);let g=d.x*this.m_s1+d.y+d.z*this.m_a1,v=d.x*this.m_s2+d.y+d.z*this.m_a2;i.subMul(h,e),s-=a*g,o.addMul(l,e),n+=_*v}else{let t=this.m_K.solve22(m.neg(u));this.m_impulse.x+=t.x,this.m_impulse.y+=t.y,m.mulSV(t.x,this.m_perp,e);let r=t.x*this.m_s1+t.y,c=t.x*this.m_s2+t.y;i.subMul(h,e),s-=a*r,o.addMul(l,e),n+=_*c}this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},p.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const _=a.neo(i),u=a.neo(o),p=this.m_invMassA,y=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,x=a.mulVec2(_,m.sub(this.m_localAnchorA,this.m_localCenterA)),g=a.mulVec2(u,m.sub(this.m_localAnchorB,this.m_localCenterB)),v=m.sub(m.add(s,g),m.add(e,x)),A=a.mulVec2(_,this.m_localXAxisA),b=m.cross(m.add(v,x),A),B=m.cross(g,A),w=a.mulVec2(_,this.m_localYAxisA),C=m.cross(m.add(v,x),w),I=m.cross(g,w);let S=c();const V=m.zero();V.x=m.dot(w,v),V.y=o-i-this.m_referenceAngle;let M=r.abs(V.x);const L=r.abs(V.y),P=n.linearSlop,z=n.maxLinearCorrection;let k=!1,T=0;if(this.m_enableLimit){const t=m.dot(A,v);r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P?(T=r.clamp(t,-z,z),M=r.max(M,r.abs(t)),k=!0):t<=this.m_lowerTranslation?(T=r.clamp(t-this.m_lowerTranslation+P,-z,0),M=r.max(M,this.m_lowerTranslation-t),k=!0):t>=this.m_upperTranslation&&(T=r.clamp(t-this.m_upperTranslation-P,0,z),M=r.max(M,t-this.m_upperTranslation),k=!0)}if(k){let t=p+y+d*C*C+f*I*I,e=d*C+f*I;const i=d*C*b+f*I*B;let s=d+f;0==s&&(s=1);const o=d*b+f*B,n=p+y+d*b*b+f*B*B;let r=new l;r.ex.set(t,e,i),r.ey.set(e,s,o),r.ez.set(i,o,n);const m=c();m.x=V.x,m.y=V.y,m.z=T,S=r.solve33(c.neg(m))}else{let t=p+y+d*C*C+f*I*I,e=d*C+f*I,i=d+f;0==i&&(i=1);let s=new h;s.ex.set(t,e),s.ey.set(e,i);const o=s.solve(m.neg(V));S.x=o.x,S.y=o.y,S.z=0}const O=m.combine(S.x,w,S.z,A),q=S.x*C+S.y+S.z*b,E=S.x*I+S.y+S.z*B;return e.subMul(p,O),i-=d*q,s.addMul(y,O),o+=f*E,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=o,M<=n.linearSlop&&L<=n.angularSlop}},function(t,e,i){e.internal={},e.Math=i(1),e.Vec2=i(0),e.Vec3=i(17),e.Mat22=i(10),e.Mat33=i(19),e.Transform=i(6),e.Rot=i(3),e.AABB=i(12),e.Shape=i(13),e.Fixture=i(28),e.Body=i(24),e.Contact=i(9),e.Joint=i(8),e.World=i(37),e.Circle=i(15),e.Edge=i(18),e.Capsule=i(21),e.Polygon=i(16),i(31),e.CompositePolygon=i(22),e.Chain=i(27),e.Box=i(26),i(42),i(43),e.internal.CollidePolygons=i(44),i(45),i(46),e.DistanceJoint=i(47),e.FrictionJoint=i(48),e.GearJoint=i(49),e.MotorJoint=i(50),e.MouseJoint=i(51),e.PrismaticJoint=i(33),e.PulleyJoint=i(52),e.RevoluteJoint=i(32),e.RopeJoint=i(53),e.WeldJoint=i(54),e.WheelJoint=i(55),e.internal.Sweep=i(20),e.internal.stats=i(23),e.internal.Manifold=i(11),e.internal.Distance=i(14),e.internal.TimeOfImpact=i(25),e.internal.ShapeCaster=i(30),e.internal.DynamicTree=i(29),e.internal.Settings=i(4)},function(t,e,i){t.exports=function(){this.v=s.zero(),this.w=0};const s=i(0)},function(t,e,i){t.exports=n;const s=i(0),o=i(3);function n(){this.c=s.zero(),this.a=0}n.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.copy(s.sub(this.c,o.mulVec2(t.q,e))),t}},function(t,e,i){t.exports=w;const s=i(7),o=(i(2),i(0)),n=i(6),r=i(38),m=i(30),c=i(41),h=i(24),l=i(9),a=i(12),_=i(14),u=i(15),p=i(26);let y,d,f,x,g,v,A,b;const B={gravity:o.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function w(t){if(!(this instanceof w))return new w(t);t&&o.isValid(t)&&(t={gravity:t}),t=s(t,B),this.m_solver=new c(this),this.m_broadPhase=new r,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=o.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_stepCount=0,this.addPair=this.createContact.bind(this),this.collision_matrix=new Uint32Array(32)}w.prototype.getBodyList=function(){return this.m_bodyList},w.prototype.getJointList=function(){return this.m_jointList},w.prototype.getContactList=function(){return this.m_contactList},w.prototype.getBodyCount=function(){return this.m_bodyCount},w.prototype.getJointCount=function(){return this.m_jointCount},w.prototype.getContactCount=function(){return this.m_contactCount},w.prototype.setGravity=function(t){this.m_gravity=t},w.prototype.getGravity=function(){return this.m_gravity},w.prototype.isLocked=function(){return this.m_locked},w.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(let t=this.m_bodyList;t;t=t.m_next)t.setAwake(!0)},w.prototype.getAllowSleeping=function(){return this.m_allowSleep},w.prototype.setWarmStarting=function(t){this.m_warmStarting=t},w.prototype.getWarmStarting=function(){return this.m_warmStarting},w.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},w.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},w.prototype.setSubStepping=function(t){this.m_subStepping=t},w.prototype.getSubStepping=function(){return this.m_subStepping},w.prototype.setAutoClearForces=function(t){this.m_clearForces=t},w.prototype.getAutoClearForces=function(){return this.m_clearForces},w.prototype.getVelocityIterations=function(){return this.m_velocityIterations},w.prototype.setVelocityIterations=function(t){this.m_velocityIterations=t},w.prototype.getPositionIterations=function(){return this.m_positionIterations},w.prototype.setPositionIterations=function(t){this.m_positionIterations=t},w.prototype.clearForces=function(){for(let t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},w.prototype.queryAABB=function(t,e){g=e,this.m_broadPhase.query(t,this._queryAABBCallback),g=null},w.prototype._queryAABBCallback=function(t,e){return g(e.fixture,e)},w.prototype.queryCircle=function(t,e,i){f=f||new u,f.setRadius(e),d=d||new n,d.p.copy(t),y=y||new a,f.computeAABB(y,d),A={},v=i,this.queryAABB(y,this._queryCircleCallback),A=v=null},w.prototype._queryCircleCallback=function(t,e){const i=t.m_proxies[0].proxyId;return!(!A[i]&&_.testOverlap(f,0,t.m_shape,e.childIndex,d,t.m_body.getTransform()))||(A[i]=!0,v(t))},w.prototype.circleCast=function(t,e,i,s,o){b=b||new m(this),b.castCircle(t,e,i,s,o)},w.prototype.queryBox=function(t,e,i,s){x=x||new p,x.setSize(e.x,e.y),x.setAngle(i),d=d||new n,d.p.copy(t),y=y||new a,x.computeAABB(y,d),A={},v=s,this.queryAABB(y,this._queryBoxCallback),A=v=null},w.prototype._queryBoxCallback=function(t,e){const i=t.m_proxies[0].proxyId;return!(!A[i]&&_.testOverlap(x,0,t.m_shape,e.childIndex,d,t.m_body.getTransform()))||(A[i]=!0,v(t))},w.prototype.boxCast=function(t,e,i,s,o,n,r){b=b||new m(this),b.castBox(t,e,i,s,o,n,r)},w.prototype.capsuleCast=function(t,e,i,s,o,n,r,c){b=b||new m(this),b.castCapsule(t,e,i,s,o,n,r,c)},w.prototype.rayCast=function(t,e,i){v=i,this.m_broadPhase.rayCast(null,this._raycastCallback,t,e,1),v=null},w.prototype._raycastCallback=function(t,e,i){const s=i.fixture,o=i.childIndex,n={};if(s.rayCast(n,t,o)&&n.fraction>=0&&n.fraction<=t.maxFraction){const e=n.fraction,i=t.p1.mul(1-e).add(t.p2.mul(e));return Math.min(v(s,i,n.normal,e),t.maxFraction)}return t.maxFraction},w.prototype.getDistance=function(t,e){const i=t.getShape(),s=e.getShape(),o=t.getBody().getTransform(),n=e.getBody().getTransform(),r=t.getProxyCount(),m=e.getProxyCount(),c=new _.getInput,h=new _.getCache,l=new _.getOutput,a=new _.Output;let u=1/0;const p=a.pointA,y=a.pointB;for(let t=0;t<r;++t)for(let e=0;e<m;++e)h.clear(),l.clear(),c.clear(),c.proxyA.set(i,t),c.proxyB.set(s,e),c.transformA=o,c.transformB=n,c.useRadii=!0,c.overlap=!0,_(l,h,c),l.distance<u&&(u=l.distance,p.copy(l.pointA),y.copy(l.pointB));return u==1/0?null:(a.distance=u,a)},w.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},w.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},w.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},w.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},w.prototype.shiftOrigin=function(t){if(!this.m_locked){for(let e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(let e=this.m_jointList;e;e=e.m_next)e.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},w.prototype.createBody=function(t,e){if(pc.markPhysics2dModuleAsUsed(),this.isLocked())return null;t&&o.isValid(t)&&(t={position:t,angle:e});const i=new h(this,t);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i},w.prototype.createDynamicBody=function(t,e){return t?o.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)},w.prototype.createKinematicBody=function(t,e){return t?o.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)},w.prototype.destroyBody=function(t){if(pc.markPhysics2dModuleAsUsed(),this.isLocked())return;if(t.m_destroyed)return!1;let e=t.m_jointList;for(;e;){const i=e;e=e.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;let i=t.m_contactList;for(;i;){const e=i;i=i.next,this.destroyContact(e.contact),t.m_contactList=i}t.m_contactList=null;let s=t.m_fixtureList;for(;s;){const e=s;s=s.m_next,this.publish("remove-fixture",e),e.destroyProxies(this.m_broadPhase),t.m_fixtureList=s}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0},w.prototype.createJoint=function(t){return this.isLocked()?null:(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.connectBodyA(),t.connectBodyB(),t.refilter(),t)},w.prototype.destroyJoint=function(t){this.isLocked()||(t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next),t.disconnectBodyA(),t.disconnectBodyB(),--this.m_jointCount,t.refilter(),this.publish("remove-joint",t))};const C=new c.TimeStep;w.prototype.step=function(t,e,i){if((0|e)!==e&&(e=0),e=e||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_stepCount++,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,C.reset(t),C.velocityIterations=e,C.positionIterations=i,C.warmStarting=this.m_warmStarting,C.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(C);for(let t=this.m_bodyList;t;t=t.getNext())0!=t.m_islandFlag&&(t.isStatic()||t.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(C),this.m_clearForces&&this.clearForces(),this.m_locked=!1},w.prototype.getLastTimeStep=function(){return C.dt},w.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)},w.prototype.createContact=function(t,e){const i=t.fixture,s=e.fixture,o=t.childIndex,n=e.childIndex,r=i.getBody(),m=s.getBody();if(r==m)return;let c=m.getContactList();for(;c;){if(c.other===r){const t=c.contact,e=t.m_fixtureA,r=t.m_fixtureB,m=t.m_indexA,h=t.m_indexB;if(e==i&&r==s&&m==o&&h==n)return;if(e==s&&r==i&&m==n&&h==o)return}c=c.next}if(0==m.shouldCollide(r))return;if(0==s.shouldCollide(i))return;const h=l.create(i,o,s,n);null!=h&&(h.m_prev=null,null!=this.m_contactList&&(h.m_next=this.m_contactList,this.m_contactList.m_prev=h),this.m_contactList=h,++this.m_contactCount)},w.prototype.updateContacts=function(){let t,e=this.m_contactList;for(;t=e;){e=t.getNext();const i=t.getFixtureA();if(!i.isActive()){this.destroyContact(t);continue}const s=t.getFixtureB();if(!s.isActive()){this.destroyContact(t);continue}const o=i.getBody();if(!o.isActive()){this.destroyContact(t);continue}const n=s.getBody();if(!n.isActive()){this.destroyContact(t);continue}const r=t.getChildIndexA(),m=t.getChildIndexB();if(t.m_filterFlag){if(r>=i.m_proxies.length){this.destroyContact(t);continue}if(m>=s.m_proxies.length){this.destroyContact(t);continue}if(0==n.shouldCollide(o)){this.destroyContact(t);continue}if(0==s.shouldCollide(i)){this.destroyContact(t);continue}t.m_filterFlag=!1}if(0==!o.isStatic()&&0==!n.isStatic())continue;const c=i.m_proxies[r].proxyId,h=s.m_proxies[m].proxyId;0!=this.m_broadPhase.testOverlap(c,h)?o.isKinematic()||n.isKinematic()?(o.isAwake()||o.setAwake(!0),n.isAwake()||n.setAwake(!0),t.update(this)):(o.isAwake()||n.isAwake())&&t.update(this):this.destroyContact(t)}},w.prototype.destroyContact=function(t){l.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount},w.prototype._listeners=null,w.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e||(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)),this},w.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;const i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;const s=i.indexOf(e);return s>=0&&i.splice(s,1),this},w.prototype.publish=function(t,e,i,s){const o=this._listeners&&this._listeners[t];if(!o||!o.length)return 0;for(let t=0;t<o.length;t++)o[t].call(this,e,i,s);return o.length},w.prototype.beginContact=function(t){this.publish("begin-contact",t)},w.prototype.endContact=function(t){this.publish("end-contact",t)},w.prototype.preSolve=function(t){this.publish("pre-solve",t)},w.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)}},function(t,e,i){i(2);const s=i(1),o=i(12),n=i(29);function r(){this.m_tree=new n,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}t.exports=r,r.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},r.prototype.testOverlap=function(t,e){const i=this.m_tree.getFatAABB(t),s=this.m_tree.getFatAABB(e);return o.testOverlap(i,s)},r.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},r.prototype.getProxyCount=function(){return this.m_proxyCount},r.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},r.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},r.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},r.prototype.query=function(t,e){this.m_tree.query(t,e)},r.prototype.rayCast=function(t,e,i,s,o){this.m_tree.rayCast(t,e,i,s,o)},r.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},r.prototype.createProxy=function(t,e){const i=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(i),i},r.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)},r.prototype.moveProxy=function(t,e,i){this.m_tree.moveProxy(t,e,i)&&this.bufferMove(t)},r.prototype.touchProxy=function(t){this.bufferMove(t)},r.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},r.prototype.unbufferMove=function(t){for(let e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)},r.prototype.updatePairs=function(t){for(this.m_callback=t;this.m_moveBuffer.length>0;){if(this.m_queryProxyId=this.m_moveBuffer.pop(),null===this.m_queryProxyId)continue;const t=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(t,this.queryCallback)}this.m_moveBuffer.length=0,null!==this.m_tree.m_root&&this.m_tree.balance(this.m_tree.m_root)},r.prototype.queryCallback=function(t,e){if(t===this.m_queryProxyId)return!0;const i=s.min(t,this.m_queryProxyId),o=s.max(t,this.m_queryProxyId),n=t===i?e:this.m_tree.getUserData(i),r=t===o?e:this.m_tree.getUserData(o);return this.m_callback(n,r),!0}},function(t,e){t.exports=function(t){const e=[];let i=t.max||1/0;const s=t.create,o=t.allocate,n=t.release,r=t.discard;let m=0,c=0,h=0,l=0;this.max=function(t){return"number"==typeof t?(i=t,this):i},this.size=function(){return e.length},this.allocate=function(){let t;return e.length>0?t=e.shift():(m++,t="function"==typeof s?s():{}),c++,"function"==typeof o&&o(t),t},this.release=function(t){e.length<i?(h++,"function"==typeof n&&n(t),e.push(t)):(l++,"function"==typeof r&&(t=r(t)))},this.toString=function(){return" +"+m+" >"+c+" <"+h+" -"+l+" ="+e.length+"/"+i}}},function(t,e){t.exports.now=function(){return Date.now()},t.exports.diff=function(t){return Date.now()-t}},function(t,e,i){t.exports=u,t.exports.TimeStep=_;const s=i(4),o=i(2),n=i(0),r=i(1),m=(i(24),i(9),i(8),i(25)),c=m.Input,h=m.Output,l=i(14),a=(l.Input,l.Output,l.Cache,i(20));function _(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}function u(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}_.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},u.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},u.prototype.addBody=function(t){this.m_bodies.push(t)},u.prototype.addContact=function(t){this.m_contacts.push(t)},u.prototype.addJoint=function(t){this.m_joints.push(t)},u.prototype.solveWorld=function(t){const e=this.m_world;for(let t=e.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=e.m_contactList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=e.m_jointList;t;t=t.m_next)t.m_islandFlag=!1;const i=this.m_stack;for(let s=e.m_bodyList;s;s=s.m_next)if(!s.m_islandFlag&&0!=s.isAwake()&&0!=s.isActive()&&!s.isStatic()){for(this.clear(),i.push(s),s.m_islandFlag=!0;i.length>0;){let t=i.pop();if(this.addBody(t),t.setAwake(!0),!t.isStatic()){for(let e=t.m_contactList;e;e=e.next){const t=e.contact;if(t.m_islandFlag)continue;if(0==t.isEnabled()||0==t.isTouching())continue;const s=t.m_fixtureA,o=t.m_fixtureB;if(!s.isActive()||!o.isActive())continue;const n=s.m_isSensor,r=o.m_isSensor;if(n||r)continue;this.addContact(t),t.m_islandFlag=!0;let m=e.other;m.m_islandFlag||(i.push(m),m.m_islandFlag=!0)}for(let e=t.m_jointList;e;e=e.next){if(1==e.joint.m_islandFlag||0==e.joint.m_activeFlag)continue;let t=e.other;0!=t.isActive()&&(this.addJoint(e.joint),e.joint.m_islandFlag=!0,t.m_islandFlag||(i.push(t),t.m_islandFlag=!0))}}}this.solveIsland(t);for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];e.isStatic()&&(e.m_islandFlag=!1)}}};const p=new n,y=new n,d=n.zero();u.prototype.solveIsland=function(t){const e=d,i=this.m_world,o=i.m_gravity,m=i.m_allowSleep,c=t.dt,h=p,l=y;for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];h.copy(e.m_sweep.c);let i=e.m_sweep.a;l.copy(e.m_linearVelocity);let s=e.m_angularVelocity;e.m_sweep.c1.copy(e.m_sweep.c),e.m_sweep.c0.copy(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.isDynamic()&&(l.addMul(c*e.m_gravityScale,o),l.addMul(c*e.m_invMass,e.m_force),s+=c*e.m_invI*e.m_torque,l.mul(1/(1+c*e.m_linearDamping)),s*=1/(1+c*e.m_angularDamping)),e.c_position.c.copy(h),e.c_position.a=i,e.c_velocity.v.copy(l),e.c_velocity.w=s}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initConstraint(t)}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initVelocityConstraint(t)}if(t.warmStarting)for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].warmStartConstraint(t)}for(let e=0;e<this.m_joints.length;++e){this.m_joints[e].initVelocityConstraints(t)}for(let e=0;e<t.velocityIterations;++e){for(let e=0;e<this.m_joints.length;++e){this.m_joints[e].solveVelocityConstraints(t)}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].solveVelocityConstraint(t)}}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].storeConstraintImpulses(t)}for(let t=0;t<this.m_bodies.length;++t){let i=this.m_bodies[t];h.copy(i.c_position.c);let o=i.c_position.a;l.copy(i.c_velocity.v);let m=i.c_velocity.w;if(n.mulSV(c,l,e),n.lengthSquared(e)>s.maxTranslationSquared){let t=s.maxTranslation/e.length();l.mul(t)}const a=c*m;if(a*a>s.maxRotationSquared){m*=s.maxRotation/r.abs(a)}h.addMul(c,l),o+=c*m,i.c_position.c.copy(h),i.c_position.a=o,i.c_velocity.v.copy(l),i.c_velocity.w=m}let a=!1;for(let e=0;e<t.positionIterations;++e){let e=0;for(let i=0;i<this.m_contacts.length;++i){const s=this.m_contacts[i].solvePositionConstraint(t);e=r.min(e,s)}const i=e>=-3*s.linearSlop;let o=!0;for(let e=0;e<this.m_joints.length;++e){const i=this.m_joints[e].solvePositionConstraints(t);o=o&&i}if(i&&o){a=!0;break}}for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];const i=e.c_position.c,s=e.m_sweep.c,o=e.m_sweep.c0,n=e.m_sweep.c1,r=e.c_velocity.v,m=e.m_linearVelocity;e.m_fixedXFlag?(o.x=s.x=n.x,m.x=0):(s.x=i.x,m.x=r.x),e.m_fixedYFlag?(o.y=s.y=n.y,m.y=0):(s.y=i.y,m.y=r.y),e.m_sweep.a=e.c_position.a,e.m_angularVelocity=e.c_velocity.w,e.synchronizeTransform()}if(this.postSolveIsland(),m){let t=1/0;const e=s.linearSleepToleranceSqr,i=s.angularSleepToleranceSqr;for(let s=0;s<this.m_bodies.length;++s){let o=this.m_bodies[s];o.isStatic()||(0==o.m_autoSleepFlag||o.m_angularVelocity*o.m_angularVelocity>i||n.lengthSquared(o.m_linearVelocity)>e?(o.m_sleepTime=0,t=0):(o.m_sleepTime+=c,t=r.min(t,o.m_sleepTime)))}if(t>=s.timeToSleep&&a)for(let t=0;t<this.m_bodies.length;++t){this.m_bodies[t].setAwake(!1)}}},u.prototype.printBodies=function(t){for(let e=0;e<this.m_bodies.length;++e){const i=this.m_bodies[e];o.debug(t,i.c_position.a,i.c_position.c.x,i.c_position.c.y,i.c_velocity.w,i.c_velocity.v.x,i.c_velocity.v.y)}};const f=new _,x=new a,g=new a,v=new a;u.prototype.solveWorldTOI=function(t){const e=this.m_world,i=x,o=g,n=v;if(e.m_stepComplete){for(let t=e.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1,t.m_sweep.alpha0=0;for(let t=e.m_contactList;t;t=t.m_next)t.m_toiFlag=!1,t.m_islandFlag=!1,t.m_toiCount=0,t.m_toi=1}for(;;){let l=null,a=1;for(let t=e.m_contactList;t;t=t.m_next){if(0==t.isEnabled())continue;if(t.m_toiCount>s.maxSubSteps)continue;let e=1;if(t.m_toiFlag)e=t.m_toi;else{let i=t.getFixtureA(),s=t.getFixtureB();if(!i.isActive()||!s.isActive())continue;if(i.isSensor()||s.isSensor())continue;let o=i.getBody(),n=s.getBody();const l=o.isAwake()&&!o.isStatic(),a=n.isAwake()&&!n.isStatic();if(0==l&&0==a)continue;const _=o.isBullet()||!o.isDynamic()||o.m_fixedXFlag||o.m_fixedYFlag,u=n.isBullet()||!n.isDynamic()||n.m_fixedXFlag||n.m_fixedYFlag;if(0==_&&0==u)continue;let p=o.m_sweep.alpha0;o.m_sweep.alpha0<n.m_sweep.alpha0?(p=n.m_sweep.alpha0,o.m_sweep.advance(p)):n.m_sweep.alpha0<o.m_sweep.alpha0&&(p=o.m_sweep.alpha0,n.m_sweep.advance(p));const y=t.getChildIndexA(),d=t.getChildIndexB(),f=new c;f.proxyA.set(i.getShape(),y),f.proxyB.set(s.getShape(),d),f.sweepA.set(o.m_sweep),f.sweepB.set(n.m_sweep),f.tMax=1;const x=new h;m(x,f);const g=x.t;e=x.state==h.e_touching?r.min(p+(1-p)*g,1):1,t.m_toi=e,t.m_toiFlag=!0}e<a&&(l=t,a=e)}if(null==l||1-10*r.EPSILON<a){e.m_stepComplete=!0;break}let _=l.getFixtureA(),u=l.getFixtureB(),p=_.getBody(),y=u.getBody();if(o.set(p.m_sweep),n.set(y.m_sweep),p.advance(a),y.advance(a),l.update(e),l.m_toiFlag=!1,++l.m_toiCount,0==l.isEnabled()||0==l.isTouching()){l.setEnabled(!1),p.m_sweep.set(o),y.m_sweep.set(n),p.synchronizeTransform(),y.synchronizeTransform();continue}p.setAwake(!0),y.setAwake(!0),this.clear(),this.addBody(p),this.addBody(y),this.addContact(l),p.m_islandFlag=!0,y.m_islandFlag=!0,l.m_islandFlag=!0;const d=[p,y];for(let t=0;t<d.length;++t){let s=d[t];if(s.isDynamic())for(let t=s.m_contactList;t;t=t.next){const o=t.contact;if(o.m_islandFlag)continue;const n=t.other;if(n.isDynamic()&&!s.isBullet()&&!n.isBullet())continue;const r=o.m_fixtureA.m_isSensor,m=o.m_fixtureB.m_isSensor;r||m||(i.set(n.m_sweep),0==n.m_islandFlag&&n.advance(a),o.update(e),0!=o.isEnabled()&&0!=o.isTouching()?(o.m_islandFlag=!0,this.addContact(o),n.m_islandFlag||(n.m_islandFlag=!0,n.isStatic()||n.setAwake(!0),this.addBody(n))):(n.m_sweep.set(i),n.synchronizeTransform()))}}f.reset((1-a)*t.dt),f.dtRatio=1,f.positionIterations=20,f.velocityIterations=t.velocityIterations,f.warmStarting=!1,this.solveIslandTOI(f,p,y);for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];if(e.m_islandFlag=!1,e.isDynamic()){e.synchronizeFixtures();for(let t=e.m_contactList;t;t=t.next)t.contact.m_toiFlag=!1,t.contact.m_islandFlag=!1}}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}};const A=new n,b=new n,B=n.zero();function w(){this.normalImpulses=[],this.tangentImpulses=[]}u.prototype.solveIslandTOI=function(t,e,i){const o=A,m=b,c=B;for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];e.c_position.c.copy(e.m_sweep.c),e.c_position.a=e.m_sweep.a,e.c_velocity.v.copy(e.m_linearVelocity),e.c_velocity.w=e.m_angularVelocity}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initConstraint(t)}for(let o=0;o<t.positionIterations;++o){let o=0;for(let s=0;s<this.m_contacts.length;++s){const n=this.m_contacts[s].solvePositionConstraintTOI(t,e,i);o=r.min(o,n)}if(o>=-1.5*s.linearSlop)break}e.m_sweep.c0.copy(e.c_position.c),e.m_sweep.a0=e.c_position.a,i.m_sweep.c0.copy(i.c_position.c),i.m_sweep.a0=i.c_position.a;for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initVelocityConstraint(t)}for(let e=0;e<t.velocityIterations;++e)for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].solveVelocityConstraint(t)}const h=t.dt;for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];o.copy(e.c_position.c);let i=e.c_position.a;m.copy(e.c_velocity.v);let l=e.c_velocity.w;if(n.mulSV(h,m,c),n.dot(c,c)>s.maxTranslationSquared){let t=s.maxTranslation/c.length();m.mul(t)}const a=h*l;if(a*a>s.maxRotationSquared){l*=s.maxRotation/r.abs(a)}o.addMul(h,m),i+=h*l,e.c_position.c.copy(o),e.c_position.a=i,e.c_velocity.v.copy(m),e.c_velocity.w=l,e.m_sweep.c.copy(o),e.m_linearVelocity.set(m),e.m_fixedXFlag&&(e.m_sweep.c0.x=e.m_sweep.c.x=e.m_sweep.c1.x,e.m_linearVelocity.x=0),e.m_fixedYFlag&&(e.m_sweep.c0.y=e.m_sweep.c.y=e.m_sweep.c1.y,e.m_linearVelocity.y=0),e.m_sweep.a=i,e.m_angularVelocity=l,e.synchronizeTransform()}this.postSolveIsland()},u.prototype.postSolveIsland=function(){const t=new w;for(let e=0;e<this.m_contacts.length;++e){const i=this.m_contacts[e];for(let e=0;e<i.v_points.length;++e)t.normalImpulses.push(i.v_points[e].normalImpulse),t.tangentImpulses.push(i.v_points[e].tangentImpulse);this.m_world.postSolve(i,t)}}},function(t,e,i){i(2);const s=i(6),o=i(0),n=i(9),r=i(11),m=i(15),c=new o,h=new o;function l(t,e,i,n,m){t.pointCount=0,s.mulVec2(i,e.m_p,c),s.mulVec2(m,n.m_p,h);const l=o.distanceSquared(h,c),a=e.m_radius+n.m_radius;l>a*a||(t.type=r.e_circles,t.localPoint.copy(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.copy(n.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex)}n.addType(m.TYPE,m.TYPE,(function(t,e,i,s,o,n,r){l(t,i.getShape(),e,n.getShape(),o)})),e.CollideCircles=l},function(t,e,i){i(2);const s=i(6),o=i(0),n=i(9),r=i(11),m=i(18),c=i(27),h=i(15),l=i(21);let a,_=new o,u=new o,p=new o;function y(t,e,i,s,o,n,r){const m=i.getShape(),c=n.getShape();d(t,m,e,c.m_p,c.m_radius,o)}function d(t,e,i,n,m,c){t.pointCount=0,_=s.mulTVec2(i,s.mulVec2(c,n,_),_);const h=e.m_vertex1,l=e.m_vertex2;u=u.copy(l).sub(h);const a=o.dot(u,p.copy(_).sub(h)),y=e.m_radius+m;if(a<=0){let i=h;if(p=p.copy(_).sub(i),o.dot(p,p)>y*y)return;if(e.m_hasVertex0){const t=e.m_vertex0,i=h,s=u.copy(i).sub(t);if(o.dot(s,p.copy(i).sub(_))>0)return}return t.type=r.e_circles,t.localNormal.setZero(),t.localPoint.copy(i),t.pointCount=1,t.points[0].localPoint.copy(n),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex)}const d=o.dot(u,o.sub(l,_));if(d<=0){let i=l;if(p=p.copy(_).sub(i),o.dot(p,p)>y*y)return;if(e.m_hasVertex3){const t=e.m_vertex3,i=l,s=u.copy(t).sub(i);if(o.dot(s,p.copy(_).sub(i))>0)return}return t.type=r.e_circles,t.localNormal.setZero(),t.localPoint.copy(i),t.pointCount=1,t.points[0].localPoint.copy(n),t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex)}const f=o.dot(u,u);let x=p.setCombine(d/f,h,a/f,l);if(p=p.set(-x.x,-x.y).add(_),o.dot(p,p)>y*y)return;const g=u.set(-u.y,u.x);o.dot(g,p.copy(_).sub(h))<0&&g.set(-g.x,-g.y),g.normalize(),t.type=r.e_faceA,t.localNormal.copy(g),t.localPoint.copy(h),t.pointCount=1,t.points[0].localPoint.copy(n),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}n.addType(m.TYPE,h.TYPE,y),n.addType(c.TYPE,h.TYPE,(function(t,e,i,s,o,n,r){const c=i.getShape();a=a||new m,c.getChildEdge(a,s);const h=a,l=n.getShape();d(t,h,e,l.m_p,l.m_radius,o)})),n.addType(l.TYPE,h.TYPE,y)},function(t,e,i){i(2);const s=i(6),o=i(3),n=i(0),r=i(4),m=i(11),c=i(9),h=i(16),l=i(22);function a(t,e,i,r){const m=t.m_count,c=i.m_count,h=t.m_normals,l=t.m_vertices,_=i.m_vertices,u=s.mulTXf(r,e);let p=0,y=-1/0;for(let t=0;t<m;++t){const e=o.mulVec2(u.q,h[t]),i=s.mulVec2(u,l[t]),r=n.dot(e,i);let m=1/0;for(let t=0;t<c;++t){const i=n.dot(e,_[t])-r;i<m&&(m=i)}m>y&&(y=m,p=t)}a._maxSeparation=y,a._bestIndex=p}function _(t,e,i,c,h){t.pointCount=0;const l=e.m_radius+c.m_radius;a(e,i,c,h);const _=a._bestIndex,u=a._maxSeparation;if(u>l)return;a(c,h,e,i);const p=a._bestIndex,y=a._maxSeparation;if(y>l)return;let d,f,x,g,v,A;y>u+.1*r.linearSlop?(d=c,f=e,x=h,g=i,v=p,t.type=m.e_faceB,A=1):(d=e,f=c,x=i,g=h,v=_,t.type=m.e_faceA,A=0);const b=[new m.clipVertex,new m.clipVertex];!function(t,e,i,r,c,h){const l=e.m_normals,a=c.m_count,_=c.m_vertices,u=c.m_normals,p=o.mulT(h.q,o.mulVec2(i.q,l[r]));let y=0,d=1/0;for(let t=0;t<a;++t){const e=n.dot(p,u[t]);e<d&&(d=e,y=t)}const f=y,x=f+1<a?f+1:0;t[0].v=s.mulVec2(h,_[f]),t[0].id.cf.indexA=r,t[0].id.cf.indexB=f,t[0].id.cf.typeA=m.e_face,t[0].id.cf.typeB=m.e_vertex,t[1].v=s.mulVec2(h,_[x]),t[1].id.cf.indexA=r,t[1].id.cf.indexB=x,t[1].id.cf.typeA=m.e_face,t[1].id.cf.typeB=m.e_vertex}(b,d,x,v,f,g);const B=d.m_count,w=d.m_vertices,C=v,I=v+1<B?v+1:0;let S=w[C],V=w[I];const M=n.sub(V,S);M.normalize();const L=n.cross(M,1),P=n.combine(.5,S,.5,V),z=o.mulVec2(x.q,M),k=n.cross(z,1);S=s.mulVec2(x,S),V=s.mulVec2(x,V);const T=n.dot(k,S),O=-n.dot(z,S)+l,q=n.dot(z,V)+l,E=[new m.clipVertex,new m.clipVertex],F=[new m.clipVertex,new m.clipVertex];let R;if(R=m.clipSegmentToLine(E,b,n.neg(z),O,C),R<2)return;if(R=m.clipSegmentToLine(F,E,z,q,I),R<2)return;t.localNormal.copy(L),t.localPoint.copy(P);let D=0;for(let e=0;e<F.length;++e){if(n.dot(k,F[e].v)-T<=l){const i=t.points[D];if(i.localPoint.copy(s.mulTVec2(g,F[e].v)),i.id=F[e].id,A){const t=i.id.cf,e=t.indexA,s=t.indexB,o=t.typeA,n=t.typeB;t.indexA=s,t.indexB=e,t.typeA=n,t.typeB=o}++D}}t.pointCount=D}t.exports=_,c.addType(h.TYPE,h.TYPE,(function(t,e,i,s,o,n,r){_(t,i.getShape(),e,n.getShape(),o)})),c.addType(l.TYPE,h.TYPE,(function(t,e,i,s,o,n,r){_(t,i.getShape().getChildPolygon(s),e,n.getShape(),o)})),c.addType(l.TYPE,l.TYPE,(function(t,e,i,s,o,n,r){_(t,i.getShape().getChildPolygon(s),e,n.getShape().getChildPolygon(r),o)}))},function(t,e,i){const s=i(1),o=i(6),n=i(0),r=i(11),m=i(9),c=i(15),h=i(16),l=i(22);let a=new n;const _=new n,u=new n;function p(t,e,i,m,c){t.pointCount=0,a=o.mulVec2(c,m.m_p,a),a=o.mulTVec2(i,a,a);let h=0,l=-1/0;const p=e.m_radius+m.m_radius,y=e.m_count,d=e.m_vertices,f=e.m_normals;for(let t=0;t<y;++t){const e=n.dot(f[t],_.copy(a).sub(d[t]));if(e>p)return;e>l&&(l=e,h=t)}const x=h,g=x+1<y?x+1:0,v=d[x],A=d[g];if(l<s.EPSILON)return t.pointCount=1,t.type=r.e_faceA,t.localNormal.copy(f[h]),t.localPoint.setCombine(.5,v,.5,A),t.points[0].localPoint=m.m_p,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex);if(n.dot(_.copy(a).sub(v),u.copy(A).sub(v))<=0){if(n.distanceSquared(a,v)>p*p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.setCombine(1,a,-1,v),t.localNormal.normalize(),t.localPoint.copy(v),t.points[0].localPoint.copy(m.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}else if(n.dot(_.copy(a).sub(A),u.copy(v).sub(A))<=0){if(n.distanceSquared(a,A)>p*p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.setCombine(1,a,-1,A),t.localNormal.normalize(),t.localPoint.copy(A),t.points[0].localPoint.copy(m.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}else{const e=n.mid(v,A,u);if(l=n.dot(a,f[x])-n.dot(e,f[x]),l>p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.copy(f[x]),t.localPoint.copy(e),t.points[0].localPoint.copy(m.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}}m.addType(h.TYPE,c.TYPE,(function(t,e,i,s,o,n,r){p(t,i.getShape(),e,n.getShape(),o)})),m.addType(l.TYPE,c.TYPE,(function(t,e,i,s,o,n,r){p(t,i.getShape().getChildPolygon(s),e,n.getShape(),o)}))},function(t,e,i){const s=i(1),o=i(6),n=i(0),r=i(3),m=i(4),c=i(9),h=i(11),l=i(18),a=i(27),_=i(16),u=i(21),p=i(22);let y;function d(t,e,i,s,o,n,r){w(t,i.getShape(),e,n.getShape(),o)}function f(t,e,i,s,o,n,r){const m=n.getShape();m.initCollisionData(),w(t,i.getShape(),e,m,o)}function x(t,e,i,s,o,n,r){w(t,i.getShape(),e,n.getShape().getChildPolygon(r),o)}c.addType(l.TYPE,_.TYPE,d),c.addType(l.TYPE,u.TYPE,f),c.addType(u.TYPE,u.TYPE,f),c.addType(a.TYPE,_.TYPE,(function(t,e,i,s,o,n,r){const m=i.getShape();y=y||new l,m.getChildEdge(y,s),w(t,y,e,n.getShape(),o)})),c.addType(a.TYPE,u.TYPE,(function(t,e,i,s,o,n,r){const m=i.getShape();y=y||new l,m.getChildEdge(y,s);const c=n.getShape();c.initCollisionData(),w(t,y,e,c,o)})),c.addType(u.TYPE,_.TYPE,d),c.addType(l.TYPE,p.TYPE,x),c.addType(a.TYPE,p.TYPE,(function(t,e,i,s,o,n,r){const m=i.getShape();y=y||new l,m.getChildEdge(y,s),w(t,y,e,n.getShape().getChildPolygon(r),o)})),c.addType(u.TYPE,p.TYPE,x);function g(){this.type=0,this.index=0,this.separation=0}const v=new g,A=new g,b=new function(){this.vertices=[],this.normals=[],this.count=0},B=new function(){this.i1=0,this.i2=0,this.v1=0,this.v2=0,this.normal=n.zero(),this.sideNormal1=n.zero(),this.sideOffset1=0,this.sideNormal2=n.zero(),this.sideOffset2=0};function w(t,e,i,c,l){const a=o.mulTXf(i,l),_=o.mulVec2(a,c.m_centroid),u=e.m_vertex0,p=e.m_vertex1,y=e.m_vertex2,d=e.m_vertex3,f=e.m_hasVertex0,x=e.m_hasVertex3,g=n.sub(y,p);g.normalize();const w=n.neo(g.y,-g.x),I=n.dot(w,n.sub(_,p));let S,V=0,M=0,L=!1,P=!1,z=null,k=null;if(f){const t=n.sub(p,u);t.normalize(),z=n.neo(t.y,-t.x),L=n.cross(t,g)>=0,V=n.dot(z,_)-n.dot(z,u)}if(x){const t=n.sub(d,y);t.normalize(),k=n.neo(t.y,-t.x),P=n.cross(g,t)>0,M=n.dot(k,_)-n.dot(k,y)}const T=n.zero(),O=n.zero(),q=n.zero();f&&x?L&&P?(S=V>=0||I>=0||M>=0,S?(T.copy(w),O.copy(z),q.copy(k)):(T.setMul(-1,w),O.setMul(-1,w),q.setMul(-1,w))):L?(S=V>=0||I>=0&&M>=0,S?(T.copy(w),O.copy(z),q.copy(w)):(T.setMul(-1,w),O.setMul(-1,k),q.setMul(-1,w))):P?(S=M>=0||V>=0&&I>=0,S?(T.copy(w),O.copy(w),q.copy(k)):(T.setMul(-1,w),O.setMul(-1,w),q.setMul(-1,z))):(S=V>=0&&I>=0&&M>=0,S?(T.copy(w),O.copy(w),q.copy(w)):(T.setMul(-1,w),O.setMul(-1,k),q.setMul(-1,z))):f?L?(S=V>=0||I>=0,S?(T.copy(w),O.copy(z),q.setMul(-1,w)):(T.setMul(-1,w),O.copy(w),q.setMul(-1,w))):(S=V>=0&&I>=0,S?(T.copy(w),O.copy(w),q.setMul(-1,w)):(T.setMul(-1,w),O.copy(w),q.setMul(-1,z))):x?P?(S=I>=0||M>=0,S?(T.copy(w),O.setMul(-1,w),q.copy(k)):(T.setMul(-1,w),O.setMul(-1,w),q.copy(w))):(S=I>=0&&M>=0,S?(T.copy(w),O.setMul(-1,w),q.copy(w)):(T.setMul(-1,w),O.setMul(-1,k),q.copy(w))):(S=I>=0,S?(T.copy(w),O.setMul(-1,w),q.setMul(-1,w)):(T.setMul(-1,w),O.copy(w),q.copy(w))),b.count=c.m_count;for(let t=0;t<c.m_count;++t)b.vertices[t]=o.mulVec2(a,c.m_vertices[t]),b.normals[t]=r.mulVec2(a.q,c.m_normals[t]);const E=e.m_radius+c.m_radius;t.pointCount=0,v.type=1,v.index=S?0:1,v.separation=1/0;for(let t=0;t<b.count;++t){const e=n.dot(T,n.sub(b.vertices[t],p));e<v.separation&&(v.separation=e)}if(-1===v.type)return;if(v.separation>E)return;{A.type=-1,A.index=-1,A.separation=-1/0;const t=n.neo(-T.y,T.x);for(let e=0;e<b.count;++e){const i=n.neg(b.normals[e]),o=n.dot(i,n.sub(b.vertices[e],p)),r=n.dot(i,n.sub(b.vertices[e],y));let c=s.min(o,r);if(c>E){A.type=2,A.index=e,A.separation=c;break}if(n.dot(i,t)>=0){if(n.dot(n.sub(i,q),T)<-m.angularSlop)continue}else if(n.dot(n.sub(i,O),T)<-m.angularSlop)continue;c>A.separation&&(A.type=2,A.index=e,A.separation=c)}}if(-1!==A.type&&A.separation>E)return;let F;F=-1===A.type?v:A.separation>.98*v.separation+.001?A:v;const R=[new h.clipVertex,new h.clipVertex];let D,N;if(1===F.type){t.type=h.e_faceA;let e=0,i=n.dot(T,b.normals[0]);for(let t=1;t<b.count;++t){const s=n.dot(T,b.normals[t]);s<i&&(i=s,e=t)}const s=e,o=s+1<b.count?s+1:0;R[0].v=b.vertices[D=s],R[0].id.cf.indexA=0,R[0].id.cf.indexB=s,R[0].id.cf.typeA=h.e_face,R[0].id.cf.typeB=h.e_vertex,R[1].v=b.vertices[N=o],R[1].id.cf.indexA=0,R[1].id.cf.indexB=o,R[1].id.cf.typeA=h.e_face,R[1].id.cf.typeB=h.e_vertex,S?(B.i1=0,B.i2=1,B.v1=p,B.v2=y,B.normal.copy(w)):(B.i1=1,B.i2=0,B.v1=y,B.v2=p,B.normal.setMul(-1,w))}else t.type=h.e_faceB,R[0].v=p,R[0].id.cf.indexA=0,R[0].id.cf.indexB=F.index,R[0].id.cf.typeA=h.e_vertex,R[0].id.cf.typeB=h.e_face,R[1].v=y,R[1].id.cf.indexA=0,R[1].id.cf.indexB=F.index,R[1].id.cf.typeA=h.e_vertex,R[1].id.cf.typeB=h.e_face,B.i1=F.index,B.i2=B.i1+1<b.count?B.i1+1:0,B.v1=b.vertices[D=B.i1],B.v2=b.vertices[N=B.i2],B.normal.copy(b.normals[B.i1]);B.sideNormal1.set(B.normal.y,-B.normal.x),B.sideNormal2.setMul(-1,B.sideNormal1),B.sideOffset1=n.dot(B.sideNormal1,B.v1),B.sideOffset2=n.dot(B.sideNormal2,B.v2);const U=[new h.clipVertex,new h.clipVertex],j=[new h.clipVertex,new h.clipVertex];let Y;if(Y=h.clipSegmentToLine(U,R,B.sideNormal1,B.sideOffset1,B.i1),Y<m.maxManifoldPoints)return void C(t,e,c,b,D,N);if(Y=h.clipSegmentToLine(j,U,B.sideNormal2,B.sideOffset2,B.i2),Y<m.maxManifoldPoints)return void C(t,e,c,b,D,N);1===F.type?(t.localNormal.copy(B.normal),t.localPoint.copy(B.v1)):(t.localNormal.copy(c.m_normals[B.i1]),t.localPoint.copy(c.m_vertices[B.i1]));let W=0;for(let e=0;e<m.maxManifoldPoints;++e){if(n.dot(B.normal,n.sub(j[e].v,B.v1))<=E){const i=t.points[W];1===F.type?(i.localPoint.copy(o.mulT(a,j[e].v)),i.id=j[e].id):(i.localPoint.copy(j[e].v),i.id.cf.typeA=j[e].id.cf.typeB,i.id.cf.typeB=j[e].id.cf.typeA,i.id.cf.indexA=j[e].id.cf.indexB,i.id.cf.indexB=j[e].id.cf.indexA),++W}}t.pointCount=W}function C(t,e,i,s,o,r){const m=e.m_radius+i.m_radius,c=m*m,l=e.m_vertex1,a=e.m_vertex2,_=s.vertices[o],u=s.vertices[r],p=n.distanceSquared(l,_),y=n.distanceSquared(l,u),d=n.distanceSquared(a,_),f=n.distanceSquared(a,u);let x=1/0,g=-1,v=-1;if(p<=c&&(x=p,g=0,v=o),y<=c&&y<x&&(x=y,g=0,v=r),d<=c&&d<x&&(x=d,g=1,v=o),f<=c&&f<x&&(g=1,v=r),g<0)return;!function(t,e,i,s,o){t.type=h.e_circles,t.localPoint.copy(e),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.copy(s),t.points[0].id.cf.indexA=i,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=o,t.points[0].id.cf.typeB=h.e_vertex}(t,0===g?e.m_vertex1:e.m_vertex2,g,i.m_vertices[v],v)}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(3),h=i(8);a.TYPE="distance-joint",a._super=h,a.prototype=o(a._super.prototype);const l={frequencyHz:0,dampingRatio:0,active:!0};function a(t,e,i,o,n){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o,n);if(i&&o&&"m_type"in o&&"x"in i&&"y"in i){const t=i;i=o,o=t}t=s(t,l),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||m.zero(),r.isFinite(t.length)?(this.m_length=t.length,this.m_autoLength=!1):(this.m_length=m.distance(e.getWorldPoint(this.m_localAnchorA),i.getWorldPoint(this.m_localAnchorB)),this.m_autoLength=!0),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u=m.ZERO,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},a.prototype.setLength=function(t){this.m_length=t},a.prototype.getLength=function(){return this.m_length},a.prototype.setFrequency=function(t){this.m_frequencyHz=t},a.prototype.getFrequency=function(){return this.m_frequencyHz},a.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},a.prototype.getDampingRatio=function(){return this.m_dampingRatio},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return m.mulSV(this.m_impulse,this.m_u,e).mul(t)},a.prototype.getReactionTorque=function(t){return 0},a.prototype.setBodyA=function(t){a._super.prototype.setBodyA.call(this,t),this.m_autoLength&&(this.m_length=m.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},a.prototype.setBodyB=function(t){a._super.prototype.setBodyB.call(this,t),this.m_autoLength&&(this.m_length=m.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))};const _=m.zero();a.prototype.initVelocityConstraints=function(t){const e=_;this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=this.m_bodyA.c_position.c,s=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v;let h=this.m_bodyA.c_velocity.w;const l=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,u=this.m_bodyB.c_velocity.v;let p=this.m_bodyB.c_velocity.w;const y=c.neo(s),d=c.neo(a);this.m_rA=c.mulVec2(y,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=c.mulVec2(d,m.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=m.sub(m.add(l,this.m_rB),m.add(i,this.m_rA));const f=this.m_u.length();f>n.linearSlop?this.m_u.mul(1/f):this.m_u.set(0,0);const x=m.cross(this.m_rA,this.m_u),g=m.cross(this.m_rB,this.m_u);let v=this.m_invMassA+this.m_invIA*x*x+this.m_invMassB+this.m_invIB*g*g;if(this.m_mass=0!=v?1/v:0,this.m_frequencyHz>0){const e=f-this.m_length,i=2*r.PI*this.m_frequencyHz,s=2*this.m_mass*this.m_dampingRatio*i,o=this.m_mass*i*i,n=t.dt;this.m_gamma=n*(s+n*o),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=e*n*o*this.m_gamma,v+=this.m_gamma,this.m_mass=0!=v?1/v:0}else this.m_gamma=0,this.m_bias=0;t.warmStarting?(this.m_impulse*=t.dtRatio,m.mulSV(this.m_impulse,this.m_u,e),o.subMul(this.m_invMassA,e),h-=this.m_invIA*m.crossVV(this.m_rA,e),u.addMul(this.m_invMassB,e),p+=this.m_invIB*m.crossVV(this.m_rB,e)):this.m_impulse=0,this.m_bodyA.c_velocity.v.copy(o),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.copy(u),this.m_bodyB.c_velocity.w=p};const u=m.zero(),p=m.zero(),y=m.zero(),d=m.zero();a.prototype.solveVelocityConstraints=function(t){const e=d,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_velocity.v;let n=this.m_bodyB.c_velocity.w;m.crossSV(s,this.m_rA,u),p.copy(i).add(u),m.crossSV(n,this.m_rB,u),y.copy(o).add(u);const r=m.dot(this.m_u,y)-m.dot(this.m_u,p),c=-this.m_mass*(r+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c,m.mulSV(c,this.m_u,e),i.subMul(this.m_invMassA,e),s-=this.m_invIA*m.crossVV(this.m_rA,e),o.addMul(this.m_invMassB,e),n+=this.m_invIB*m.crossVV(this.m_rB,e),this.m_bodyA.c_velocity.v.copy(i),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.copy(o),this.m_bodyB.c_velocity.w=n};const f=m.zero();a.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;const e=f,i=this.m_bodyA.c_position.c;let s=this.m_bodyA.c_position.a;const o=this.m_bodyB.c_position.c;let h=this.m_bodyB.c_position.a;const l=c.neo(s),a=c.neo(h),_=c.mulSub(l,this.m_localAnchorA,this.m_localCenterA),u=c.mulSub(a,this.m_localAnchorB,this.m_localCenterB),p=m.sub(m.add(o,u),m.add(i,_));let y=p.normalize()-this.m_length;y=r.clamp(y,-n.maxLinearCorrection,n.maxLinearCorrection);const d=-this.m_mass*y;return m.mulSV(d,p,e),i.subMul(this.m_invMassA,e),s-=this.m_invIA*m.crossVV(_,e),o.addMul(this.m_invMassB,e),h+=this.m_invIB*m.crossVV(u,e),this.m_bodyA.c_position.c.copy(i),this.m_bodyA.c_position.a=s,this.m_bodyB.c_position.c.copy(o),this.m_bodyB.c_position.a=h,r.abs(y)<n.linearSlop}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(1),r=i(0),m=i(10),c=i(3),h=i(8);a.TYPE="friction-joint",a._super=h,a.prototype=o(a._super.prototype);const l={maxForce:0,maxTorque:0,active:!0};function a(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o);t=s(t,l),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||r.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||r.zero(),this.m_linearImpulse=r.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},a.prototype.setMaxForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxForce=t},a.prototype.getMaxForce=function(){return this.m_maxForce},a.prototype.setMaxTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxTorque=t},a.prototype.getMaxTorque=function(){return this.m_maxTorque},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return r.mulSV(t,this.m_linearImpulse,e)},a.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v;let h=this.m_bodyB.c_velocity.w;const l=c.neo(e),a=c.neo(o);this.m_rA=c.mulVec2(l,r.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=c.mulVec2(a,r.sub(this.m_localAnchorB,this.m_localCenterB));const _=this.m_invMassA,u=this.m_invMassB,p=this.m_invIA,y=this.m_invIB,d=new m;if(d.ex.x=_+u+p*this.m_rA.y*this.m_rA.y+y*this.m_rB.y*this.m_rB.y,d.ex.y=-p*this.m_rA.x*this.m_rA.y-y*this.m_rB.x*this.m_rB.y,d.ey.x=d.ex.y,d.ey.y=_+u+p*this.m_rA.x*this.m_rA.x+y*this.m_rB.x*this.m_rB.x,this.m_linearMass=d.getInverse(),this.m_angularMass=p+y,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;const e=r.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(_,e),s-=p*(r.cross(this.m_rA,e)+this.m_angularImpulse),n.addMul(u,e),h+=y*(r.cross(this.m_rB,e)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=h},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const c=this.m_invMassA,h=this.m_invMassB,l=this.m_invIA,a=this.m_invIB,_=t.dt;{let t=o-i,e=-this.m_angularMass*t,s=this.m_angularImpulse,r=_*this.m_maxTorque;this.m_angularImpulse=n.clamp(this.m_angularImpulse+e,-r,r),e=this.m_angularImpulse-s,i-=l*e,o+=a*e}{let t=r.sub(r.add(s,r.cross(o,this.m_rB)),r.add(e,r.cross(i,this.m_rA))),n=r.neg(m.mulVec2(this.m_linearMass,t)),u=this.m_linearImpulse.clone();this.m_linearImpulse.add(n);let p=_*this.m_maxForce;this.m_linearImpulse.lengthSquared()>p*p&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(p)),n=r.sub(this.m_linearImpulse,u),e.subMul(c,n),i-=l*r.cross(this.m_rA,n),s.addMul(h,n),o+=a*r.cross(this.m_rB,n)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){t.exports=_;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(3),h=i(8),l=i(32);i(33);_.TYPE="gear-joint",_._super=h,_.prototype=o(_._super.prototype);const a={ratio:1,active:!0};function _(t,e,i,o,n,u){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof _))return new _(t,e,i,o,n,u);let p,y;t=s(t,a),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_joint1=o||t.joint1,this.m_joint2=n||t.joint2,this.m_ratio=r.isFinite(u)?u:t.ratio,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType(),this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();const d=this.m_bodyA.m_xf,f=this.m_bodyA.m_sweep.a,x=this.m_bodyC.m_xf,g=this.m_bodyC.m_sweep.a;if(this.m_type1===l.TYPE){let t=this.m_joint1;this.m_localAnchorC=t.m_localAnchorA,this.m_localAnchorA=t.m_localAnchorB,this.m_referenceAngleA=t.m_referenceAngle,this.m_localAxisC=m.zero(),p=f-g-this.m_referenceAngleA}else{let t=this.m_joint1;this.m_localAnchorC=t.m_localAnchorA,this.m_localAnchorA=t.m_localAnchorB,this.m_referenceAngleA=t.m_referenceAngle,this.m_localAxisC=t.m_localXAxisA;const e=this.m_localAnchorC,i=c.mulTVec2(x.q,m.add(c.mul(d.q,this.m_localAnchorA),m.sub(d.p,x.p)));p=m.dot(i,this.m_localAxisC)-m.dot(e,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();const v=this.m_bodyB.m_xf,A=this.m_bodyB.m_sweep.a,b=this.m_bodyD.m_xf,B=this.m_bodyD.m_sweep.a;if(this.m_type2===l.TYPE){let t=this.m_joint2;this.m_localAnchorD=t.m_localAnchorA,this.m_localAnchorB=t.m_localAnchorB,this.m_referenceAngleB=t.m_referenceAngle,this.m_localAxisD=m.zero(),y=A-B-this.m_referenceAngleB}else{let t=this.m_joint2;this.m_localAnchorD=t.m_localAnchorA,this.m_localAnchorB=t.m_localAnchorB,this.m_referenceAngleB=t.m_referenceAngle,this.m_localAxisD=t.m_localXAxisA;const e=this.m_localAnchorD,i=c.mulTVec2(b.q,m.add(c.mul(v.q,this.m_localAnchorB),m.sub(v.p,b.p)));y=m.dot(i,this.m_localAxisD)-m.dot(e,this.m_localAxisD)}this.m_constant=p+this.m_ratio*y,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}_.prototype.getJoint1=function(){return this.m_joint1},_.prototype.getJoint2=function(){return this.m_joint2},_.prototype.setRatio=function(t){this.m_ratio=t},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return m.mul(this.m_impulse,this.m_JvAC).mul(t)},_.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},_.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v;let r=this.m_bodyB.c_velocity.w;const h=this.m_bodyC.c_position.a,a=this.m_bodyC.c_velocity.v;let _=this.m_bodyC.c_velocity.w;const u=this.m_bodyD.c_position.a,p=this.m_bodyD.c_velocity.v;let y=this.m_bodyD.c_velocity.w;const d=c.neo(e),f=c.neo(o),x=c.neo(h),g=c.neo(u);if(this.m_mass=0,this.m_JvBD=m.zero(),this.m_type1==l.TYPE)this.m_JvAC=m.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{let t=c.mulVec2(x,this.m_localAxisC);const e=c.mulSub(x,this.m_localAnchorC,this.m_lcC),i=c.mulSub(d,this.m_localAnchorA,this.m_lcA);this.m_JvAC=t,this.m_JwC=m.cross(e,t),this.m_JwA=m.cross(i,t),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==l.TYPE)this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{let t=c.mulVec2(g,this.m_localAxisD);const e=c.mulSub(g,this.m_localAnchorD,this.m_lcD),i=c.mulSub(f,this.m_localAnchorB,this.m_lcB);m.mulSV(this.m_ratio,t,this.m_JvBD),this.m_JwD=this.m_ratio*m.cross(e,t),this.m_JwB=this.m_ratio*m.cross(i,t),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(i.addMul(this.m_mA*this.m_impulse,this.m_JvAC),s+=this.m_iA*this.m_impulse*this.m_JwA,n.addMul(this.m_mB*this.m_impulse,this.m_JvBD),r+=this.m_iB*this.m_impulse*this.m_JwB,a.subMul(this.m_mC*this.m_impulse,this.m_JvAC),_-=this.m_iC*this.m_impulse*this.m_JwC,p.subMul(this.m_mD*this.m_impulse,this.m_JvBD),y-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.copy(i),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.copy(n),this.m_bodyB.c_velocity.w=r,this.m_bodyC.c_velocity.v.copy(a),this.m_bodyC.c_velocity.w=_,this.m_bodyD.c_velocity.v.copy(p),this.m_bodyD.c_velocity.w=y},_.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_bodyC.c_velocity.v;let r=this.m_bodyC.c_velocity.w;const c=this.m_bodyD.c_velocity.v;let h=this.m_bodyD.c_velocity.w,l=m.dot(this.m_JvAC,e)-m.dot(this.m_JvAC,n)+m.dot(this.m_JvBD,s)-m.dot(this.m_JvBD,c);l+=this.m_JwA*i-this.m_JwC*r+(this.m_JwB*o-this.m_JwD*h);const a=-this.m_mass*l;this.m_impulse+=a,e.addMul(this.m_mA*a,this.m_JvAC),i+=this.m_iA*a*this.m_JwA,s.addMul(this.m_mB*a,this.m_JvBD),o+=this.m_iB*a*this.m_JwB,n.subMul(this.m_mC*a,this.m_JvAC),r-=this.m_iC*a*this.m_JwC,c.subMul(this.m_mD*a,this.m_JvBD),h-=this.m_iD*a*this.m_JwD,this.m_bodyA.c_velocity.v.copy(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.copy(s),this.m_bodyB.c_velocity.w=o,this.m_bodyC.c_velocity.v.copy(n),this.m_bodyC.c_velocity.w=r,this.m_bodyD.c_velocity.v.copy(c),this.m_bodyD.c_velocity.w=h},_.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const r=this.m_bodyC.c_position.c;let h=this.m_bodyC.c_position.a;const a=this.m_bodyD.c_position.c;let _=this.m_bodyD.c_position.a;const u=c.neo(i),p=c.neo(o),y=c.neo(h),d=c.neo(_);let f,x,g,v,A,b,B,w=m.zero(),C=0;if(this.m_type1==l.TYPE)g=m.zero(),v=1,b=1,C+=this.m_iA+this.m_iC,f=i-h-this.m_referenceAngleA;else{let t=c.mulVec2(y,this.m_localAxisC);const i=c.mulSub(y,this.m_localAnchorC,this.m_lcC),s=c.mulSub(u,this.m_localAnchorA,this.m_lcA);g=t,b=m.cross(i,t),v=m.cross(s,t),C+=this.m_mC+this.m_mA+this.m_iC*b*b+this.m_iA*v*v;const o=m.sub(this.m_localAnchorC,this.m_lcC),n=c.mulTVec2(y,m.add(s,m.sub(e,r)));f=m.dot(m.sub(n,o),this.m_localAxisC)}if(this.m_type2==l.TYPE)A=this.m_ratio,B=this.m_ratio,C+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),x=o-_-this.m_referenceAngleB;else{let t=c.mulVec2(d,this.m_localAxisD);const e=c.mulSub(d,this.m_localAnchorD,this.m_lcD),i=c.mulSub(p,this.m_localAnchorB,this.m_lcB);m.mulSV(this.m_ratio,t,w),B=this.m_ratio*m.cross(e,t),A=this.m_ratio*m.cross(i,t),C+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*B*B+this.m_iB*A*A;const o=m.sub(this.m_localAnchorD,this.m_lcD),n=c.mulTVec2(d,m.add(i,m.sub(s,a)));x=m.dot(n,this.m_localAxisD)-m.dot(o,this.m_localAxisD)}const I=f+this.m_ratio*x-this.m_constant;let S=0;return C>0&&(S=-I/C),e.addMul(this.m_mA*S,g),i+=this.m_iA*S*v,s.addMul(this.m_mB*S,w),o+=this.m_iB*S*A,r.subMul(this.m_mC*S,g),h-=this.m_iC*S*b,a.subMul(this.m_mD*S,w),_-=this.m_iD*S*B,this.m_bodyA.c_position.c.copy(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.copy(s),this.m_bodyB.c_position.a=o,this.m_bodyC.c_position.c.copy(r),this.m_bodyC.c_position.a=h,this.m_bodyD.c_position.c.copy(a),this.m_bodyD.c_position.a=_,0<n.linearSlop}},function(t,e,i){t.exports=a;i(2);const s=i(7),o=i(5),n=i(1),r=i(0),m=i(10),c=i(3),h=i(8);a.TYPE="motor-joint",a._super=h,a.prototype=o(a._super.prototype);const l={maxForce:1,maxTorque:1,correctionFactor:.3,active:!0};function a(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i);t=s(t,l),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_linearOffset=t.linearOffset?t.linearOffset:e.getLocalPoint(i.getPosition()),this.m_angularOffset=t.angularOffset?t.angularOffset:i.getAngle()-e.getAngle(),this.m_linearImpulse=r.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}a.prototype.setMaxForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxForce=t},a.prototype.getMaxForce=function(){return this.m_maxForce},a.prototype.setMaxTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxTorque=t},a.prototype.getMaxTorque=function(){return this.m_maxTorque},a.prototype.setCorrectionFactor=function(t){this.m_correctionFactor=t},a.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},a.prototype.setLinearOffset=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t},a.prototype.getLinearOffset=function(){return this.m_linearOffset},a.prototype.setAngularOffset=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t},a.prototype.getAngularOffset=function(){return this.m_angularOffset},a.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},a.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},a.prototype.getReactionForce=function(t,e){return r.mulSV(t,this.m_linearImpulse,e)},a.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const n=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let a=this.m_bodyB.c_velocity.w;const _=c.neo(i),u=c.neo(h);this.m_rA=c.mulVec2(_,this.m_linearOffset.clone().sub(this.m_localCenterA)),this.m_rB=c.mulVec2(u,r.neg(this.m_localCenterB));const p=this.m_invMassA,y=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,x=new m;if(x.ex.x=p+y+d*this.m_rA.y*this.m_rA.y+f*this.m_rB.y*this.m_rB.y,x.ex.y=-d*this.m_rA.x*this.m_rA.y-f*this.m_rB.x*this.m_rB.y,x.ey.x=x.ex.y,x.ey.y=p+y+d*this.m_rA.x*this.m_rA.x+f*this.m_rB.x*this.m_rB.x,this.m_linearMass=x.getInverse(),this.m_angularMass=d+f,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=r.zero(),this.m_linearError.addCombine(1,n,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_angularError=h-i-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;const e=r.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);s.subMul(p,e),o-=d*(r.cross(this.m_rA,e)+this.m_angularImpulse),l.addMul(y,e),a+=f*(r.cross(this.m_rB,e)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=s,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=a},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const c=this.m_invMassA,h=this.m_invMassB,l=this.m_invIA,a=this.m_invIB,_=t.dt,u=t.inv_dt;{let t=o-i+u*this.m_correctionFactor*this.m_angularError,e=-this.m_angularMass*t,s=this.m_angularImpulse,r=_*this.m_maxTorque;this.m_angularImpulse=n.clamp(this.m_angularImpulse+e,-r,r),e=this.m_angularImpulse-s,i-=l*e,o+=a*e}{let t=r.zero();t.addCombine(1,s,1,r.cross(o,this.m_rB)),t.subCombine(1,e,1,r.cross(i,this.m_rA)),t.addMul(u*this.m_correctionFactor,this.m_linearError);let n=r.neg(m.mulVec2(this.m_linearMass,t)),p=r.clone(this.m_linearImpulse);this.m_linearImpulse.add(n);let y=_*this.m_maxForce;this.m_linearImpulse.clamp(y),n=r.sub(this.m_linearImpulse,p),e.subMul(c,n),i-=l*r.cross(this.m_rA,n),s.addMul(h,n),o+=a*r.cross(this.m_rB,n)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){t.exports=_;i(2);const s=i(7),o=i(5),n=i(1),r=i(0),m=i(10),c=i(3),h=i(6),l=i(8);_.TYPE="mouse-joint",_._super=l,_.prototype=o(_._super.prototype);const a={maxForce:0,frequencyHz:5,dampingRatio:.7,active:!0};function _(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof _))return new _(t,e,i,o);t=s(t,a),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_targetA=o?r.clone(o):t.target||r.zero(),this.m_localAnchorB=t.anchorB?t.anchorB:h.mulTVec2(i.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=r.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=r.zero(),this.m_localCenterB=r.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new m,this.m_C=r.zero()}_.prototype.setTarget=function(t){0==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0),this.m_targetA=t},_.prototype.getTarget=function(){return this.m_targetA},_.prototype.setMaxForce=function(t){this.m_bodyB.setAwake(!0),this.m_maxForce=t},_.getMaxForce=function(){return this.m_maxForce},_.prototype.setFrequency=function(t){this.m_bodyB.setAwake(!0),this.m_frequencyHz=t},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(t){this.m_bodyB.setAwake(!0),this.m_dampingRatio=t},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return r.clone(this.m_targetA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getLocalAnchorB=function(t){return this.m_localAnchorB},_.prototype.setLocalAnchorB=function(t){return this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},_.prototype.getReactionForce=function(t,e){return r.mulSV(t,this.m_impulse,e)},_.prototype.getReactionTorque=function(t){return 0*t},_.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},_.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyB.c_position,i=this.m_bodyB.c_velocity,s=e.c,o=e.a,h=i.v;let l=i.w;const a=c.neo(o),_=this.m_bodyB.getMass(),u=2*n.PI*this.m_frequencyHz,p=2*_*this.m_dampingRatio*u,y=_*(u*u),d=t.dt;this.m_gamma=d*(p+d*y),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=d*y*this.m_gamma,this.m_rB=c.mulVec2(a,r.sub(this.m_localAnchorB,this.m_localCenterB));const f=new m;f.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,f.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,f.ey.x=f.ex.y,f.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=f.getInverse(),this.m_C.copy(s),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),l*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),h.addMul(this.m_invMassB,this.m_impulse),l+=this.m_invIB*r.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),i.v.copy(h),i.w=l},_.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyB.c_velocity,i=r.clone(e.v);let s=e.w;const o=r.cross(s,this.m_rB);o.add(i),o.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),o.neg();let n=m.mulVec2(this.m_mass,o);const c=r.clone(this.m_impulse);this.m_impulse.add(n);const h=t.dt*this.m_maxForce;this.m_impulse.clamp(h),n=r.sub(this.m_impulse,c),i.addMul(this.m_invMassB,n),s+=this.m_invIB*r.cross(this.m_rB,n),e.v.copy(i),e.w=s},_.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){t.exports=a;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(3),h=i(8);a.TYPE="pulley-joint",a.MIN_PULLEY_LENGTH=2,a._super=h,a.prototype=o(a._super.prototype);const l={collideConnected:!0,active:!0};function a(t,e,i,o,n,c,_,u){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o,n,c,_,u);t=s(t,l),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_groundAnchorA=o||t.groundAnchorA||m.neo(-1,1),this.m_groundAnchorB=n||t.groundAnchorB||m.neo(1,1),this.m_localAnchorA=c?e.getLocalPoint(c):t.localAnchorA||m.neo(-1,0),this.m_localAnchorB=_?i.getLocalPoint(_):t.localAnchorB||m.neo(1,0),this.m_lengthA=r.isFinite(t.lengthA)?t.lengthA:m.distance(c,o),this.m_lengthB=r.isFinite(t.lengthB)?t.lengthB:m.distance(_,n),this.m_ratio=r.isFinite(u)?u:t.ratio,this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}a.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},a.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},a.prototype.getLengthA=function(){return this.m_lengthA},a.prototype.getLengthB=function(){return this.m_lengthB},a.prototype.getRatio=function(){return this.m_ratio},a.prototype.getCurrentLengthA=function(){const t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return m.distance(t,e)},a.prototype.getCurrentLengthB=function(){const t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return m.distance(t,e)},a.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t){return m.mul(this.m_impulse,this.m_uB).mul(t)},a.prototype.getReactionTorque=function(t){return 0};const _=m.zero(),u=m.zero();a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const r=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let a=this.m_bodyB.c_velocity.w;const p=_,y=u,d=c.neo(i),f=c.neo(h);this.m_rA=c.mulVec2(d,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=c.mulVec2(f,m.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=m.sub(m.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=m.sub(m.add(r,this.m_rB),this.m_groundAnchorB);const x=this.m_uA.length(),g=this.m_uB.length();x>10*n.linearSlop?this.m_uA.mul(1/x):this.m_uA.setZero(),g>10*n.linearSlop?this.m_uB.mul(1/g):this.m_uB.setZero();const v=m.cross(this.m_rA,this.m_uA),A=m.cross(this.m_rB,this.m_uB),b=this.m_invMassA+this.m_invIA*v*v,B=this.m_invMassB+this.m_invIB*A*A;this.m_mass=b+this.m_ratio*this.m_ratio*B,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting?(this.m_impulse*=t.dtRatio,m.mulSV(-this.m_impulse,this.m_uA,p),m.mulSV(-this.m_ratio*this.m_impulse,this.m_uB,y),s.addMul(this.m_invMassA,p),o+=this.m_invIA*m.cross(this.m_rA,p),l.addMul(this.m_invMassB,y),a+=this.m_invIB*m.cross(this.m_rB,y)):this.m_impulse=0,this.m_bodyA.c_velocity.v=s,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=a};const p=m.zero(),y=m.zero();a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=p,r=y,c=m.add(e,m.cross(i,this.m_rA)),h=m.add(s,m.cross(o,this.m_rB)),l=-m.dot(this.m_uA,c)-this.m_ratio*m.dot(this.m_uB,h),a=-this.m_mass*l;this.m_impulse+=a,m.mulSV(-a,this.m_uA,n),m.mulSV(-this.m_ratio*a,this.m_uB,r),e.addMul(this.m_invMassA,n),i+=this.m_invIA*m.cross(this.m_rA,n),s.addMul(this.m_invMassB,r),o+=this.m_invIB*m.cross(this.m_rB,r),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o};const d=m.zero(),f=m.zero();a.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const h=d,l=f,a=c.neo(i),_=c.neo(o),u=c.mulVec2(a,m.sub(this.m_localAnchorA,this.m_localCenterA)),p=c.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB)),y=m.sub(m.add(e,this.m_rA),this.m_groundAnchorA),x=m.sub(m.add(s,this.m_rB),this.m_groundAnchorB),g=y.length(),v=x.length();g>10*n.linearSlop?y.mul(1/g):y.setZero(),v>10*n.linearSlop?x.mul(1/v):x.setZero();const A=m.cross(u,y),b=m.cross(p,x),B=this.m_invMassA+this.m_invIA*A*A,w=this.m_invMassB+this.m_invIB*b*b;let C=B+this.m_ratio*this.m_ratio*w;C>0&&(C=1/C);const I=this.m_constant-g-this.m_ratio*v,S=r.abs(I),V=-C*I;return m.mulSV(-V,y,h),m.mulSV(-this.m_ratio*V,x,l),e.addMul(this.m_invMassA,h),i+=this.m_invIA*m.crossVV(u,h),s.addMul(this.m_invMassB,l),o+=this.m_invIB*m.crossVV(p,l),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=o,S<n.linearSlop}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(3),h=i(8);a.TYPE="rope-joint",a._super=h,a.prototype=o(a._super.prototype);const l={maxLength:0,active:!0};function a(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o);t=s(t,l),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.neo(-1,0),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.neo(1,0),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=0,this.m_u=null,this.m_rA=null,this.m_rB=null,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},a.prototype.setMaxLength=function(t){this.m_maxLength=t},a.prototype.getMaxLength=function(){return this.m_maxLength},a.prototype.setLength=function(t){this.m_maxLength=t},a.prototype.getLength=function(){return this.m_maxLength},a.prototype.getLimitState=function(){return this.m_state},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return m.mulSV(this.m_impulse,this.m_u,e).mul(t)},a.prototype.getReactionTorque=function(t){return 0};const _=m.zero();a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const r=_,h=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v;let u=this.m_bodyB.c_velocity.w;const p=c.neo(i),y=c.neo(l);this.m_rA=c.mulSub(p,this.m_localAnchorA,this.m_localCenterA),this.m_rB=c.mulSub(y,this.m_localAnchorB,this.m_localCenterB),this.m_u=m.zero(),this.m_u.addCombine(1,h,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();const d=this.m_length-this.m_maxLength;if(this.m_state=d>0?2:0,!(this.m_length>n.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);const f=m.cross(this.m_rA,this.m_u),x=m.cross(this.m_rB,this.m_u),g=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*x*x;this.m_mass=0!==g?1/g:0,t.warmStarting?(this.m_impulse*=t.dtRatio,m.mulSV(this.m_impulse,this.m_u,r),s.subMul(this.m_invMassA,r),o-=this.m_invIA*m.cross(this.m_rA,r),a.addMul(this.m_invMassB,r),u+=this.m_invIB*m.cross(this.m_rB,r)):this.m_impulse=0,this.m_bodyA.c_velocity.v.copy(s),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.copy(a),this.m_bodyB.c_velocity.w=u};const u=m.zero();a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=u,c=m.addCross(e,i,this.m_rA),h=m.addCross(s,o,this.m_rB),l=this.m_length-this.m_maxLength;let a=m.dot(this.m_u,m.sub(h,c));l<0&&(a+=t.inv_dt*l);let _=-this.m_mass*a;const p=this.m_impulse;this.m_impulse=r.min(0,this.m_impulse+_),_=this.m_impulse-p,m.mulSV(_,this.m_u,n),e.subMul(this.m_invMassA,n),i-=this.m_invIA*m.crossVV(this.m_rA,n),s.addMul(this.m_invMassB,n),o+=this.m_invIB*m.crossVV(this.m_rB,n),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o};const p=m.zero();a.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const h=p,l=c.neo(i),a=c.neo(o),_=c.mulSub(l,this.m_localAnchorA,this.m_localCenterA),u=c.mulSub(a,this.m_localAnchorB,this.m_localCenterB),y=m.zero();y.addCombine(1,s,1,u),y.subCombine(1,e,1,_);const d=y.normalize();let f=d-this.m_maxLength;f=r.clamp(f,0,n.maxLinearCorrection);const x=-this.m_mass*f;return m.mulSV(x,y,h),e.subMul(this.m_invMassA,h),i-=this.m_invIA*m.crossVV(_,h),s.addMul(this.m_invMassB,h),o+=this.m_invIB*m.crossVV(u,h),this.m_bodyA.c_position.c.copy(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.copy(s),this.m_bodyB.c_position.a=o,d-this.m_maxLength<n.linearSlop}},function(t,e,i){t.exports=u;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(17),h=i(19),l=i(3),a=i(8);u.TYPE="weld-joint",u._super=a,u.prototype=o(u._super.prototype);const _={frequencyHz:0,dampingRatio:0,active:!0};function u(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof u))return new u(t,e,i,o);t=s(t,_),a.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=u.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),r.isFinite(t.referenceAngle)?(this.m_referenceAngle=t.referenceAngle,this.m_autoReferenceAngle=!1):(this.m_referenceAngle=i.getAngle()-e.getAngle(),this.m_autoReferenceAngle=!0),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=c(),this.m_bias=0,this.m_gamma=0,this.m_rA=null,this.m_rB=null,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new h}u.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},u.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},u.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},u.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},u.prototype.getReferenceAngle=function(){return this.m_referenceAngle},u.prototype.setReferenceAngle=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_referenceAngle=t},u.prototype.setFrequency=function(t){this.m_frequencyHz=t},u.prototype.getFrequency=function(){return this.m_frequencyHz},u.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},u.prototype.getDampingRatio=function(){return this.m_dampingRatio},u.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},u.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},u.prototype.getReactionForce=function(t,e){return(e=e||m.zero()).set(this.m_impulse.x,this.m_impulse.y).mul(t)},u.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},u.prototype.setBodyA=function(t){u._super.prototype.setBodyA.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},u.prototype.setBodyB=function(t){u._super.prototype.setBodyB.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},u.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v;let c=this.m_bodyB.c_velocity.w;const a=l.neo(e),_=l.neo(o);this.m_rA=l.mulVec2(a,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=l.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB));const u=this.m_invMassA,p=this.m_invMassB,y=this.m_invIA,d=this.m_invIB,f=new h;if(f.ex.x=u+p+this.m_rA.y*this.m_rA.y*y+this.m_rB.y*this.m_rB.y*d,f.ey.x=-this.m_rA.y*this.m_rA.x*y-this.m_rB.y*this.m_rB.x*d,f.ez.x=-this.m_rA.y*y-this.m_rB.y*d,f.ex.y=f.ey.x,f.ey.y=u+p+this.m_rA.x*this.m_rA.x*y+this.m_rB.x*this.m_rB.x*d,f.ez.y=this.m_rA.x*y+this.m_rB.x*d,f.ex.z=f.ez.x,f.ey.z=f.ez.y,f.ez.z=y+d,this.m_frequencyHz>0){f.getInverse22(this.m_mass);let i=y+d;const s=i>0?1/i:0,n=o-e-this.m_referenceAngle,m=2*r.PI*this.m_frequencyHz,c=2*s*this.m_dampingRatio*m,h=s*m*m,l=t.dt;this.m_gamma=l*(c+l*h),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=n*l*h*this.m_gamma,i+=this.m_gamma,this.m_mass.ez.z=0!==i?1/i:0}else 0===f.ez.z?(f.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(f.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);const e=m.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(u,e),s-=y*(m.cross(this.m_rA,e)+this.m_impulse.z),n.addMul(p,e),c+=d*(m.cross(this.m_rB,e)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=c},u.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_invMassA,r=this.m_invMassB,l=this.m_invIA,a=this.m_invIB;if(this.m_frequencyHz>0){let t=o-i;const c=-this.m_mass.ez.z*(t+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=c,i-=l*c,o+=a*c;let _=m.zero();_.addCombine(1,s,1,m.cross(o,this.m_rB)),_.subCombine(1,e,1,m.cross(i,this.m_rA));const u=m.neg(h.mulVec2(this.m_mass,_));this.m_impulse.x+=u.x,this.m_impulse.y+=u.y;let p=m.clone(u);e.subMul(n,p),i-=l*m.cross(this.m_rA,p),s.addMul(r,p),o+=a*m.cross(this.m_rB,p)}else{let t=m.zero();t.addCombine(1,s,1,m.cross(o,this.m_rB)),t.subCombine(1,e,1,m.cross(i,this.m_rA));let _=o-i;const u=c(t.x,t.y,_),p=c.neg(h.mulVec3(this.m_mass,u));this.m_impulse.add(p);let y=m.neo(p.x,p.y);e.subMul(n,y),i-=l*(m.cross(this.m_rA,y)+p.z),s.addMul(r,y),o+=a*(m.cross(this.m_rB,y)+p.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},u.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const a=l.neo(i),_=l.neo(o),u=this.m_invMassA,p=this.m_invMassB,y=this.m_invIA,d=this.m_invIB,f=l.mulVec2(a,m.sub(this.m_localAnchorA,this.m_localCenterA)),x=l.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB));let g,v;const A=new h;if(A.ex.x=u+p+f.y*f.y*y+x.y*x.y*d,A.ey.x=-f.y*f.x*y-x.y*x.x*d,A.ez.x=-f.y*y-x.y*d,A.ex.y=A.ey.x,A.ey.y=u+p+f.x*f.x*y+x.x*x.x*d,A.ez.y=f.x*y+x.x*d,A.ex.z=A.ez.x,A.ey.z=A.ez.y,A.ez.z=y+d,this.m_frequencyHz>0){let t=m.zero();t.addCombine(1,s,1,x),t.subCombine(1,e,1,f),g=t.length(),v=0;let n=m.neg(A.solve22(t));e.subMul(u,n),i-=y*m.cross(f,n),s.addMul(p,n),o+=d*m.cross(x,n)}else{let t=m.zero();t.addCombine(1,s,1,x),t.subCombine(1,e,1,f);const n=o-i-this.m_referenceAngle;g=t.length(),v=r.abs(n);const h=c(t.x,t.y,n);let l=c();if(A.ez.z>0)l=c.neg(A.solve33(h));else{const e=m.neg(A.solve22(t));l.set(e.x,e.y,0)}let a=m.neo(l.x,l.y);e.subMul(u,a),i-=y*(m.cross(f,a)+l.z),s.addMul(p,a),o+=d*(m.cross(x,a)+l.z)}return this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=o,g<=n.linearSlop&&v<=n.angularSlop}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),c=i(3),h=i(8);a.TYPE="wheel-joint",a._super=h,a.prototype=o(a._super.prototype);const l={enableMotor:!1,maxMotorTorque:1e4,motorSpeed:0,frequencyHz:2,dampingRatio:.7,active:!0};function a(t,e,i,o,n){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o,n);t=s(t,l),h.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),this.m_localAxis=n?e.getLocalVector(n):t.localAxisA||m.neo(0,1),this.m_localXAxisA=this.m_localAxis,this.m_localYAxisA=m.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=null,this.m_invMassB=null,this.m_invIA=null,this.m_invIB=null,this.m_ax=m.zero(),this.m_ay=m.zero(),this.m_sAx=0,this.m_sBx=0,this.m_sAy=0,this.m_sBy=0}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t,this.m_localAnchorA},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t,this.m_localAnchorB},a.prototype.getLocalAxisA=function(){return this.m_localXAxisA},a.prototype.setLocalAxisA=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAxis.copy(t),this.m_localXAxisA.copy(t),this.m_localYAxisA.set(-t.y,t.x)},a.prototype.getJointTranslation=function(){const t=this.m_bodyA,e=this.m_bodyB,i=t.getWorldPoint(this.m_localAnchorA),s=e.getWorldPoint(this.m_localAnchorB),o=m.sub(s,i),n=t.getWorldVector(this.m_localXAxisA);return m.dot(o,n)},a.prototype.getJointLinearSpeed=function(){const t=this.m_bodyA,e=this.m_bodyB,i=c.mulVec2(t.m_xf.q,m.sub(this.m_localAnchorA,t.m_sweep.localCenter)),s=c.mulVec2(e.m_xf.q,m.sub(this.m_localAnchorB,e.m_sweep.localCenter)),o=m.add(t.m_sweep.c,i),n=m.add(e.m_sweep.c,s),r=m.sub(n,o),h=c.mulVec2(t.m_xf.q,this.m_localXAxisA),l=t.m_linearVelocity,a=e.m_linearVelocity,_=t.m_angularVelocity,u=e.m_angularVelocity;return m.dot(r,m.cross(_,h))+m.dot(h,m.add(a,m.sub(m.cross(u,s),m.add(l,m.cross(_,i)))))},a.prototype.getJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a},a.prototype.getJointAngularSpeed=function(){const t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},a.prototype.isMotorEnabled=function(){return this.m_enableMotor},a.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},a.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},a.prototype.getMotorSpeed=function(){return this.m_motorSpeed},a.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},a.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},a.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},a.prototype.setSpringFrequencyHz=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_frequencyHz=t},a.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},a.prototype.setSpringDampingRatio=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_dampingRatio=t},a.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return(e=e||m.zero()).setCombine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)},a.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,o=this.m_invIB,n=this.m_bodyA.c_position.c,h=this.m_bodyA.c_position.a,l=this.m_bodyA.c_velocity.v;let a=this.m_bodyA.c_velocity.w;const _=this.m_bodyB.c_position.c,u=this.m_bodyB.c_position.a,p=this.m_bodyB.c_velocity.v;let y=this.m_bodyB.c_velocity.w;const d=c.neo(h),f=c.neo(u),x=c.mulVec2(d,m.sub(this.m_localAnchorA,this.m_localCenterA)),g=c.mulVec2(f,m.sub(this.m_localAnchorB,this.m_localCenterB));let v=m.zero();if(v.addCombine(1,_,1,g),v.subCombine(1,n,1,x),this.m_ay=c.mulVec2(d,this.m_localYAxisA),this.m_sAy=m.cross(m.add(v,x),this.m_ay),this.m_sBy=m.cross(g,this.m_ay),this.m_mass=e+i+s*this.m_sAy*this.m_sAy+o*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=c.mulVec2(d,this.m_localXAxisA),this.m_sAx=m.cross(m.add(v,x),this.m_ax),this.m_sBx=m.cross(g,this.m_ax);const n=e+i+s*this.m_sAx*this.m_sAx+o*this.m_sBx*this.m_sBx;if(n>0){this.m_springMass=1/n;const e=m.dot(v,this.m_ax),i=2*r.PI*this.m_frequencyHz;let s=2*this.m_springMass*this.m_dampingRatio*i;const o=this.m_springMass*i*i,c=t.dt;this.m_gamma=c*(s+c*o),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=e*c*o*this.m_gamma,this.m_springMass=n+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=s+o,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;const e=m.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),i=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,s=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;l.subMul(this.m_invMassA,e),a-=this.m_invIA*i,p.addMul(this.m_invMassB,e),y+=this.m_invIB*s}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.copy(l),this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v.copy(p),this.m_bodyB.c_velocity.w=y};const _=m.zero();a.prototype.solveVelocityConstraints=function(t){const e=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,o=this.m_invIB,n=this.m_bodyA.c_velocity.v;let c=this.m_bodyA.c_velocity.w;const h=this.m_bodyB.c_velocity.v;let l=this.m_bodyB.c_velocity.w;const a=_;{let t=m.dot(this.m_ax,h)-m.dot(this.m_ax,n)+this.m_sBx*l-this.m_sAx*c,r=-this.m_springMass*(t+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=r,m.mulSV(r,this.m_ax,a);let _=r*this.m_sAx,u=r*this.m_sBx;n.subMul(e,a),c-=s*_,h.addMul(i,a),l+=o*u}{let e=l-c-this.m_motorSpeed,i=-this.m_motorMass*e;const n=this.m_motorImpulse,m=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.clamp(this.m_motorImpulse+i,-m,m),i=this.m_motorImpulse-n,c-=s*i,l+=o*i}{let t=m.dot(this.m_ay,h)-m.dot(this.m_ay,n)+this.m_sBy*l-this.m_sAy*c,r=-this.m_mass*t;this.m_impulse+=r,m.mulSV(r,this.m_ay,a);let _=r*this.m_sAy,u=r*this.m_sBy;n.subMul(e,a),c-=s*_,h.addMul(i,a),l+=o*u}this.m_bodyA.c_velocity.v.copy(n),this.m_bodyA.c_velocity.w=c,this.m_bodyB.c_velocity.v.copy(h),this.m_bodyB.c_velocity.w=l};const u=m.zero();a.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const h=u,l=c.neo(i),a=c.neo(o),_=c.mulVec2(l,m.sub(this.m_localAnchorA,this.m_localCenterA)),p=c.mulVec2(a,m.sub(this.m_localAnchorB,this.m_localCenterB)),y=m.zero();y.addCombine(1,s,1,p),y.subCombine(1,e,1,_);const d=c.mulVec2(l,this.m_localYAxisA),f=m.cross(m.add(y,_),d),x=m.cross(p,d),g=m.dot(y,d),v=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;let A;A=0!==v?-g/v:0,m.mulSV(A,d,h);const b=A*f,B=A*x;return e.subMul(this.m_invMassA,h),i-=this.m_invIA*b,s.addMul(this.m_invMassB,h),o+=this.m_invIB*B,this.m_bodyA.c_position.c.copy(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.copy(s),this.m_bodyB.c_position.a=o,r.abs(g)<=n.linearSlop}}]);